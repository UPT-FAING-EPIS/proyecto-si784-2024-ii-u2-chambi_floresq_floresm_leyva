Ì7
vC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\RegistrarUsuario.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
RegistrarUsuario )
:* +
Form, 0
{ 

ClsUsuario 

objUsuario 
= 
new  #

ClsUsuario$ .
(. /
)/ 0
;0 1
string 
id_empleado 
; 
string 
user 
, 
pass 
; 
string 
	categoria 
; 
public 
RegistrarUsuario 
(  
)  !
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
public 
void 
CargarEmpleado "
(" #
)# $
{ 	
MSOFTVETDataContext 
dc  "
=# $
new% (
MSOFTVETDataContext) <
(< =
)= >
;> ?
string   
dniBusqueda   
=    
txtDNI  ! '
.  ' (
Text  ( ,
;  , -
var"" 
empleadoEncontrado"" "
=""# $
dc""% '
.""' (

V_Empleado""( 2
.""2 3
FirstOrDefault""3 A
(""A B
c""B C
=>""D F
c""G H
.""H I
DNI""I L
==""M O
dniBusqueda""P [
)""[ \
;""\ ]
if$$ 
($$ 
!$$ 
string$$ 
.$$ 
IsNullOrEmpty$$ %
($$% &
dniBusqueda$$& 1
)$$1 2
&&$$3 5
($$6 7
dniBusqueda$$7 B
.$$B C
Length$$C I
==$$J L
$num$$M N
)$$N O
)$$O P
{%% 
if&& 
(&& 
empleadoEncontrado&& &
!=&&' )
null&&* .
)&&. /
{'' 
txtNombreEmpleado(( %
.((% &
Text((& *
=((+ ,
empleadoEncontrado((- ?
.((? @
Nombre((@ F
;((F G
id_empleado** 
=**  !
empleadoEncontrado**" 4
.**4 5
Cod_Empleado**5 A
.**A B
ToString**B J
(**J K
)**K L
;**L M
grupoUsuario++  
.++  !
Enabled++! (
=++) *
true+++ /
;++/ 0
},, 
else-- 
{.. 
txtNombreEmpleado// %
.//% &
Text//& *
=//+ ,
$str//- E
;//E F

MessageBox00 
.00 
Show00 #
(00# $
$str00$ Y
,00Y Z
$str00[ b
,00b c
MessageBoxButtons00d u
.00u v
OK00v x
,00x y
MessageBoxIcon	00z à
.
00à â
Error
00â é
)
00é è
;
00è ê
}11 
}22 
else33 
{44 

MessageBox55 
.55 
Show55 
(55  
$str55  7
,557 8
$str559 @
,55@ A
MessageBoxButtons55B S
.55S T
OK55T V
,55V W
MessageBoxIcon55X f
.55f g
Error55g l
)55l m
;55m n
}66 
}88 	
public99 
void99 
AgregarUsuario99 "
(99" #
)99# $
{:: 	

objUsuario<< 
.<< 
usuario<< 
=<<  
txtUsername<<! ,
.<<, -
Text<<- 1
;<<1 2

objUsuario== 
.== 
contrase√±a== !
===" #
txtPassword==$ /
.==/ 0
Text==0 4
;==4 5

objUsuario>> 
.>> 
	categoria>>  
=>>! "
$str>># -
;>>- .

objUsuario?? 
.?? 
idemp?? 
=?? 
id_empleado?? *
;??* +
if@@ 
(@@ 
!@@ 
string@@ 
.@@ 
IsNullOrEmpty@@ %
(@@% &
txtUsername@@& 1
.@@1 2
Text@@2 6
)@@6 7
&&@@8 :
!@@; <
string@@< B
.@@B C
IsNullOrEmpty@@C P
(@@P Q
txtPassword@@Q \
.@@\ ]
Text@@] a
)@@a b
)@@b c
{AA 

objUsuarioBB 
.BB 
AgregarUsuarioBB )
(BB) *
)BB* +
;BB+ ,
limpiarCC 
(CC 
)CC 
;CC 
}EE 
elseFF 
{GG 

MessageBoxHH 
.HH 
ShowHH 
(HH  
$strHH  :
)HH: ;
;HH; <
}II 
}KK 	
privateLL 
voidLL !
RegistrarUsuario_LoadLL *
(LL* +
objectLL+ 1
senderLL2 8
,LL8 9
	EventArgsLL: C
eLLD E
)LLE F
{MM 	
}OO 	
privateQQ 
voidQQ 
btnLimpiar_Click_1QQ '
(QQ' (
objectQQ( .
senderQQ/ 5
,QQ5 6
	EventArgsQQ7 @
eQQA B
)QQB C
{RR 	
limpiarSS 
(SS 
)SS 
;SS 
}TT 	
privateVV 
voidVV 
btnBuscar_ClickVV $
(VV$ %
objectVV% +
senderVV, 2
,VV2 3
	EventArgsVV4 =
eVV> ?
)VV? @
{WW 	
CargarEmpleadoXX 
(XX 
)XX 
;XX 
}YY 	
private[[ 
void[[ 
btnRegistrar_Click[[ '
([[' (
object[[( .
sender[[/ 5
,[[5 6
	EventArgs[[7 @
e[[A B
)[[B C
{\\ 	
AgregarUsuario]] 
(]] 
)]] 
;]] 
}^^ 	
private`` 
void`` 
btnCancelar_Click`` &
(``& '
object``' -
sender``. 4
,``4 5
	EventArgs``6 ?
e``@ A
)``A B
{aa 	
	FormLoginbb 
frmbb 
=bb 
newbb 
	FormLoginbb  )
(bb) *
)bb* +
;bb+ ,
frmcc 
.cc 
Showcc 
(cc 
)cc 
;cc 
thisdd 
.dd 
Closedd 
(dd 
)dd 
;dd 
}ee 	
publicgg 
voidgg 
limpiargg 
(gg 
)gg 
{hh 	
txtDNIii 
.ii 
Textii 
=ii 
$strii 
;ii 
txtNombreEmpleadojj 
.jj 
Textjj "
=jj# $
$strjj% '
;jj' (
txtUsernamekk 
.kk 
Textkk 
=kk 
$strkk !
;kk! "
txtPasswordll 
.ll 
Textll 
=ll 
$strll !
;ll! "
grupoUsuariomm 
.mm 
Enabledmm  
=mm! "
falsemm# (
;mm( )
}nn 	
}oo 
}qq ‰˙
wC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\RegistrarEmpleado.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
RegistrarEmpleado *
:+ ,
Form- 1
{ 
private 
ClsEmpleado 
empleado $
;$ %
ApisPeru 
ApisPeru 
= 
new 
ApisPeru  (
(( )
)) *
;* +
public 
RegistrarEmpleado  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
ActivarBotones 
( 
true 
,  
false! &
,& '
false( -
,- .
false/ 4
,4 5
false6 ;
); <
;< =
ActivarCampos 
( 
false 
,  
false! &
,& '
false( -
,- .
false/ 4
,4 5
false6 ;
,; <
false= B
,B C
falseD I
,I J
falseK P
)P Q
;Q R
Limpieza 
( 
) 
; 
CargarEmpleado 
( 
) 
; 
empleado 
= 
new 
ClsEmpleado &
(& '
)' (
;( )
} 	
public 
void 
btnLimpiar_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
ActivarBotones   
(   
true   
,    
false  ! &
,  & '
false  ( -
,  - .
false  / 4
,  4 5
false  6 ;
)  ; <
;  < =
ActivarCampos!! 
(!! 
false!! 
,!!  
false!!! &
,!!& '
false!!( -
,!!- .
false!!/ 4
,!!4 5
false!!6 ;
,!!; <
false!!= B
,!!B C
false!!D I
,!!I J
false!!K P
)!!P Q
;!!Q R
Limpieza"" 
("" 
)"" 
;"" 
CargarEmpleado## 
(## 
)## 
;## 
empleado$$ 
=$$ 
new$$ 
ClsEmpleado$$ &
($$& '
)$$' (
;$$( )
}&& 	
public'' 
void'' 
Limpieza'' 
('' 
)'' 
{(( 	
	cmbGenero)) 
.)) 
SelectedIndex)) #
=))$ %
-))& '
$num))' (
;))( )

cmbHorario** 
.** 
SelectedIndex** $
=**% &
-**' (
$num**( )
;**) *
txtApellido++ 
.++ 
Text++ 
=++ 
$str++ !
;++! "
txtCargo,, 
.,, 
Text,, 
=,, 
$str,, 
;,, 
	txtNombre-- 
.-- 
Text-- 
=-- 
string-- #
.--# $
Empty--$ )
;--) *
txtDNI.. 
... 
Text.. 
=.. 
string..  
...  !
Empty..! &
;..& '
txtTelefono// 
.// 
Text// 
=// 
string// %
.//% &
Empty//& +
;//+ ,
	txtSueldo00 
.00 
Text00 
=00 
string00 #
.00# $
Empty00$ )
;00) *
}11 	
public33 
void33 
btnAgregar_Click33 $
(33$ %
object33% +
sender33, 2
,332 3
	EventArgs334 =
e33> ?
)33? @
{44 	
AgregarEmpleado55 
(55 
)55 
;55 
}66 	
private88 
void88 "
dgvEmpleados_CellClick88 +
(88+ ,
object88, 2
sender883 9
,889 :%
DataGridViewCellEventArgs88; T
e88U V
)88V W
{99 	
if:: 
(:: 
e:: 
.:: 
RowIndex:: 
>=:: 
$num:: 
&&::  "
e::# $
.::$ %
RowIndex::% -
<::. /
dgvEmpleados::0 <
.::< =
Rows::= A
.::A B
Count::B G
)::G H
{;; 
DataGridViewRow<< 
fila<<  $
=<<% &
dgvEmpleados<<' 3
.<<3 4
Rows<<4 8
[<<8 9
e<<9 :
.<<: ;
RowIndex<<; C
]<<C D
;<<D E
empleado>> 
.>> 
CodEmpleado>> $
=>>% &
Convert>>' .
.>>. /
ToInt32>>/ 6
(>>6 7
fila>>7 ;
.>>; <
Cells>>< A
[>>A B
$str>>B O
]>>O P
.>>P Q
Value>>Q V
)>>V W
;>>W X
empleado?? 
.?? 
Nombre?? 
=??  !
fila??" &
.??& '
Cells??' ,
[??, -
$str??- 5
]??5 6
.??6 7
Value??7 <
.??< =
ToString??= E
(??E F
)??F G
;??G H
empleado@@ 
.@@ 
Apellido@@ !
=@@" #
fila@@$ (
.@@( )
Cells@@) .
[@@. /
$str@@/ 9
]@@9 :
.@@: ;
Value@@; @
.@@@ A
ToString@@A I
(@@I J
)@@J K
;@@K L
empleadoAA 
.AA 
DNIAA 
=AA 
filaAA #
.AA# $
CellsAA$ )
[AA) *
$strAA* /
]AA/ 0
.AA0 1
ValueAA1 6
.AA6 7
ToStringAA7 ?
(AA? @
)AA@ A
;AAA B
empleadoBB 
.BB 
FechaNacimientoBB (
=BB) *
ConvertBB+ 2
.BB2 3

ToDateTimeBB3 =
(BB= >
filaBB> B
.BBB C
CellsBBC H
[BBH I
$strBBI Z
]BBZ [
.BB[ \
ValueBB\ a
)BBa b
;BBb c
empleadoCC 
.CC 
GeneroCC 
=CC  !
filaCC" &
.CC& '
CellsCC' ,
[CC, -
$strCC- 5
]CC5 6
.CC6 7
ValueCC7 <
.CC< =
ToStringCC= E
(CCE F
)CCF G
;CCG H
empleadoDD 
.DD 
TelefonoDD !
=DD" #
filaDD$ (
.DD( )
CellsDD) .
[DD. /
$strDD/ 9
]DD9 :
.DD: ;
ValueDD; @
.DD@ A
ToStringDDA I
(DDI J
)DDJ K
;DDK L
empleadoEE 
.EE 
FechaInicioEE $
=EE% &
ConvertEE' .
.EE. /

ToDateTimeEE/ 9
(EE9 :
filaEE: >
.EE> ?
CellsEE? D
[EED E
$strEEE R
]EER S
.EES T
ValueEET Y
)EEY Z
;EEZ [
empleadoFF 
.FF 
CargoFF 
=FF  
filaFF! %
.FF% &
CellsFF& +
[FF+ ,
$strFF, 3
]FF3 4
.FF4 5
ValueFF5 :
.FF: ;
ToStringFF; C
(FFC D
)FFD E
;FFE F
empleadoGG 
.GG 
SueldoGG 
=GG  !
ConvertGG" )
.GG) *
ToInt32GG* 1
(GG1 2
filaGG2 6
.GG6 7
CellsGG7 <
[GG< =
$strGG= E
]GGE F
.GGF G
ValueGGG L
)GGL M
;GGM N
empleadoHH 
.HH 
HorarioHH  
=HH! "
filaHH# '
.HH' (
CellsHH( -
[HH- .
$strHH. 7
]HH7 8
.HH8 9
ValueHH9 >
.HH> ?
ToStringHH? G
(HHG H
)HHH I
;HHI J
	txtNombreJJ 
.JJ 
TextJJ 
=JJ  
empleadoJJ! )
.JJ) *
NombreJJ* 0
;JJ0 1
txtApellidoKK 
.KK 
TextKK  
=KK! "
empleadoKK# +
.KK+ ,
ApellidoKK, 4
;KK4 5
txtDNILL 
.LL 
TextLL 
=LL 
empleadoLL &
.LL& '
DNILL' *
;LL* +
dtpFechaNacimientoMM "
.MM" #
ValueMM# (
=MM) *
empleadoMM+ 3
.MM3 4
FechaNacimientoMM4 C
;MMC D
txtTelefonoNN 
.NN 
TextNN  
=NN! "
empleadoNN# +
.NN+ ,
TelefonoNN, 4
;NN4 5
dtpFechaInicioOO 
.OO 
ValueOO $
=OO% &
empleadoOO' /
.OO/ 0
FechaInicioOO0 ;
;OO; <
txtCargoPP 
.PP 
TextPP 
=PP 
empleadoPP  (
.PP( )
CargoPP) .
;PP. /
	txtSueldoQQ 
.QQ 
TextQQ 
=QQ  
empleadoQQ! )
.QQ) *
SueldoQQ* 0
.QQ0 1
ToStringQQ1 9
(QQ9 :
)QQ: ;
;QQ; <
stringRR 
horarioRR 
=RR  
empleadoRR! )
.RR) *
HorarioRR* 1
;RR1 2
intSS 
indiceHorarioSS !
=SS" #

cmbHorarioSS$ .
.SS. /

FindStringSS/ 9
(SS9 :
horarioSS: A
)SSA B
;SSB C

cmbHorarioTT 
.TT 
SelectedIndexTT (
=TT) *
indiceHorarioTT+ 8
;TT8 9
stringUU 
generoUU 
=UU 
empleadoUU  (
.UU( )
GeneroUU) /
;UU/ 0
intVV 
indiceGeneroVV  
=VV! "
	cmbGeneroVV# ,
.VV, -

FindStringVV- 7
(VV7 8
generoVV8 >
)VV> ?
;VV? @
	cmbGeneroWW 
.WW 
SelectedIndexWW '
=WW( )
indiceGeneroWW* 6
;WW6 7
ActivarCamposXX 
(XX 
trueXX "
,XX" #
trueXX$ (
,XX( )
trueXX* .
,XX. /
trueXX0 4
,XX4 5
trueXX6 :
,XX: ;
trueXX< @
,XX@ A
trueXXB F
,XXF G
trueXXH L
)XXL M
;XXM N
ActivarBotonesYY 
(YY 
trueYY #
,YY# $
trueYY% )
,YY) *
trueYY+ /
,YY/ 0
trueYY1 5
,YY5 6
trueYY7 ;
)YY; <
;YY< =
}ZZ 
}[[ 	
private]] 
void]] 
btnModificar_Click]] '
(]]' (
object]]( .
sender]]/ 5
,]]5 6
	EventArgs]]7 @
e]]A B
)]]B C
{^^ 	
try__ 
{`` 
ObtenerDatosaa 
(aa 
)aa 
;aa 
ifbb 
(bb 
empleadobb 
.bb 
ValidarDatosbb )
(bb) *
)bb* +
)bb+ ,
{cc 
empleadodd 
.dd "
ModificarEnBaseDeDatosdd 3
(dd3 4
)dd4 5
;dd5 6

MessageBoxff 
.ff 
Showff #
(ff# $
$strff$ R
,ffR S
$strffT ^
,ff^ _
MessageBoxButtonsff` q
.ffq r
OKffr t
,fft u
MessageBoxIcon	ffv Ñ
.
ffÑ Ö
Information
ffÖ ê
)
ffê ë
;
ffë í
ActivarBotonesgg "
(gg" #
truegg# '
,gg' (
falsegg) .
,gg. /
falsegg0 5
,gg5 6
falsegg7 <
,gg< =
falsegg> C
)ggC D
;ggD E
ActivarCamposhh !
(hh! "
falsehh" '
,hh' (
falsehh) .
,hh. /
falsehh0 5
,hh5 6
falsehh7 <
,hh< =
falsehh> C
,hhC D
falsehhE J
,hhJ K
falsehhL Q
,hhQ R
falsehhS X
)hhX Y
;hhY Z
Limpiezaii 
(ii 
)ii 
;ii 
CargarEmpleadojj "
(jj" #
)jj# $
;jj$ %
}kk 
elsell 
{mm 

MessageBoxnn 
.nn 
Shownn #
(nn# $
$strnn$ R
,nnR S
$strnnT [
,nn[ \
MessageBoxButtonsnn] n
.nnn o
OKnno q
,nnq r
MessageBoxIcon	nns Å
.
nnÅ Ç
Error
nnÇ á
)
nná à
;
nnà â
}oo 
}pp 
catchqq 
(qq 
	Exceptionqq 
exqq 
)qq  
{rr 

MessageBoxss 
.ss 
Showss 
(ss  
$"ss  "
$strss" B
{ssB C
exssC E
.ssE F
MessagessF M
}ssM N
"ssN O
,ssO P
$strssQ X
,ssX Y
MessageBoxButtonsssZ k
.ssk l
OKssl n
,ssn o
MessageBoxIconssp ~
.ss~ 
Error	ss Ñ
)
ssÑ Ö
;
ssÖ Ü
}tt 
}uu 	
privateww 
voidww 
btnEliminar_Clickww &
(ww& '
objectww' -
senderww. 4
,ww4 5
	EventArgsww6 ?
eww@ A
)wwA B
{xx 	
tryyy 
{zz 
if{{ 
({{ 
empleado{{ 
.{{ 
CodEmpleado{{ (
>{{) *
$num{{+ ,
){{, -
{|| 
empleado}} 
.}} !
EliminarEnBaseDeDatos}} 2
(}}2 3
)}}3 4
;}}4 5

MessageBox 
. 
Show #
(# $
$str$ Q
,Q R
$strS ]
,] ^
MessageBoxButtons_ p
.p q
OKq s
,s t
MessageBoxIcon	u É
.
É Ñ
Information
Ñ è
)
è ê
;
ê ë
ActivarBotones
ÄÄ "
(
ÄÄ" #
true
ÄÄ# '
,
ÄÄ' (
false
ÄÄ) .
,
ÄÄ. /
false
ÄÄ0 5
,
ÄÄ5 6
false
ÄÄ7 <
,
ÄÄ< =
false
ÄÄ> C
)
ÄÄC D
;
ÄÄD E
ActivarCampos
ÅÅ !
(
ÅÅ! "
false
ÅÅ" '
,
ÅÅ' (
false
ÅÅ) .
,
ÅÅ. /
false
ÅÅ0 5
,
ÅÅ5 6
false
ÅÅ7 <
,
ÅÅ< =
false
ÅÅ> C
,
ÅÅC D
false
ÅÅE J
,
ÅÅJ K
false
ÅÅL Q
,
ÅÅQ R
false
ÅÅS X
)
ÅÅX Y
;
ÅÅY Z
Limpieza
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
CargarEmpleado
ÉÉ "
(
ÉÉ" #
)
ÉÉ# $
;
ÉÉ$ %
}
ÑÑ 
else
ÖÖ 
{
ÜÜ 

MessageBox
áá 
.
áá 
Show
áá #
(
áá# $
$str
áá$ K
,
ááK L
$str
ááM T
,
ááT U
MessageBoxButtons
ááV g
.
áág h
OK
ááh j
,
ááj k
MessageBoxIcon
áál z
.
ááz {
Erroráá{ Ä
)ááÄ Å
;ááÅ Ç
}
àà 
}
ââ 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
ãã 

MessageBox
åå 
.
åå 
Show
åå 
(
åå  
$"
åå  "
$str
åå" U
"
ååU V
,
ååV W
$str
ååX _
,
åå_ `
MessageBoxButtons
ååa r
.
åår s
OK
åås u
,
ååu v
MessageBoxIconååw Ö
.ååÖ Ü
ErrorååÜ ã
)ååã å
;ååå ç
}
çç 
}
éé 	
private
êê 
void
êê 
btnNuevo_Click
êê #
(
êê# $
object
êê$ *
sender
êê+ 1
,
êê1 2
	EventArgs
êê3 <
e
êê= >
)
êê> ?
{
ëë 	
ActivarCampos
íí 
(
íí 
true
íí 
,
íí 
true
íí  $
,
íí$ %
true
íí& *
,
íí* +
true
íí, 0
,
íí0 1
true
íí2 6
,
íí6 7
true
íí8 <
,
íí< =
true
íí> B
,
ííB C
true
ííD H
)
ííH I
;
ííI J
ActivarBotones
ìì 
(
ìì 
true
ìì 
,
ìì  
true
ìì! %
,
ìì% &
true
ìì' +
,
ìì+ ,
true
ìì- 1
,
ìì1 2
true
ìì3 7
)
ìì7 8
;
ìì8 9
Limpieza
îî 
(
îî 
)
îî 
;
îî 
empleado
ïï 
=
ïï 
new
ïï 
ClsEmpleado
ïï &
(
ïï& '
)
ïï' (
;
ïï( )
gruporeniec
ññ 
.
ññ 
Enabled
ññ 
=
ññ  !
true
ññ" &
;
ññ& '
}
óó 	
public
ôô 
void
ôô 
ActivarCampos
ôô !
(
ôô! "
bool
ôô" &
g
ôô' (
,
ôô( )
bool
ôô* .
h
ôô/ 0
,
ôô0 1
bool
ôô2 6
a
ôô7 8
,
ôô8 9
bool
ôô: >
c
ôô? @
,
ôô@ A
bool
ôôB F
n
ôôG H
,
ôôH I
bool
ôôJ N
d
ôôO P
,
ôôP Q
bool
ôôR V
t
ôôW X
,
ôôX Y
bool
ôôZ ^
s
ôô_ `
)
ôô` a
{
öö 	
	cmbGenero
õõ 
.
õõ 
Enabled
õõ 
=
õõ 
g
õõ  !
;
õõ! "

cmbHorario
úú 
.
úú 
Enabled
úú 
=
úú  
h
úú! "
;
úú" #
txtApellido
ùù 
.
ùù 
Enabled
ùù 
=
ùù  !
a
ùù" #
;
ùù# $
txtCargo
ûû 
.
ûû 
Enabled
ûû 
=
ûû 
c
ûû  
;
ûû  !
	txtNombre
üü 
.
üü 
Enabled
üü 
=
üü 
n
üü  !
;
üü! "
txtDNI
†† 
.
†† 
Enabled
†† 
=
†† 
d
†† 
;
†† 
txtTelefono
°° 
.
°° 
Enabled
°° 
=
°°  !
t
°°" #
;
°°# $
	txtSueldo
¢¢ 
.
¢¢ 
Enabled
¢¢ 
=
¢¢ 
s
¢¢  !
;
¢¢! "
dtpFechaInicio
££ 
.
££ 
Enabled
££ "
=
££# $
t
££% &
;
££& ' 
dtpFechaNacimiento
§§ 
.
§§ 
Enabled
§§ &
=
§§' (
t
§§) *
;
§§* +
}
•• 	
public
ßß 
void
ßß 
ActivarBotones
ßß "
(
ßß" #
bool
ßß# '
n
ßß( )
,
ßß) *
bool
ßß+ /
r
ßß0 1
,
ßß1 2
bool
ßß3 7
m
ßß8 9
,
ßß9 :
bool
ßß; ?
el
ßß@ B
,
ßßB C
bool
ßßD H
c
ßßI J
)
ßßJ K
{
®® 	
btnNuevo
©© 
.
©© 
Enabled
©© 
=
©© 
n
©©  
;
©©  !

btnAgregar
™™ 
.
™™ 
Enabled
™™ 
=
™™  
r
™™! "
;
™™" #
btnModificar
´´ 
.
´´ 
Enabled
´´  
=
´´! "
m
´´# $
;
´´$ %
btnEliminar
¨¨ 
.
¨¨ 
Enabled
¨¨ 
=
¨¨  !
el
¨¨" $
;
¨¨$ %
btnCancelar
≠≠ 
.
≠≠ 
Enabled
≠≠ 
=
≠≠  !
c
≠≠" #
;
≠≠# $
}
ÆÆ 	
public
∞∞ 
void
∞∞ 
CargarEmpleado
∞∞ "
(
∞∞" #
)
∞∞# $
{
±± 	
dgvEmpleados
≤≤ 
.
≤≤ 

DataSource
≤≤ #
=
≤≤$ %
ClsEmpleado
≤≤& 1
.
≤≤1 2#
ObtenerListaEmpleados
≤≤2 G
(
≤≤G H
)
≤≤H I
;
≤≤I J
dgvEmpleados
≥≥ 
.
≥≥ 
Columns
≥≥  
[
≥≥  !
$num
≥≥! "
]
≥≥" #
.
≥≥# $
Width
≥≥$ )
=
≥≥* +
$num
≥≥, .
;
≥≥. /
dgvEmpleados
¥¥ 
.
¥¥ 
Columns
¥¥  
[
¥¥  !
$num
¥¥! "
]
¥¥" #
.
¥¥# $
Width
¥¥$ )
=
¥¥* +
$num
¥¥, .
;
¥¥. /
dgvEmpleados
µµ 
.
µµ 
Columns
µµ  
[
µµ  !
$num
µµ! "
]
µµ" #
.
µµ# $
Width
µµ$ )
=
µµ* +
$num
µµ, .
;
µµ. /
dgvEmpleados
∂∂ 
.
∂∂ 
Columns
∂∂  
[
∂∂  !
$num
∂∂! "
]
∂∂" #
.
∂∂# $
Width
∂∂$ )
=
∂∂* +
$num
∂∂, .
;
∂∂. /
dgvEmpleados
∑∑ 
.
∑∑ 
Columns
∑∑  
[
∑∑  !
$num
∑∑! "
]
∑∑" #
.
∑∑# $
Width
∑∑$ )
=
∑∑* +
$num
∑∑, .
;
∑∑. /
dgvEmpleados
∏∏ 
.
∏∏ 
Columns
∏∏  
[
∏∏  !
$num
∏∏! "
]
∏∏" #
.
∏∏# $
Width
∏∏$ )
=
∏∏* +
$num
∏∏, .
;
∏∏. /
dgvEmpleados
ππ 
.
ππ 
Columns
ππ  
[
ππ  !
$num
ππ! "
]
ππ" #
.
ππ# $
Width
ππ$ )
=
ππ* +
$num
ππ, .
;
ππ. /
dgvEmpleados
∫∫ 
.
∫∫ 
Columns
∫∫  
[
∫∫  !
$num
∫∫! #
]
∫∫# $
.
∫∫$ %
Width
∫∫% *
=
∫∫+ ,
$num
∫∫- /
;
∫∫/ 0
}
ªª 	
public
ææ 

void
ææ 
AgregarEmpleado
ææ 
(
ææ  
)
ææ  !
{
øø 	
try
¿¿ 
{
¡¡ 
ObtenerDatos
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬ 
if
ƒƒ 
(
ƒƒ 
ClsEmpleado
ƒƒ 
.
ƒƒ  "
ExisteEmpleadoPorDNI
ƒƒ  4
(
ƒƒ4 5
empleado
ƒƒ5 =
.
ƒƒ= >
DNI
ƒƒ> A
)
ƒƒA B
)
ƒƒB C
{
≈≈ 

MessageBox
∆∆ 
.
∆∆ 
Show
∆∆ #
(
∆∆# $
$str
∆∆$ M
,
∆∆M N
$str
∆∆O V
,
∆∆V W
MessageBoxButtons
∆∆X i
.
∆∆i j
OK
∆∆j l
,
∆∆l m
MessageBoxIcon
∆∆n |
.
∆∆| }
Error∆∆} Ç
)∆∆Ç É
;∆∆É Ñ
return
«« 
;
«« 
}
»» 
if
   
(
   
empleado
   
.
   
ValidarDatos
   )
(
  ) *
)
  * +
)
  + ,
{
ÀÀ 
empleado
ÃÃ 
.
ÃÃ #
InsertarEnBaseDeDatos
ÃÃ 2
(
ÃÃ2 3
)
ÃÃ3 4
;
ÃÃ4 5

MessageBox
ÕÕ 
.
ÕÕ 
Show
ÕÕ #
(
ÕÕ# $
$str
ÕÕ$ E
,
ÕÕE F
$str
ÕÕG Q
,
ÕÕQ R
MessageBoxButtons
ÕÕS d
.
ÕÕd e
OK
ÕÕe g
,
ÕÕg h
MessageBoxIcon
ÕÕi w
.
ÕÕw x
InformationÕÕx É
)ÕÕÉ Ñ
;ÕÕÑ Ö
ActivarBotones
ŒŒ "
(
ŒŒ" #
true
ŒŒ# '
,
ŒŒ' (
false
ŒŒ) .
,
ŒŒ. /
false
ŒŒ0 5
,
ŒŒ5 6
false
ŒŒ7 <
,
ŒŒ< =
false
ŒŒ> C
)
ŒŒC D
;
ŒŒD E
ActivarCampos
œœ !
(
œœ! "
false
œœ" '
,
œœ' (
false
œœ) .
,
œœ. /
false
œœ0 5
,
œœ5 6
false
œœ7 <
,
œœ< =
false
œœ> C
,
œœC D
false
œœE J
,
œœJ K
false
œœL Q
,
œœQ R
false
œœS X
)
œœX Y
;
œœY Z
Limpieza
–– 
(
–– 
)
–– 
;
–– 
CargarEmpleado
—— "
(
——" #
)
——# $
;
——$ %
}
““ 
else
”” 
{
‘‘ 

MessageBox
’’ 
.
’’ 
Show
’’ #
(
’’# $
$str
’’$ R
,
’’R S
$str
’’T [
,
’’[ \
MessageBoxButtons
’’] n
.
’’n o
OK
’’o q
,
’’q r
MessageBoxIcon’’s Å
.’’Å Ç
Error’’Ç á
)’’á à
;’’à â
}
÷÷ 
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
)
ÿÿ 
{
ŸŸ 

MessageBox
⁄⁄ 
.
⁄⁄ 
Show
⁄⁄ 
(
⁄⁄  
$str
⁄⁄  V
,
⁄⁄V W
$str
⁄⁄X _
,
⁄⁄_ `
MessageBoxButtons
⁄⁄a r
.
⁄⁄r s
OK
⁄⁄s u
,
⁄⁄u v
MessageBoxIcon⁄⁄w Ö
.⁄⁄Ö Ü
Error⁄⁄Ü ã
)⁄⁄ã å
;⁄⁄å ç
}
€€ 
}
‹‹ 	
private
ﬁﬁ 
void
ﬁﬁ 
ObtenerDatos
ﬁﬁ !
(
ﬁﬁ! "
)
ﬁﬁ" #
{
ﬂﬂ 	
empleado
‡‡ 
.
‡‡ 
Nombre
‡‡ 
=
‡‡ 
	txtNombre
‡‡ '
.
‡‡' (
Text
‡‡( ,
;
‡‡, -
empleado
·· 
.
·· 
Apellido
·· 
=
·· 
txtApellido
··  +
.
··+ ,
Text
··, 0
;
··0 1
empleado
‚‚ 
.
‚‚ 
DNI
‚‚ 
=
‚‚ 
txtDNI
‚‚ !
.
‚‚! "
Text
‚‚" &
;
‚‚& '
empleado
„„ 
.
„„ 
FechaNacimiento
„„ $
=
„„% & 
dtpFechaNacimiento
„„' 9
.
„„9 :
Value
„„: ?
;
„„? @
empleado
‰‰ 
.
‰‰ 
Genero
‰‰ 
=
‰‰ 
ObtenerGenero
‰‰ +
(
‰‰+ ,
)
‰‰, -
;
‰‰- .
empleado
ÂÂ 
.
ÂÂ 
Telefono
ÂÂ 
=
ÂÂ 
txtTelefono
ÂÂ  +
.
ÂÂ+ ,
Text
ÂÂ, 0
;
ÂÂ0 1
empleado
ÊÊ 
.
ÊÊ 
FechaInicio
ÊÊ  
=
ÊÊ! "
dtpFechaInicio
ÊÊ# 1
.
ÊÊ1 2
Value
ÊÊ2 7
;
ÊÊ7 8
empleado
ÁÁ 
.
ÁÁ 
Cargo
ÁÁ 
=
ÁÁ 
txtCargo
ÁÁ %
.
ÁÁ% &
Text
ÁÁ& *
;
ÁÁ* +
empleado
ËË 
.
ËË 
Sueldo
ËË 
=
ËË 
Convert
ËË %
.
ËË% &
ToInt32
ËË& -
(
ËË- .
	txtSueldo
ËË. 7
.
ËË7 8
Text
ËË8 <
)
ËË< =
;
ËË= >
empleado
ÈÈ 
.
ÈÈ 
Horario
ÈÈ 
=
ÈÈ 
ObtenerHorario
ÈÈ -
(
ÈÈ- .
)
ÈÈ. /
;
ÈÈ/ 0
}
ÍÍ 	
private
ÏÏ 
string
ÏÏ 
ObtenerGenero
ÏÏ $
(
ÏÏ$ %
)
ÏÏ% &
{
ÌÌ 	
if
ÓÓ 
(
ÓÓ 
	cmbGenero
ÓÓ 
.
ÓÓ 
SelectedIndex
ÓÓ '
==
ÓÓ( *
$num
ÓÓ+ ,
)
ÓÓ, -
{
ÔÔ 
return
 
$str
 "
;
" #
}
ÒÒ 
else
ÚÚ 
if
ÚÚ 
(
ÚÚ 
	cmbGenero
ÚÚ 
.
ÚÚ 
SelectedIndex
ÚÚ ,
==
ÚÚ- /
$num
ÚÚ0 1
)
ÚÚ1 2
{
ÛÛ 
return
ÙÙ 
$str
ÙÙ !
;
ÙÙ! "
}
ıı 
else
ˆˆ 
{
˜˜ 
return
¯¯ 
$str
¯¯ 
;
¯¯ 
}
˘˘ 
}
˙˙ 	
private
¸¸ 
string
¸¸ 
ObtenerHorario
¸¸ %
(
¸¸% &
)
¸¸& '
{
˝˝ 	
if
˛˛ 
(
˛˛ 

cmbHorario
˛˛ 
.
˛˛ 
SelectedIndex
˛˛ (
==
˛˛) +
$num
˛˛, -
)
˛˛- .
{
ˇˇ 
return
ÄÄ 
$str
ÄÄ &
;
ÄÄ& '
}
ÅÅ 
else
ÇÇ 
if
ÇÇ 
(
ÇÇ 

cmbHorario
ÇÇ 
.
ÇÇ  
SelectedIndex
ÇÇ  -
==
ÇÇ. 0
$num
ÇÇ1 2
)
ÇÇ2 3
{
ÉÉ 
return
ÑÑ 
$str
ÑÑ &
;
ÑÑ& '
}
ÖÖ 
else
ÜÜ 
if
ÜÜ 
(
ÜÜ 

cmbHorario
ÜÜ 
.
ÜÜ  
SelectedIndex
ÜÜ  -
==
ÜÜ. 0
$num
ÜÜ1 2
)
ÜÜ2 3
{
áá 
return
àà 
$str
àà &
;
àà& '
}
ââ 
else
ää 
{
ãã 
return
åå 
$str
åå $
;
åå$ %
}
çç 
}
éé 	
private
êê 
void
êê $
RegistrarEmpleado_Load
êê +
(
êê+ ,
object
êê, 2
sender
êê3 9
,
êê9 :
	EventArgs
êê; D
e
êêE F
)
êêF G
{
ëë 	
}
ìì 	
private
ïï 
void
ïï 
btnBuscar_Click
ïï $
(
ïï$ %
object
ïï% +
sender
ïï, 2
,
ïï2 3
	EventArgs
ïï4 =
e
ïï> ?
)
ïï? @
{
ññ 	
consultarEmpleado
óó 
(
óó 
)
óó 
;
óó  
}
òò 	
private
ôô 
void
ôô 
consultarEmpleado
ôô &
(
ôô& '
)
ôô' (
{
öö 	
try
õõ 
{
úú 
if
ùù 
(
ùù 
txtBdni
ùù 
.
ùù 
Text
ùù  
.
ùù  !
Length
ùù! '
==
ùù( *
$num
ùù+ ,
)
ùù, -
{
ûû 
dynamic
üü 
	respuesta
üü %
=
üü& '
ApisPeru
üü( 0
.
üü0 1
Get
üü1 4
(
üü4 5
$str
üü5 ^
+
üü_ `
txtBdni
üüa h
.
üüh i
Text
üüi m
+
üün o
$strüüp Ù
)üüÙ ı
;üüı ˆ
	txtNombre
†† 
.
†† 
Text
†† "
=
††# $
	respuesta
††% .
.
††. /
nombres
††/ 6
.
††6 7
ToString
††7 ?
(
††? @
)
††@ A
;
††A B
txtApellido
°° 
.
°°  
Text
°°  $
=
°°% &
	respuesta
°°' 0
.
°°0 1
apellidoPaterno
°°1 @
.
°°@ A
ToString
°°A I
(
°°I J
)
°°J K
+
°°L M
$str
°°N Q
+
°°R S
	respuesta
°°T ]
.
°°] ^
apellidoMaterno
°°^ m
.
°°m n
ToString
°°n v
(
°°v w
)
°°w x
;
°°x y
txtDNI
¢¢ 
.
¢¢ 
Text
¢¢ 
=
¢¢  !
txtBdni
¢¢" )
.
¢¢) *
Text
¢¢* .
;
¢¢. /
txtBdni
££ 
.
££ 
Text
££  
=
££! "
$str
££# %
;
££% &
txtBdni
§§ 
.
§§ 
Text
§§  
=
§§! "
$str
§§# %
;
§§% &
}
•• 
else
¶¶ 
{
ßß 

MessageBox
®® 
.
®® 
Show
®® #
(
®®# $
$str
®®$ L
,
®®L M
$str
®®N b
,
®®b c
MessageBoxButtons
®®d u
.
®®u v
OK
®®v x
,
®®x y
MessageBoxIcon®®z à
.®®à â
Information®®â î
)®®î ï
;®®ï ñ
}
©© 
}
´´ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
)
¨¨ 
{
≠≠ 

MessageBox
ØØ 
.
ØØ 
Show
ØØ 
(
ØØ  
$str
ØØ  H
,
ØØH I
$str
ØØJ ^
,
ØØ^ _
MessageBoxButtons
ØØ` q
.
ØØq r
OK
ØØr t
,
ØØt u
MessageBoxIconØØv Ñ
.ØØÑ Ö
InformationØØÖ ê
)ØØê ë
;ØØë í
}
∞∞ 
}
±± 	
}
≤≤ 
}≥≥ ®
}C:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str (
)( )
]) *
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str *
)* +
]+ ,
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *ä
mC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Program.cs
	namespace 	
ProyectoFinal
 
{ 
internal		 
static		 
class		 
Program		 !
{

 
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
) 
{ 	
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
Application 
. 
Run 
( 
new 
	FormLogin  )
() *
)* +
)+ ,
;, -
} 	
} 
} Òﬁ
vC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\RegistrarCliente.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
RegistrarCliente )
:* +
Form, 0
{ 
private		 

ClsCliente		 
cliente		 "
;		" #
ApisPeru

 
ApisPeru

 
=

 
new

 
ApisPeru

  (
(

( )
)

) *
;

* +
private 
void !
RegistrarCliente_Load *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
} 	
public 
RegistrarCliente 
(  
)  !
{ 	
InitializeComponent 
(  
)  !
;! "
CargarClientes 
( 
) 
; 
ActivarBotones 
( 
true 
,  
false! &
,& '
false( -
,- .
false/ 4
,4 5
false6 ;
); <
;< =
ActivarCampos 
( 
false 
,  
false! &
,& '
false( -
,- .
false/ 4
,4 5
false6 ;
,; <
false= B
,B C
falseD I
)I J
;J K
cliente 
= 
new 

ClsCliente $
($ %
)% &
;& '
} 	
private 
string %
ObtenerGeneroSeleccionado 0
(0 1
)1 2
{ 	
switch 
( 
	cmbGenero 
. 
SelectedIndex +
)+ ,
{ 
case 
$num 
: 
return 
$str &
;& '
case 
$num 
: 
return   
$str   %
;  % &
default!! 
:!! 
return"" 
$str"" "
;""" #
}## 
}$$ 	
public&& 
void&& 
CargarClientes&& "
(&&" #
)&&# $
{'' 	
dgvClientes(( 
.(( 

DataSource(( "
=((# $

ClsCliente((% /
.((/ 0 
ObtenerListaClientes((0 D
(((D E
)((E F
;((F G
dgvClientes)) 
.)) 
Columns)) 
[))  
$num))  !
]))! "
.))" #
Width))# (
=))) *
$num))+ -
;))- .
dgvClientes** 
.** 
Columns** 
[**  
$num**  !
]**! "
.**" #
Width**# (
=**) *
$num**+ .
;**. /
dgvClientes++ 
.++ 
Columns++ 
[++  
$num++  !
]++! "
.++" #
Width++# (
=++) *
$num+++ -
;++- .
dgvClientes,, 
.,, 
Columns,, 
[,,  
$num,,  !
],,! "
.,," #
Width,,# (
=,,) *
$num,,+ -
;,,- .
dgvClientes-- 
.-- 
Columns-- 
[--  
$num--  !
]--! "
.--" #
Width--# (
=--) *
$num--+ -
;--- .
}.. 	
private00 
void00  
btnRegistrar_Click_100 )
(00) *
object00* 0
sender001 7
,007 8
	EventArgs009 B
e00C D
)00D E
{11 	
try22 
{33 
cliente44 
.44 
Nombre44 
=44  
	txtNombre44! *
.44* +
Text44+ /
;44/ 0
cliente55 
.55 
Apellido55  
=55! "
txtApellido55# .
.55. /
Text55/ 3
;553 4
cliente66 
.66 
DNI66 
=66 
txtDocumento66 *
.66* +
Text66+ /
;66/ 0
cliente77 
.77 
Telefono77  
=77! "
txtTelefono77# .
.77. /
Text77/ 3
;773 4
cliente88 
.88 
	Direccion88 !
=88" #
txtDireccion88$ 0
.880 1
Text881 5
;885 6
cliente99 
.99 
Genero99 
=99  %
ObtenerGeneroSeleccionado99! :
(99: ;
)99; <
;99< =
cliente:: 
.:: 
Correo:: 
=:: 
	txtCorreo:: (
.::( )
Text::) -
;::- .
if<< 
(<< 

ClsCliente<< 
.<< 
ExisteClientePorDNI<< 2
(<<2 3
cliente<<3 :
.<<: ;
DNI<<; >
)<<> ?
)<<? @
{== 

MessageBox>> 
.>> 
Show>> #
(>># $
$str>>$ L
,>>L M
$str>>N U
,>>U V
MessageBoxButtons>>W h
.>>h i
OK>>i k
,>>k l
MessageBoxIcon>>m {
.>>{ |
Error	>>| Å
)
>>Å Ç
;
>>Ç É
return?? 
;?? 
}@@ 
ifBB 
(BB 
clienteBB 
.BB 
ValidarDatosBB (
(BB( )
)BB) *
)BB* +
{CC 
clienteDD 
.DD !
InsertarEnBaseDeDatosDD 1
(DD1 2
)DD2 3
;DD3 4

MessageBoxEE 
.EE 
ShowEE #
(EE# $
$strEE$ Q
,EEQ R
$strEES \
,EE\ ]
MessageBoxButtonsEE^ o
.EEo p
OKEEp r
,EEr s
MessageBoxIcon	EEt Ç
.
EEÇ É
Information
EEÉ é
)
EEé è
;
EEè ê
ActivarBotonesFF "
(FF" #
trueFF# '
,FF' (
falseFF) .
,FF. /
falseFF0 5
,FF5 6
falseFF7 <
,FF< =
falseFF> C
)FFC D
;FFD E
ActivarCamposGG !
(GG! "
falseGG" '
,GG' (
falseGG) .
,GG. /
falseGG0 5
,GG5 6
falseGG7 <
,GG< =
falseGG> C
,GGC D
falseGGE J
,GGJ K
falseGGL Q
)GGQ R
;GGR S
LimpiarHH 
(HH 
)HH 
;HH 
CargarClientesII "
(II" #
)II# $
;II$ %
}JJ 
elseKK 
{LL 

MessageBoxMM 
.MM 
ShowMM #
(MM# $
$strMM$ R
,MMR S
$strMMT [
,MM[ \
MessageBoxButtonsMM] n
.MMn o
OKMMo q
,MMq r
MessageBoxIcon	MMs Å
.
MMÅ Ç
Error
MMÇ á
)
MMá à
;
MMà â
}NN 
}OO 
catchPP 
(PP 
	ExceptionPP 
exPP 
)PP  
{QQ 

MessageBoxRR 
.RR 
ShowRR 
(RR  
$"RR  "
$strRR" A
{RRA B
exRRB D
.RRD E
MessageRRE L
}RRL M
"RRM N
,RRN O
$strRRP W
,RRW X
MessageBoxButtonsRRY j
.RRj k
OKRRk m
,RRm n
MessageBoxIconRRo }
.RR} ~
Error	RR~ É
)
RRÉ Ñ
;
RRÑ Ö
}SS 
}TT 	
publicVV 
voidVV 
ActivarCamposVV !
(VV! "
boolVV" &
nVV' (
,VV( )
boolVV* .
aVV/ 0
,VV0 1
boolVV2 6
dVV7 8
,VV8 9
boolVV: >
diVV? A
,VVA B
boolVVC G
tVVH I
,VVI J
boolVVK O
gVVP Q
,VVQ R
boolVVR V
cVVW X
)VVX Y
{WW 	
	txtNombreXX 
.XX 
EnabledXX 
=XX 
nXX  !
;XX! "
txtApellidoYY 
.YY 
EnabledYY 
=YY  !
aYY" #
;YY# $
txtDocumentoZZ 
.ZZ 
EnabledZZ  
=ZZ! "
dZZ# $
;ZZ$ %
txtDireccion[[ 
.[[ 
Enabled[[  
=[[! "
di[[# %
;[[% &
txtTelefono\\ 
.\\ 
Enabled\\ 
=\\  !
t\\" #
;\\# $
	cmbGenero]] 
.]] 
Enabled]] 
=]] 
g]]  !
;]]! "
	txtCorreo^^ 
.^^ 
Enabled^^ 
=^^ 
c^^  !
;^^! "
}__ 	
public`` 
void`` 
ActivarBotones`` "
(``" #
bool``# '
n``( )
,``) *
bool``+ /
r``0 1
,``1 2
bool``3 7
m``8 9
,``9 :
bool``; ?
el``@ B
,``B C
bool``D H
c``I J
)``J K
{aa 	
btnNuevobb 
.bb 
Enabledbb 
=bb 
nbb  
;bb  !
btnRegistrarcc 
.cc 
Enabledcc  
=cc! "
rcc# $
;cc$ %
btnModificardd 
.dd 
Enableddd  
=dd! "
mdd# $
;dd$ %
btnEliminaree 
.ee 
Enabledee 
=ee  !
elee" $
;ee$ %
btnCancelarff 
.ff 
Enabledff 
=ff  !
cff" #
;ff# $
}gg 	
publicii 
voidii 
Limpiarii 
(ii 
)ii 
{jj 	
txtApellidokk 
.kk 
Textkk 
=kk 
$strkk !
;kk! "
txtDocumentoll 
.ll 
Textll 
=ll 
$strll  "
;ll" #
	txtNombremm 
.mm 
Textmm 
=mm 
$strmm 
;mm  
txtTelefononn 
.nn 
Textnn 
=nn 
$strnn !
;nn! "
txtDireccionoo 
.oo 
Textoo 
=oo 
$stroo  "
;oo" #
	cmbGeneropp 
.pp 
SelectedIndexpp #
=pp$ %
-pp& '
$numpp' (
;pp( )
txtCodqq 
.qq 
Textqq 
=qq 
$strqq 
;qq 
}rr 	
privatett 
voidtt 
btnLimpiar_Clicktt %
(tt% &
objecttt& ,
sendertt- 3
,tt3 4
	EventArgstt5 >
ett? @
)tt@ A
{uu 	
ActivarBotonesvv 
(vv 
truevv 
,vv  
falsevv! &
,vv& '
falsevv( -
,vv- .
falsevv/ 4
,vv4 5
falsevv6 ;
)vv; <
;vv< =
ActivarCamposww 
(ww 
falseww 
,ww  
falseww! &
,ww& '
falseww( -
,ww- .
falseww/ 4
,ww4 5
falseww6 ;
,ww; <
falseww= B
,wwB C
falsewwC H
)wwH I
;wwI J
Limpiarxx 
(xx 
)xx 
;xx 
txtCodyy 
.yy 
Textyy 
=yy 
$stryy 
;yy 
txtBdnizz 
.zz 
Enabledzz 
=zz 
falsezz #
;zz# $
btnConsulta{{ 
.{{ 
Enabled{{ 
={{  !
false{{" '
;{{' (
}|| 	
private~~ 
void~~ 
btnNuevo_Click~~ #
(~~# $
object~~$ *
sender~~+ 1
,~~1 2
	EventArgs~~3 <
e~~= >
)~~> ?
{ 	
ActivarCampos
ÄÄ 
(
ÄÄ 
true
ÄÄ 
,
ÄÄ 
true
ÄÄ  $
,
ÄÄ$ %
true
ÄÄ& *
,
ÄÄ* +
true
ÄÄ, 0
,
ÄÄ0 1
true
ÄÄ2 6
,
ÄÄ6 7
true
ÄÄ8 <
,
ÄÄ< =
true
ÄÄ= A
)
ÄÄA B
;
ÄÄB C
ActivarBotones
ÅÅ 
(
ÅÅ 
true
ÅÅ 
,
ÅÅ  
true
ÅÅ! %
,
ÅÅ% &
true
ÅÅ' +
,
ÅÅ+ ,
true
ÅÅ- 1
,
ÅÅ1 2
true
ÅÅ3 7
)
ÅÅ7 8
;
ÅÅ8 9
Limpiar
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
txtCod
ÉÉ 
.
ÉÉ 
Text
ÉÉ 
=
ÉÉ 
$str
ÉÉ 
;
ÉÉ 
btnConsulta
ÑÑ 
.
ÑÑ 
Enabled
ÑÑ 
=
ÑÑ  !
true
ÑÑ" &
;
ÑÑ& '
txtBdni
ÖÖ 
.
ÖÖ 
Enabled
ÖÖ 
=
ÖÖ 
true
ÖÖ "
;
ÖÖ" #
}
ÜÜ 	
private
àà 
void
àà #
dgvClientes_CellClick
àà *
(
àà* +
object
àà+ 1
sender
àà2 8
,
àà8 9'
DataGridViewCellEventArgs
àà: S
e
ààT U
)
ààU V
{
ââ 	
if
ää 
(
ää 
e
ää 
.
ää 
RowIndex
ää 
>=
ää 
$num
ää 
&&
ää  "
e
ää# $
.
ää$ %
RowIndex
ää% -
<
ää. /
dgvClientes
ää0 ;
.
ää; <
Rows
ää< @
.
ää@ A
Count
ääA F
)
ääF G
{
ãã 
DataGridViewRow
åå 
fila
åå  $
=
åå% &
dgvClientes
åå' 2
.
åå2 3
Rows
åå3 7
[
åå7 8
e
åå8 9
.
åå9 :
RowIndex
åå: B
]
ååB C
;
ååC D
cliente
éé 
.
éé 

CodCliente
éé "
=
éé# $
Convert
éé% ,
.
éé, -
ToInt32
éé- 4
(
éé4 5
fila
éé5 9
.
éé9 :
Cells
éé: ?
[
éé? @
$str
éé@ L
]
ééL M
.
ééM N
Value
ééN S
)
ééS T
;
ééT U
cliente
èè 
.
èè 
Nombre
èè 
=
èè  
fila
èè! %
.
èè% &
Cells
èè& +
[
èè+ ,
$str
èè, 4
]
èè4 5
.
èè5 6
Value
èè6 ;
.
èè; <
ToString
èè< D
(
èèD E
)
èèE F
;
èèF G
cliente
êê 
.
êê 
Apellido
êê  
=
êê! "
fila
êê# '
.
êê' (
Cells
êê( -
[
êê- .
$str
êê. 8
]
êê8 9
.
êê9 :
Value
êê: ?
.
êê? @
ToString
êê@ H
(
êêH I
)
êêI J
;
êêJ K
cliente
ëë 
.
ëë 
DNI
ëë 
=
ëë 
fila
ëë "
.
ëë" #
Cells
ëë# (
[
ëë( )
$str
ëë) .
]
ëë. /
.
ëë/ 0
Value
ëë0 5
.
ëë5 6
ToString
ëë6 >
(
ëë> ?
)
ëë? @
;
ëë@ A
cliente
íí 
.
íí 
Telefono
íí  
=
íí! "
fila
íí# '
.
íí' (
Cells
íí( -
[
íí- .
$str
íí. 8
]
íí8 9
.
íí9 :
Value
íí: ?
.
íí? @
ToString
íí@ H
(
ííH I
)
ííI J
;
ííJ K
cliente
ìì 
.
ìì 
	Direccion
ìì !
=
ìì" #
fila
ìì$ (
.
ìì( )
Cells
ìì) .
[
ìì. /
$str
ìì/ :
]
ìì: ;
.
ìì; <
Value
ìì< A
.
ììA B
ToString
ììB J
(
ììJ K
)
ììK L
;
ììL M
cliente
îî 
.
îî 
Genero
îî 
=
îî  
fila
îî! %
.
îî% &
Cells
îî& +
[
îî+ ,
$str
îî, 4
]
îî4 5
.
îî5 6
Value
îî6 ;
.
îî; <
ToString
îî< D
(
îîD E
)
îîE F
;
îîF G
cliente
ïï 
.
ïï 
Correo
ïï 
=
ïï 
fila
ïï  $
.
ïï$ %
Cells
ïï% *
[
ïï* +
$str
ïï+ 3
]
ïï3 4
.
ïï4 5
Value
ïï5 :
.
ïï: ;
ToString
ïï; C
(
ïïC D
)
ïïD E
;
ïïE F
	txtNombre
óó 
.
óó 
Text
óó 
=
óó  
cliente
óó! (
.
óó( )
Nombre
óó) /
;
óó/ 0
txtApellido
òò 
.
òò 
Text
òò  
=
òò! "
cliente
òò# *
.
òò* +
Apellido
òò+ 3
;
òò3 4
txtDocumento
ôô 
.
ôô 
Text
ôô !
=
ôô" #
cliente
ôô$ +
.
ôô+ ,
DNI
ôô, /
;
ôô/ 0
txtTelefono
öö 
.
öö 
Text
öö  
=
öö! "
cliente
öö# *
.
öö* +
Telefono
öö+ 3
;
öö3 4
txtDireccion
õõ 
.
õõ 
Text
õõ !
=
õõ" #
cliente
õõ$ +
.
õõ+ ,
	Direccion
õõ, 5
;
õõ5 6
txtCod
úú 
.
úú 
Text
úú 
=
úú 
cliente
úú %
.
úú% &

CodCliente
úú& 0
.
úú0 1
ToString
úú1 9
(
úú9 :
)
úú: ;
;
úú; <
	txtCorreo
ùù 
.
ùù 
Text
ùù 
=
ùù  
cliente
ùù! (
.
ùù( )
Correo
ùù) /
;
ùù/ 0
int
üü 
indiceGenero
üü  
=
üü! "
	cmbGenero
üü# ,
.
üü, -

FindString
üü- 7
(
üü7 8
cliente
üü8 ?
.
üü? @
Genero
üü@ F
)
üüF G
;
üüG H
	cmbGenero
†† 
.
†† 
SelectedIndex
†† '
=
††( )
indiceGenero
††* 6
;
††6 7
ActivarCampos
°° 
(
°° 
true
°° "
,
°°" #
true
°°$ (
,
°°( )
true
°°* .
,
°°. /
true
°°0 4
,
°°4 5
true
°°6 :
,
°°: ;
true
°°< @
,
°°@ A
true
°°B F
)
°°F G
;
°°G H
ActivarBotones
¢¢ 
(
¢¢ 
true
¢¢ #
,
¢¢# $
true
¢¢% )
,
¢¢) *
true
¢¢+ /
,
¢¢/ 0
true
¢¢1 5
,
¢¢5 6
true
¢¢7 ;
)
¢¢; <
;
¢¢< =
}
££ 
}
§§ 	
private
¶¶ 
void
¶¶  
btnModificar_Click
¶¶ '
(
¶¶' (
object
¶¶( .
sender
¶¶/ 5
,
¶¶5 6
	EventArgs
¶¶7 @
e
¶¶A B
)
¶¶B C
{
ßß 	
try
®® 
{
©© 
cliente
™™ 
.
™™ 
Nombre
™™ 
=
™™  
	txtNombre
™™! *
.
™™* +
Text
™™+ /
;
™™/ 0
cliente
´´ 
.
´´ 
Apellido
´´  
=
´´! "
txtApellido
´´# .
.
´´. /
Text
´´/ 3
;
´´3 4
cliente
¨¨ 
.
¨¨ 
DNI
¨¨ 
=
¨¨ 
txtDocumento
¨¨ *
.
¨¨* +
Text
¨¨+ /
;
¨¨/ 0
cliente
≠≠ 
.
≠≠ 
Telefono
≠≠  
=
≠≠! "
txtTelefono
≠≠# .
.
≠≠. /
Text
≠≠/ 3
;
≠≠3 4
cliente
ÆÆ 
.
ÆÆ 
	Direccion
ÆÆ !
=
ÆÆ" #
txtDireccion
ÆÆ$ 0
.
ÆÆ0 1
Text
ÆÆ1 5
;
ÆÆ5 6
cliente
ØØ 
.
ØØ 
Genero
ØØ 
=
ØØ  '
ObtenerGeneroSeleccionado
ØØ! :
(
ØØ: ;
)
ØØ; <
;
ØØ< =
cliente
∞∞ 
.
∞∞ 
Correo
∞∞ 
=
∞∞ 
	txtCorreo
∞∞  )
.
∞∞) *
Text
∞∞* .
;
∞∞. /
if
≤≤ 
(
≤≤ 
cliente
≤≤ 
.
≤≤ 
ValidarDatos
≤≤ (
(
≤≤( )
)
≤≤) *
)
≤≤* +
{
≥≥ 
cliente
¥¥ 
.
¥¥ $
ModificarEnBaseDeDatos
¥¥ 2
(
¥¥2 3
)
¥¥3 4
;
¥¥4 5

MessageBox
∂∂ 
.
∂∂ 
Show
∂∂ #
(
∂∂# $
$str
∂∂$ Q
,
∂∂Q R
$str
∂∂S \
,
∂∂\ ]
MessageBoxButtons
∂∂^ o
.
∂∂o p
OK
∂∂p r
,
∂∂r s
MessageBoxIcon∂∂t Ç
.∂∂Ç É
Information∂∂É é
)∂∂é è
;∂∂è ê
ActivarBotones
∑∑ "
(
∑∑" #
true
∑∑# '
,
∑∑' (
false
∑∑) .
,
∑∑. /
false
∑∑0 5
,
∑∑5 6
false
∑∑7 <
,
∑∑< =
false
∑∑> C
)
∑∑C D
;
∑∑D E
ActivarCampos
∏∏ !
(
∏∏! "
false
∏∏" '
,
∏∏' (
false
∏∏) .
,
∏∏. /
false
∏∏0 5
,
∏∏5 6
false
∏∏7 <
,
∏∏< =
false
∏∏> C
,
∏∏C D
false
∏∏E J
,
∏∏J K
false
∏∏L Q
)
∏∏Q R
;
∏∏R S
Limpiar
ππ 
(
ππ 
)
ππ 
;
ππ 
CargarClientes
∫∫ "
(
∫∫" #
)
∫∫# $
;
∫∫$ %
}
ªª 
else
ºº 
{
ΩΩ 

MessageBox
ææ 
.
ææ 
Show
ææ #
(
ææ# $
$str
ææ$ R
,
ææR S
$str
ææT [
,
ææ[ \
MessageBoxButtons
ææ] n
.
ææn o
OK
ææo q
,
ææq r
MessageBoxIconææs Å
.ææÅ Ç
ErrorææÇ á
)ææá à
;ææà â
}
øø 
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¬¬ 

MessageBox
√√ 
.
√√ 
Show
√√ 
(
√√  
$"
√√  "
$str
√√" A
{
√√A B
ex
√√B D
.
√√D E
Message
√√E L
}
√√L M
"
√√M N
,
√√N O
$str
√√P W
,
√√W X
MessageBoxButtons
√√Y j
.
√√j k
OK
√√k m
,
√√m n
MessageBoxIcon
√√o }
.
√√} ~
Error√√~ É
)√√É Ñ
;√√Ñ Ö
}
ƒƒ 
}
≈≈ 	
private
«« 
void
«« 
btnEliminar_Click
«« &
(
««& '
object
««' -
sender
««. 4
,
««4 5
	EventArgs
««6 ?
e
««@ A
)
««A B
{
»» 	
try
…… 
{
   
if
ÀÀ 
(
ÀÀ 
cliente
ÀÀ 
.
ÀÀ 

CodCliente
ÀÀ &
==
ÀÀ' )
$num
ÀÀ* +
||
ÀÀ, .
txtCod
ÀÀ/ 5
.
ÀÀ5 6
Text
ÀÀ6 :
==
ÀÀ; =
$str
ÀÀ> A
)
ÀÀA B
{
ÃÃ 

MessageBox
ÕÕ 
.
ÕÕ 
Show
ÕÕ #
(
ÕÕ# $
$str
ÕÕ$ W
,
ÕÕW X
$str
ÕÕY `
,
ÕÕ` a
MessageBoxButtons
ÕÕb s
.
ÕÕs t
OK
ÕÕt v
,
ÕÕv w
MessageBoxIconÕÕx Ü
.ÕÕÜ á
ErrorÕÕá å
)ÕÕå ç
;ÕÕç é
return
ŒŒ 
;
ŒŒ 
}
œœ 
cliente
–– 
.
–– #
EliminarEnBaseDeDatos
–– -
(
––- .
)
––. /
;
––/ 0

MessageBox
““ 
.
““ 
Show
““ 
(
““  
$str
““  L
,
““L M
$str
““N W
,
““W X
MessageBoxButtons
““Y j
.
““j k
OK
““k m
,
““m n
MessageBoxIcon
““o }
.
““} ~
Information““~ â
)““â ä
;““ä ã
ActivarBotones
”” 
(
”” 
true
”” #
,
””# $
false
””% *
,
””* +
false
””, 1
,
””1 2
false
””3 8
,
””8 9
false
””: ?
)
””? @
;
””@ A
ActivarCampos
‘‘ 
(
‘‘ 
false
‘‘ #
,
‘‘# $
false
‘‘% *
,
‘‘* +
false
‘‘, 1
,
‘‘1 2
false
‘‘3 8
,
‘‘8 9
false
‘‘: ?
,
‘‘? @
false
‘‘A F
,
‘‘F G
false
‘‘H M
)
‘‘M N
;
‘‘N O
Limpiar
’’ 
(
’’ 
)
’’ 
;
’’ 
CargarClientes
÷÷ 
(
÷÷ 
)
÷÷  
;
÷÷  !
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
ŸŸ 

MessageBox
⁄⁄ 
.
⁄⁄ 
Show
⁄⁄ 
(
⁄⁄  
$"
⁄⁄  "
$str
⁄⁄" U
"
⁄⁄U V
,
⁄⁄V W
$str
⁄⁄X _
,
⁄⁄_ `
MessageBoxButtons
⁄⁄a r
.
⁄⁄r s
OK
⁄⁄s u
,
⁄⁄u v
MessageBoxIcon⁄⁄w Ö
.⁄⁄Ö Ü
Error⁄⁄Ü ã
)⁄⁄ã å
;⁄⁄å ç
}
€€ 
}
‹‹ 	
private
ﬁﬁ 
void
ﬁﬁ 
groupBox2_Enter
ﬁﬁ $
(
ﬁﬁ$ %
object
ﬁﬁ% +
sender
ﬁﬁ, 2
,
ﬁﬁ2 3
	EventArgs
ﬁﬁ4 =
e
ﬁﬁ> ?
)
ﬁﬁ? @
{
ﬂﬂ 	
}
·· 	
private
„„ 
void
„„ 
button1_Click
„„ "
(
„„" #
object
„„# )
sender
„„* 0
,
„„0 1
	EventArgs
„„2 ;
e
„„< =
)
„„= >
{
‰‰ 	
consultarCliente
ÂÂ 
(
ÂÂ 
)
ÂÂ 
;
ÂÂ 
}
ÊÊ 	
private
ÁÁ 
void
ÁÁ 
consultarCliente
ÁÁ %
(
ÁÁ% &
)
ÁÁ& '
{
ËË 	
try
ÈÈ 
{
ÍÍ 
if
ÎÎ 
(
ÎÎ 
txtBdni
ÎÎ 
.
ÎÎ 
Text
ÎÎ  
.
ÎÎ  !
Length
ÎÎ! '
==
ÎÎ( *
$num
ÎÎ+ ,
)
ÎÎ, -
{
ÏÏ 
dynamic
ÌÌ 
	respuesta
ÌÌ %
=
ÌÌ& '
ApisPeru
ÌÌ( 0
.
ÌÌ0 1
Get
ÌÌ1 4
(
ÌÌ4 5
$str
ÌÌ5 ^
+
ÌÌ_ `
txtBdni
ÌÌa h
.
ÌÌh i
Text
ÌÌi m
+
ÌÌn o
$strÌÌp Ù
)ÌÌÙ ı
;ÌÌı ˆ
	txtNombre
ÓÓ 
.
ÓÓ 
Text
ÓÓ "
=
ÓÓ# $
	respuesta
ÓÓ% .
.
ÓÓ. /
nombres
ÓÓ/ 6
.
ÓÓ6 7
ToString
ÓÓ7 ?
(
ÓÓ? @
)
ÓÓ@ A
;
ÓÓA B
txtApellido
ÔÔ 
.
ÔÔ  
Text
ÔÔ  $
=
ÔÔ% &
	respuesta
ÔÔ' 0
.
ÔÔ0 1
apellidoPaterno
ÔÔ1 @
.
ÔÔ@ A
ToString
ÔÔA I
(
ÔÔI J
)
ÔÔJ K
+
ÔÔL M
$str
ÔÔN Q
+
ÔÔR S
	respuesta
ÔÔT ]
.
ÔÔ] ^
apellidoMaterno
ÔÔ^ m
.
ÔÔm n
ToString
ÔÔn v
(
ÔÔv w
)
ÔÔw x
;
ÔÔx y
txtDocumento
  
.
  !
Text
! %
=
& '
txtBdni
( /
.
/ 0
Text
0 4
;
4 5
txtBdni
ÒÒ 
.
ÒÒ 
Text
ÒÒ  
=
ÒÒ! "
$str
ÒÒ# %
;
ÒÒ% &
}
ÚÚ 
else
ÛÛ 
{
ÙÙ 

MessageBox
ıı 
.
ıı 
Show
ıı #
(
ıı# $
$str
ıı$ L
,
ııL M
$str
ııN b
,
ııb c
MessageBoxButtons
ııd u
.
ııu v
OK
ııv x
,
ııx y
MessageBoxIconıız à
.ııà â
Informationııâ î
)ııî ï
;ııï ñ
}
ˆˆ 
}
¯¯ 
catch
˘˘ 
(
˘˘ 
	Exception
˘˘ 
)
˘˘ 
{
˙˙ 

MessageBox
¸¸ 
.
¸¸ 
Show
¸¸ 
(
¸¸  
$str
¸¸  H
,
¸¸H I
$str
¸¸J ^
,
¸¸^ _
MessageBoxButtons
¸¸` q
.
¸¸q r
OK
¸¸r t
,
¸¸t u
MessageBoxIcon¸¸v Ñ
.¸¸Ñ Ö
Information¸¸Ö ê
)¸¸ê ë
;¸¸ë í
}
˝˝ 
}
˛˛ 	
private
ÄÄ 
void
ÄÄ *
dgvClientes_CellContentClick
ÄÄ 1
(
ÄÄ1 2
object
ÄÄ2 8
sender
ÄÄ9 ?
,
ÄÄ? @'
DataGridViewCellEventArgs
ÄÄA Z
e
ÄÄ[ \
)
ÄÄ\ ]
{
ÅÅ 	
}
ÉÉ 	
}
ÑÑ 
}ÖÖ ÒÛ
rC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\MDIPrincipal.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
MDIPrincipal %
:& '
Form( ,
{ 
private 
int 
childFormNumber #
=$ %
$num& '
;' (
public 
MDIPrincipal 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
ShowNewForm  
(  !
object! '
sender( .
,. /
	EventArgs0 9
e: ;
); <
{ 	
Form 
	childForm 
= 
new  
Form! %
(% &
)& '
;' (
	childForm 
. 
	MdiParent 
=  !
this" &
;& '
	childForm 
. 
Text 
= 
$str '
+( )
childFormNumber* 9
++9 ;
;; <
	childForm 
. 
Show 
( 
) 
; 
} 	
private!! 
void!! 
OpenFile!! 
(!! 
object!! $
sender!!% +
,!!+ ,
	EventArgs!!- 6
e!!7 8
)!!8 9
{"" 	
OpenFileDialog## 
openFileDialog## )
=##* +
new##, /
OpenFileDialog##0 >
(##> ?
)##? @
;##@ A
openFileDialog$$ 
.$$ 
InitialDirectory$$ +
=$$, -
Environment$$. 9
.$$9 :
GetFolderPath$$: G
($$G H
Environment$$H S
.$$S T
SpecialFolder$$T a
.$$a b
Personal$$b j
)$$j k
;$$k l
openFileDialog%% 
.%% 
Filter%% !
=%%" #
$str%%$ b
;%%b c
if&& 
(&& 
openFileDialog&& 
.&& 

ShowDialog&& )
(&&) *
this&&* .
)&&. /
==&&0 2
DialogResult&&3 ?
.&&? @
OK&&@ B
)&&B C
{'' 
string(( 
FileName(( 
=((  !
openFileDialog((" 0
.((0 1
FileName((1 9
;((9 :
})) 
}** 	
private,, 
void,, )
SaveAsToolStripMenuItem_Click,, 2
(,,2 3
object,,3 9
sender,,: @
,,,@ A
	EventArgs,,B K
e,,L M
),,M N
{-- 	
SaveFileDialog.. 
saveFileDialog.. )
=..* +
new.., /
SaveFileDialog..0 >
(..> ?
)..? @
;..@ A
saveFileDialog// 
.// 
InitialDirectory// +
=//, -
Environment//. 9
.//9 :
GetFolderPath//: G
(//G H
Environment//H S
.//S T
SpecialFolder//T a
.//a b
Personal//b j
)//j k
;//k l
saveFileDialog00 
.00 
Filter00 !
=00" #
$str00$ b
;00b c
if11 
(11 
saveFileDialog11 
.11 

ShowDialog11 )
(11) *
this11* .
)11. /
==110 2
DialogResult113 ?
.11? @
OK11@ B
)11B C
{22 
string33 
FileName33 
=33  !
saveFileDialog33" 0
.330 1
FileName331 9
;339 :
}44 
}55 	
private77 
void77 (
ExitToolsStripMenuItem_Click77 1
(771 2
object772 8
sender779 ?
,77? @
	EventArgs77A J
e77K L
)77L M
{88 	
this99 
.99 
Close99 
(99 
)99 
;99 
}:: 	
private<< 
void<< *
CascadeToolStripMenuItem_Click<< 3
(<<3 4
object<<4 :
sender<<; A
,<<A B
	EventArgs<<C L
e<<M N
)<<N O
{== 	
	LayoutMdi>> 
(>> 
	MdiLayout>> 
.>>  
Cascade>>  '
)>>' (
;>>( )
}?? 	
privateAA 
voidAA /
#TileVerticalToolStripMenuItem_ClickAA 8
(AA8 9
objectAA9 ?
senderAA@ F
,AAF G
	EventArgsAAH Q
eAAR S
)AAS T
{BB 	
	LayoutMdiCC 
(CC 
	MdiLayoutCC 
.CC  
TileVerticalCC  ,
)CC, -
;CC- .
}DD 	
privateFF 
voidFF 1
%TileHorizontalToolStripMenuItem_ClickFF :
(FF: ;
objectFF; A
senderFFB H
,FFH I
	EventArgsFFJ S
eFFT U
)FFU V
{GG 	
	LayoutMdiHH 
(HH 
	MdiLayoutHH 
.HH  
TileHorizontalHH  .
)HH. /
;HH/ 0
}II 	
privateKK 
voidKK /
#ArrangeIconsToolStripMenuItem_ClickKK 8
(KK8 9
objectKK9 ?
senderKK@ F
,KKF G
	EventArgsKKH Q
eKKR S
)KKS T
{LL 	
	LayoutMdiMM 
(MM 
	MdiLayoutMM 
.MM  
ArrangeIconsMM  ,
)MM, -
;MM- .
}NN 	
privatePP 
voidPP +
CloseAllToolStripMenuItem_ClickPP 4
(PP4 5
objectPP5 ;
senderPP< B
,PPB C
	EventArgsPPD M
ePPN O
)PPO P
{QQ 	
foreachRR 
(RR 
FormRR 
	childFormRR #
inRR$ &
MdiChildrenRR' 2
)RR2 3
{SS 
	childFormTT 
.TT 
CloseTT 
(TT  
)TT  !
;TT! "
}UU 
}VV 	
privateXX 
voidXX 
MDIPrincipal_LoadXX &
(XX& '
objectXX' -
senderXX. 4
,XX4 5
	EventArgsXX6 ?
eXX@ A
)XXA B
{YY 	
}[[ 	
private]] 
void]] (
salirToolStripMenuItem_Click]] 1
(]]1 2
object]]2 8
sender]]9 ?
,]]? @
	EventArgs]]A J
e]]K L
)]]L M
{^^ 	
this__ 
.__ 
Dispose__ 
(__ 
)__ 
;__ 
}aa 	
privatecc 
voidcc '
toolStripLabel3_ButtonClickcc 0
(cc0 1
objectcc1 7
sendercc8 >
,cc> ?
	EventArgscc@ I
eccJ K
)ccK L
{dd 	
}ff 	
privatehh 
voidhh 3
'registroDePagosToolStripMenuItem1_Clickhh <
(hh< =
objecthh= C
senderhhD J
,hhJ K
	EventArgshhL U
ehhV W
)hhW X
{ii 	
RegistrarClientejj 
Rclientejj %
=jj& '
newjj( +
RegistrarClientejj, <
(jj< =
)jj= >
;jj> ?
Rclientekk 
.kk 
	MdiParentkk 
=kk  
thiskk! %
;kk% &
Rclientell 
.ll 
Showll 
(ll 
)ll 
;ll 
foreachmm 
(mm 
Formmm 
formHijomm "
inmm# %
thismm& *
.mm* +
MdiChildrenmm+ 6
)mm6 7
{nn 
ifoo 
(oo 
formHijooo 
!=oo 
Rclienteoo  (
)oo( )
{pp 
formHijoqq 
.qq 
Closeqq "
(qq" #
)qq# $
;qq$ %
}rr 
}ss 
}tt 	
privatevv 
voidvv !
toolStrip_ItemClickedvv *
(vv* +
objectvv+ 1
sendervv2 8
,vv8 9)
ToolStripItemClickedEventArgsvv: W
evvX Y
)vvY Z
{ww 	
}yy 	
private{{ 
void{{ 8
,programarNuevasCitasToolStripMenuItem1_Click{{ A
({{A B
object{{B H
sender{{I O
,{{O P
	EventArgs{{Q Z
e{{[ \
){{\ ]
{|| 	
FormProgramarCita}} 
ProgramarCita}} +
=}}, -
new}}. 1
FormProgramarCita}}2 C
(}}C D
)}}D E
;}}E F
ProgramarCita~~ 
.~~ 
	MdiParent~~ #
=~~$ %
this~~& *
;~~* +
ProgramarCita 
. 
Show 
( 
)  
;  !
foreach
ÄÄ 
(
ÄÄ 
Form
ÄÄ 
formHijo
ÄÄ "
in
ÄÄ# %
this
ÄÄ& *
.
ÄÄ* +
MdiChildren
ÄÄ+ 6
)
ÄÄ6 7
{
ÅÅ 
if
ÇÇ 
(
ÇÇ 
formHijo
ÇÇ 
!=
ÇÇ 
ProgramarCita
ÇÇ  -
)
ÇÇ- .
{
ÉÉ 
formHijo
ÑÑ 
.
ÑÑ 
Close
ÑÑ "
(
ÑÑ" #
)
ÑÑ# $
;
ÑÑ$ %
}
ÖÖ 
}
ÜÜ 
}
áá 	
private
ââ 
void
ââ 6
(citasProgramadasToolStripMenuItem1_Click
ââ =
(
ââ= >
object
ââ> D
sender
ââE K
,
ââK L
	EventArgs
ââM V
e
ââW X
)
ââX Y
{
ää 	"
FormCitasProgramadas
ãã  
citasProgramadas
ãã! 1
=
ãã2 3
new
ãã4 7"
FormCitasProgramadas
ãã8 L
(
ããL M
)
ããM N
;
ããN O
citasProgramadas
åå 
.
åå 
	MdiParent
åå &
=
åå' (
this
åå) -
;
åå- .
citasProgramadas
çç 
.
çç 
Show
çç !
(
çç! "
)
çç" #
;
çç# $
foreach
éé 
(
éé 
Form
éé 
formHijo
éé "
in
éé# %
this
éé& *
.
éé* +
MdiChildren
éé+ 6
)
éé6 7
{
èè 
if
êê 
(
êê 
formHijo
êê 
!=
êê 
citasProgramadas
êê  0
)
êê0 1
{
ëë 
formHijo
íí 
.
íí 
Close
íí "
(
íí" #
)
íí# $
;
íí$ %
}
ìì 
}
îî 
}
ïï 	
private
óó 
void
óó 9
+programarNuevasCitasToolStripMenuItem_Click
óó @
(
óó@ A
object
óóA G
sender
óóH N
,
óóN O
	EventArgs
óóP Y
e
óóZ [
)
óó[ \
{
òò 	
FormProgramarCita
ôô 
ProgramarCita
ôô +
=
ôô, -
new
ôô. 1
FormProgramarCita
ôô2 C
(
ôôC D
)
ôôD E
;
ôôE F
ProgramarCita
öö 
.
öö 
	MdiParent
öö #
=
öö$ %
this
öö& *
;
öö* +
ProgramarCita
õõ 
.
õõ 
Show
õõ 
(
õõ 
)
õõ  
;
õõ  !
foreach
úú 
(
úú 
Form
úú 
formHijo
úú "
in
úú# %
this
úú& *
.
úú* +
MdiChildren
úú+ 6
)
úú6 7
{
ùù 
if
ûû 
(
ûû 
formHijo
ûû 
!=
ûû 
ProgramarCita
ûû  -
)
ûû- .
{
üü 
formHijo
†† 
.
†† 
Close
†† "
(
††" #
)
††# $
;
††$ %
}
°° 
}
¢¢ 
}
££ 	
private
•• 
void
•• 7
)cambiosEnLaAgendaToolStripMenuItem1_Click
•• >
(
••> ?
object
••? E
sender
••F L
,
••L M
	EventArgs
••N W
e
••X Y
)
••Y Z
{
¶¶ 	
FormEditarAgenda
ßß 
EditarAgenda
ßß )
=
ßß* +
new
ßß, /
FormEditarAgenda
ßß0 @
(
ßß@ A
)
ßßA B
;
ßßB C
EditarAgenda
®® 
.
®® 
	MdiParent
®® "
=
®®# $
this
®®% )
;
®®) *
EditarAgenda
©© 
.
©© 
Show
©© 
(
©© 
)
©© 
;
©©  
foreach
™™ 
(
™™ 
Form
™™ 
formHijo
™™ "
in
™™# %
this
™™& *
.
™™* +
MdiChildren
™™+ 6
)
™™6 7
{
´´ 
if
¨¨ 
(
¨¨ 
formHijo
¨¨ 
!=
¨¨ 
EditarAgenda
¨¨  ,
)
¨¨, -
{
≠≠ 
formHijo
ÆÆ 
.
ÆÆ 
Close
ÆÆ "
(
ÆÆ" #
)
ÆÆ# $
;
ÆÆ$ %
}
ØØ 
}
∞∞ 
}
±± 	
private
≥≥ 
void
≥≥ 5
'citasProgramadasToolStripMenuItem_Click
≥≥ <
(
≥≥< =
object
≥≥= C
sender
≥≥D J
,
≥≥J K
	EventArgs
≥≥L U
e
≥≥V W
)
≥≥W X
{
¥¥ 	"
FormCitasProgramadas
µµ  
citasProgramadas
µµ! 1
=
µµ2 3
new
µµ4 7"
FormCitasProgramadas
µµ8 L
(
µµL M
)
µµM N
;
µµN O
citasProgramadas
∂∂ 
.
∂∂ 
	MdiParent
∂∂ &
=
∂∂' (
this
∂∂) -
;
∂∂- .
citasProgramadas
∑∑ 
.
∑∑ 
Show
∑∑ !
(
∑∑! "
)
∑∑" #
;
∑∑# $
foreach
∏∏ 
(
∏∏ 
Form
∏∏ 
formHijo
∏∏ "
in
∏∏# %
this
∏∏& *
.
∏∏* +
MdiChildren
∏∏+ 6
)
∏∏6 7
{
ππ 
if
∫∫ 
(
∫∫ 
formHijo
∫∫ 
!=
∫∫ 
citasProgramadas
∫∫  0
)
∫∫0 1
{
ªª 
formHijo
ºº 
.
ºº 
Close
ºº "
(
ºº" #
)
ºº# $
;
ºº$ %
}
ΩΩ 
}
ææ 
}
øø 	
private
¡¡ 
void
¡¡ 6
(cambiosEnLaAgendaToolStripMenuItem_Click
¡¡ =
(
¡¡= >
object
¡¡> D
sender
¡¡E K
,
¡¡K L
	EventArgs
¡¡M V
e
¡¡W X
)
¡¡X Y
{
¬¬ 	
FormEditarAgenda
√√ 
EditarAgenda
√√ )
=
√√* +
new
√√, /
FormEditarAgenda
√√0 @
(
√√@ A
)
√√A B
;
√√B C
EditarAgenda
ƒƒ 
.
ƒƒ 
	MdiParent
ƒƒ "
=
ƒƒ# $
this
ƒƒ% )
;
ƒƒ) *
EditarAgenda
≈≈ 
.
≈≈ 
Show
≈≈ 
(
≈≈ 
)
≈≈ 
;
≈≈  
foreach
∆∆ 
(
∆∆ 
Form
∆∆ 
formHijo
∆∆ "
in
∆∆# %
this
∆∆& *
.
∆∆* +
MdiChildren
∆∆+ 6
)
∆∆6 7
{
«« 
if
»» 
(
»» 
formHijo
»» 
!=
»» 
EditarAgenda
»»  ,
)
»», -
{
…… 
formHijo
   
.
   
Close
   "
(
  " #
)
  # $
;
  $ %
}
ÀÀ 
}
ÃÃ 
}
ÕÕ 	
private
œœ 
void
œœ 9
+registroDeEmpleadosToolStripMenuItem1_Click
œœ @
(
œœ@ A
object
œœA G
sender
œœH N
,
œœN O
	EventArgs
œœP Y
e
œœZ [
)
œœ[ \
{
–– 	
RegistrarEmpleado
—— 
registraremp
—— *
=
——+ ,
new
——- 0
RegistrarEmpleado
——1 B
(
——B C
)
——C D
;
——D E
registraremp
““ 
.
““ 
	MdiParent
““ "
=
““# $
this
““% )
;
““) *
registraremp
”” 
.
”” 
Show
”” 
(
”” 
)
”” 
;
””  
foreach
‘‘ 
(
‘‘ 
Form
‘‘ 
formHijo
‘‘ "
in
‘‘# %
this
‘‘& *
.
‘‘* +
MdiChildren
‘‘+ 6
)
‘‘6 7
{
’’ 
if
÷÷ 
(
÷÷ 
formHijo
÷÷ 
!=
÷÷ 
registraremp
÷÷  ,
)
÷÷, -
{
◊◊ 
formHijo
ÿÿ 
.
ÿÿ 
Close
ÿÿ "
(
ÿÿ" #
)
ÿÿ# $
;
ÿÿ$ %
}
ŸŸ 
}
⁄⁄ 
}
€€ 	
private
›› 
void
›› 8
*registroDeEmpleadosToolStripMenuItem_Click
›› ?
(
››? @
object
››@ F
sender
››G M
,
››M N
	EventArgs
››O X
e
››Y Z
)
››Z [
{
ﬁﬁ 	
RegistrarEmpleado
ﬂﬂ 
registraremp
ﬂﬂ *
=
ﬂﬂ+ ,
new
ﬂﬂ- 0
RegistrarEmpleado
ﬂﬂ1 B
(
ﬂﬂB C
)
ﬂﬂC D
;
ﬂﬂD E
registraremp
‡‡ 
.
‡‡ 
	MdiParent
‡‡ "
=
‡‡# $
this
‡‡% )
;
‡‡) *
registraremp
·· 
.
·· 
Show
·· 
(
·· 
)
·· 
;
··  
foreach
‚‚ 
(
‚‚ 
Form
‚‚ 
formHijo
‚‚ "
in
‚‚# %
this
‚‚& *
.
‚‚* +
MdiChildren
‚‚+ 6
)
‚‚6 7
{
„„ 
if
‰‰ 
(
‰‰ 
formHijo
‰‰ 
!=
‰‰ 
registraremp
‰‰  ,
)
‰‰, -
{
ÂÂ 
formHijo
ÊÊ 
.
ÊÊ 
Close
ÊÊ "
(
ÊÊ" #
)
ÊÊ# $
;
ÊÊ$ %
}
ÁÁ 
}
ËË 
}
ÈÈ 	
private
ÎÎ 
void
ÎÎ *
menusToolStripMenuItem_Click
ÎÎ 1
(
ÎÎ1 2
object
ÎÎ2 8
sender
ÎÎ9 ?
,
ÎÎ? @
	EventArgs
ÎÎA J
e
ÎÎK L
)
ÎÎL M
{
ÏÏ 	
}
ÓÓ 	
private
 
void
 6
(registroDeClienteToolStripMenuItem_Click
 =
(
= >
object
> D
sender
E K
,
K L
	EventArgs
M V
e
W X
)
X Y
{
ÒÒ 	"
FormHistorialClinico
ÚÚ  
Historiales
ÚÚ! ,
=
ÚÚ- .
new
ÚÚ/ 2"
FormHistorialClinico
ÚÚ3 G
(
ÚÚG H
)
ÚÚH I
;
ÚÚI J
Historiales
ÛÛ 
.
ÛÛ 
	MdiParent
ÛÛ !
=
ÛÛ" #
this
ÛÛ$ (
;
ÛÛ( )
Historiales
ÙÙ 
.
ÙÙ 
Show
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
foreach
ıı 
(
ıı 
Form
ıı 
formHijo
ıı "
in
ıı# %
this
ıı& *
.
ıı* +
MdiChildren
ıı+ 6
)
ıı6 7
{
ˆˆ 
if
˜˜ 
(
˜˜ 
formHijo
˜˜ 
!=
˜˜ 
Historiales
˜˜  +
)
˜˜+ ,
{
¯¯ 
formHijo
˘˘ 
.
˘˘ 
Close
˘˘ "
(
˘˘" #
)
˘˘# $
;
˘˘$ %
}
˙˙ 
}
˚˚ 
}
¸¸ 	
private
˛˛ 
void
˛˛ 7
)registroDeClienteToolStripMenuItem1_Click
˛˛ >
(
˛˛> ?
object
˛˛? E
sender
˛˛F L
,
˛˛L M
	EventArgs
˛˛N W
e
˛˛X Y
)
˛˛Y Z
{
ˇˇ 	
RegistrarCliente
ÄÄ 
registrarcliente
ÄÄ -
=
ÄÄ. /
new
ÄÄ0 3
RegistrarCliente
ÄÄ4 D
(
ÄÄD E
)
ÄÄE F
;
ÄÄF G
registrarcliente
ÅÅ 
.
ÅÅ 
	MdiParent
ÅÅ &
=
ÅÅ' (
this
ÅÅ) -
;
ÅÅ- .
registrarcliente
ÇÇ 
.
ÇÇ 
Show
ÇÇ !
(
ÇÇ! "
)
ÇÇ" #
;
ÇÇ# $
foreach
ÉÉ 
(
ÉÉ 
Form
ÉÉ 
formHijo
ÉÉ "
in
ÉÉ# %
this
ÉÉ& *
.
ÉÉ* +
MdiChildren
ÉÉ+ 6
)
ÉÉ6 7
{
ÑÑ 
if
ÖÖ 
(
ÖÖ 
formHijo
ÖÖ 
!=
ÖÖ 
registrarcliente
ÖÖ  0
)
ÖÖ0 1
{
ÜÜ 
formHijo
áá 
.
áá 
Close
áá "
(
áá" #
)
áá# $
;
áá$ %
}
àà 
}
ââ 
}
ää 	
private
åå 
void
åå 7
)reporteDeIngresosToolStripMenuItem1_Click
åå >
(
åå> ?
object
åå? E
sender
ååF L
,
ååL M
	EventArgs
ååN W
e
ååX Y
)
ååY Z
{
çç 	
}
èè 	
private
ëë 
void
ëë 6
(reporteDeIngresosToolStripMenuItem_Click
ëë =
(
ëë= >
object
ëë> D
sender
ëëE K
,
ëëK L
	EventArgs
ëëM V
e
ëëW X
)
ëëX Y
{
íí 	"
FormReporte_Clientes
ìì  
Rcliente
ìì! )
=
ìì* +
new
ìì, /"
FormReporte_Clientes
ìì0 D
(
ììD E
)
ììE F
;
ììF G
Rcliente
îî 
.
îî 
	MdiParent
îî 
=
îî  
this
îî! %
;
îî% &
Rcliente
ïï 
.
ïï 
Show
ïï 
(
ïï 
)
ïï 
;
ïï 
foreach
ññ 
(
ññ 
Form
ññ 
formHijo
ññ "
in
ññ# %
this
ññ& *
.
ññ* +
MdiChildren
ññ+ 6
)
ññ6 7
{
óó 
if
òò 
(
òò 
formHijo
òò 
!=
òò 
Rcliente
òò  (
)
òò( )
{
ôô 
formHijo
öö 
.
öö 
Close
öö "
(
öö" #
)
öö# $
;
öö$ %
}
õõ 
}
úú 
}
ùù 	
private
üü 
void
üü 5
'reporteDeGastosToolStripMenuItem1_Click
üü <
(
üü< =
object
üü= C
sender
üüD J
,
üüJ K
	EventArgs
üüL U
e
üüV W
)
üüW X
{
†† 	
}
¢¢ 	
private
§§ 
void
§§ 4
&reporteDeGastosToolStripMenuItem_Click
§§ ;
(
§§; <
object
§§< B
sender
§§C I
,
§§I J
	EventArgs
§§K T
e
§§U V
)
§§V W
{
•• 	
}
ßß 	
private
©© 
void
©© &
toolStripMenuItem1_Click
©© -
(
©©- .
object
©©. 4
sender
©©5 ;
,
©©; <
	EventArgs
©©= F
e
©©G H
)
©©H I
{
™™ 	"
FormReporte_Clientes
´´  
Rcliente
´´! )
=
´´* +
new
´´, /"
FormReporte_Clientes
´´0 D
(
´´D E
)
´´E F
;
´´F G
Rcliente
¨¨ 
.
¨¨ 
	MdiParent
¨¨ 
=
¨¨  
this
¨¨! %
;
¨¨% &
Rcliente
≠≠ 
.
≠≠ 
Show
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
foreach
ÆÆ 
(
ÆÆ 
Form
ÆÆ 
formHijo
ÆÆ "
in
ÆÆ# %
this
ÆÆ& *
.
ÆÆ* +
MdiChildren
ÆÆ+ 6
)
ÆÆ6 7
{
ØØ 
if
∞∞ 
(
∞∞ 
formHijo
∞∞ 
!=
∞∞ 
Rcliente
∞∞  (
)
∞∞( )
{
±± 
formHijo
≤≤ 
.
≤≤ 
Close
≤≤ "
(
≤≤" #
)
≤≤# $
;
≤≤$ %
}
≥≥ 
}
¥¥ 
}
µµ 	
private
∑∑ 
void
∑∑ &
toolStripMenuItem2_Click
∑∑ -
(
∑∑- .
object
∑∑. 4
sender
∑∑5 ;
,
∑∑; <
	EventArgs
∑∑= F
e
∑∑G H
)
∑∑H I
{
∏∏ 	!
FormReporte_Vacunas
ππ 
Rvacunas
ππ  (
=
ππ) *
new
ππ+ .!
FormReporte_Vacunas
ππ/ B
(
ππB C
)
ππC D
;
ππD E
Rvacunas
∫∫ 
.
∫∫ 
	MdiParent
∫∫ 
=
∫∫  
this
∫∫! %
;
∫∫% &
Rvacunas
ªª 
.
ªª 
Show
ªª 
(
ªª 
)
ªª 
;
ªª 
foreach
ºº 
(
ºº 
Form
ºº 
formHijo
ºº "
in
ºº# %
this
ºº& *
.
ºº* +
MdiChildren
ºº+ 6
)
ºº6 7
{
ΩΩ 
if
ææ 
(
ææ 
formHijo
ææ 
!=
ææ 
Rvacunas
ææ  (
)
ææ( )
{
øø 
formHijo
¿¿ 
.
¿¿ 
Close
¿¿ "
(
¿¿" #
)
¿¿# $
;
¿¿$ %
}
¡¡ 
}
¬¬ 
}
√√ 	
private
≈≈ 
void
≈≈ ?
1reporteDeHistorialCl√≠nicoToolStripMenuItem_Click
≈≈ E
(
≈≈E F
object
≈≈F L
sender
≈≈M S
,
≈≈S T
	EventArgs
≈≈U ^
e
≈≈_ `
)
≈≈` a
{
∆∆ 	+
FormReporte_Historial_Clinico
«« )

RHcl√≠nico
««* 3
=
««4 5
new
««6 9+
FormReporte_Historial_Clinico
««: W
(
««W X
)
««X Y
;
««Y Z

RHcl√≠nico
»» 
.
»» 
	MdiParent
»» 
=
»»  !
this
»»" &
;
»»& '

RHcl√≠nico
…… 
.
…… 
Show
…… 
(
…… 
)
…… 
;
…… 
foreach
   
(
   
Form
   
formHijo
   "
in
  # %
this
  & *
.
  * +
MdiChildren
  + 6
)
  6 7
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 
formHijo
ÃÃ 
!=
ÃÃ 

RHcl√≠nico
ÃÃ  )
)
ÃÃ) *
{
ÕÕ 
formHijo
ŒŒ 
.
ŒŒ 
Close
ŒŒ "
(
ŒŒ" #
)
ŒŒ# $
;
ŒŒ$ %
}
œœ 
}
–– 
}
—— 	
private
”” 
void
”” @
2reporteDePacientesPorDue√±oToolStripMenuItem_Click
”” F
(
””F G
object
””G M
sender
””N T
,
””T U
	EventArgs
””V _
e
””` a
)
””a b
{
‘‘ 	.
 FormReporte_Paciente_DNI_Cliente
’’ ,
	RPxdue√±o
’’- 5
=
’’6 7
new
’’8 ;.
 FormReporte_Paciente_DNI_Cliente
’’< \
(
’’\ ]
)
’’] ^
;
’’^ _
	RPxdue√±o
÷÷ 
.
÷÷ 
	MdiParent
÷÷ 
=
÷÷  
this
÷÷! %
;
÷÷% &
	RPxdue√±o
◊◊ 
.
◊◊ 
Show
◊◊ 
(
◊◊ 
)
◊◊ 
;
◊◊ 
foreach
ÿÿ 
(
ÿÿ 
Form
ÿÿ 
formHijo
ÿÿ "
in
ÿÿ# %
this
ÿÿ& *
.
ÿÿ* +
MdiChildren
ÿÿ+ 6
)
ÿÿ6 7
{
ŸŸ 
if
⁄⁄ 
(
⁄⁄ 
formHijo
⁄⁄ 
!=
⁄⁄ 
	RPxdue√±o
⁄⁄  (
)
⁄⁄( )
{
€€ 
formHijo
‹‹ 
.
‹‹ 
Close
‹‹ "
(
‹‹" #
)
‹‹# $
;
‹‹$ %
}
›› 
}
ﬁﬁ 
}
ﬂﬂ 	
private
·· 
void
·· C
5reporteEstad√≠sticoDePacientesToolStripMenuItem_Click
·· I
(
··I J
object
··J P
sender
··Q W
,
··W X
	EventArgs
··Y b
e
··c d
)
··d e
{
‚‚ 	/
!FormReporte_Estadistica_Pacientes
‰‰ -
REP
‰‰. 1
=
‰‰2 3
new
‰‰4 7/
!FormReporte_Estadistica_Pacientes
‰‰8 Y
(
‰‰Y Z
)
‰‰Z [
;
‰‰[ \
REP
ÂÂ 
.
ÂÂ 
	MdiParent
ÂÂ 
=
ÂÂ 
this
ÂÂ  
;
ÂÂ  !
REP
ÊÊ 
.
ÊÊ 
Show
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
foreach
ÁÁ 
(
ÁÁ 
Form
ÁÁ 
formHijo
ÁÁ "
in
ÁÁ# %
this
ÁÁ& *
.
ÁÁ* +
MdiChildren
ÁÁ+ 6
)
ÁÁ6 7
{
ËË 
if
ÈÈ 
(
ÈÈ 
formHijo
ÈÈ 
!=
ÈÈ 
REP
ÈÈ  #
)
ÈÈ# $
{
ÍÍ 
formHijo
ÎÎ 
.
ÎÎ 
Close
ÎÎ "
(
ÎÎ" #
)
ÎÎ# $
;
ÎÎ$ %
}
ÏÏ 
}
ÌÌ 
}
ÔÔ 	
private
ÒÒ 
void
ÒÒ >
0accesoAHistoriasClinicasToolStripMenuItem1_Click
ÒÒ E
(
ÒÒE F
object
ÒÒF L
sender
ÒÒM S
,
ÒÒS T
	EventArgs
ÒÒU ^
e
ÒÒ_ `
)
ÒÒ` a
{
ÚÚ 	"
FormHistorialClinico
ÛÛ  
Historiales
ÛÛ! ,
=
ÛÛ- .
new
ÛÛ/ 2"
FormHistorialClinico
ÛÛ3 G
(
ÛÛG H
)
ÛÛH I
;
ÛÛI J
Historiales
ÙÙ 
.
ÙÙ 
	MdiParent
ÙÙ !
=
ÙÙ" #
this
ÙÙ$ (
;
ÙÙ( )
Historiales
ıı 
.
ıı 
Show
ıı 
(
ıı 
)
ıı 
;
ıı 
foreach
ˆˆ 
(
ˆˆ 
Form
ˆˆ 
formHijo
ˆˆ "
in
ˆˆ# %
this
ˆˆ& *
.
ˆˆ* +
MdiChildren
ˆˆ+ 6
)
ˆˆ6 7
{
˜˜ 
if
¯¯ 
(
¯¯ 
formHijo
¯¯ 
!=
¯¯ 
Historiales
¯¯  +
)
¯¯+ ,
{
˘˘ 
formHijo
˙˙ 
.
˙˙ 
Close
˙˙ "
(
˙˙" #
)
˙˙# $
;
˙˙$ %
}
˚˚ 
}
¸¸ 
}
˝˝ 	
private
ˇˇ 
void
ˇˇ :
,registroDeVacunaci√≥nToolStripMenuItem_Click
ˇˇ @
(
ˇˇ@ A
object
ˇˇA G
sender
ˇˇH N
,
ˇˇN O
	EventArgs
ˇˇP Y
e
ˇˇZ [
)
ˇˇ[ \
{
ÄÄ 	%
FormRegistrarVacunacion
ÅÅ #
Historiales
ÅÅ$ /
=
ÅÅ0 1
new
ÅÅ2 5%
FormRegistrarVacunacion
ÅÅ6 M
(
ÅÅM N
)
ÅÅN O
;
ÅÅO P
Historiales
ÇÇ 
.
ÇÇ 
	MdiParent
ÇÇ !
=
ÇÇ" #
this
ÇÇ$ (
;
ÇÇ( )
Historiales
ÉÉ 
.
ÉÉ 
Show
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
foreach
ÑÑ 
(
ÑÑ 
Form
ÑÑ 
formHijo
ÑÑ "
in
ÑÑ# %
this
ÑÑ& *
.
ÑÑ* +
MdiChildren
ÑÑ+ 6
)
ÑÑ6 7
{
ÖÖ 
if
ÜÜ 
(
ÜÜ 
formHijo
ÜÜ 
!=
ÜÜ 
Historiales
ÜÜ  +
)
ÜÜ+ ,
{
áá 
formHijo
àà 
.
àà 
Close
àà "
(
àà" #
)
àà# $
;
àà$ %
}
ââ 
}
ää 
}
ãã 	
private
çç 
void
çç 8
*registroDePacienteToolStripMenuItem1_Click
çç ?
(
çç? @
object
çç@ F
sender
ççG M
,
ççM N
	EventArgs
ççO X
e
ççY Z
)
ççZ [
{
éé 	
RegistrarPaciente
èè 
Historiales
èè )
=
èè* +
new
èè, /
RegistrarPaciente
èè0 A
(
èèA B
)
èèB C
;
èèC D
Historiales
êê 
.
êê 
	MdiParent
êê !
=
êê" #
this
êê$ (
;
êê( )
Historiales
ëë 
.
ëë 
Show
ëë 
(
ëë 
)
ëë 
;
ëë 
foreach
íí 
(
íí 
Form
íí 
formHijo
íí "
in
íí# %
this
íí& *
.
íí* +
MdiChildren
íí+ 6
)
íí6 7
{
ìì 
if
îî 
(
îî 
formHijo
îî 
!=
îî 
Historiales
îî  +
)
îî+ ,
{
ïï 
formHijo
ññ 
.
ññ 
Close
ññ "
(
ññ" #
)
ññ# $
;
ññ$ %
}
óó 
}
òò 
}
ôô 	
private
õõ 
void
õõ ?
1registroDeDesparacitaci√≥nToolStripMenuItem_Click
õõ E
(
õõE F
object
õõF L
sender
õõM S
,
õõS T
	EventArgs
õõU ^
e
õõ_ `
)
õõ` a
{
úú 	*
FormRegistrarDesparasitacion
ùù (
desparasitacion
ùù) 8
=
ùù9 :
new
ùù; >*
FormRegistrarDesparasitacion
ùù? [
(
ùù[ \
)
ùù\ ]
;
ùù] ^
desparasitacion
ûû 
.
ûû 
	MdiParent
ûû %
=
ûû& '
this
ûû( ,
;
ûû, -
desparasitacion
üü 
.
üü 
Show
üü  
(
üü  !
)
üü! "
;
üü" #
foreach
†† 
(
†† 
Form
†† 
formHijo
†† "
in
††# %
this
††& *
.
††* +
MdiChildren
††+ 6
)
††6 7
{
°° 
if
¢¢ 
(
¢¢ 
formHijo
¢¢ 
!=
¢¢ 
desparasitacion
¢¢  /
)
¢¢/ 0
{
££ 
formHijo
§§ 
.
§§ 
Close
§§ "
(
§§" #
)
§§# $
;
§§$ %
}
•• 
}
¶¶ 
}
ßß 	
private
©© 
void
©© /
!registroDeToolStripMenuItem_Click
©© 6
(
©©6 7
object
©©7 =
sender
©©> D
,
©©D E
	EventArgs
©©F O
e
©©P Q
)
©©Q R
{
™™ 	
FrmRecetario
´´ 
	recetario
´´ "
=
´´" #
new
´´$ '
FrmRecetario
´´( 4
(
´´4 5
)
´´5 6
;
´´6 7
	recetario
¨¨ 
.
¨¨ 
	MdiParent
¨¨ 
=
¨¨  !
this
¨¨" &
;
¨¨& '
	recetario
≠≠ 
.
≠≠ 
Show
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
foreach
ÆÆ 
(
ÆÆ 
Form
ÆÆ 
formHijo
ÆÆ "
in
ÆÆ# %
this
ÆÆ& *
.
ÆÆ* +
MdiChildren
ÆÆ+ 6
)
ÆÆ6 7
{
ØØ 
if
∞∞ 
(
∞∞ 
formHijo
∞∞ 
!=
∞∞ 
	recetario
∞∞  )
)
∞∞) *
{
±± 
formHijo
≤≤ 
.
≤≤ 
Close
≤≤ "
(
≤≤" #
)
≤≤# $
;
≤≤$ %
}
≥≥ 
}
¥¥ 
}
µµ 	
private
∑∑ 
void
∑∑ 3
%abastecimientoToolStripMenuItem_Click
∑∑ :
(
∑∑: ;
object
∑∑; A
sender
∑∑B H
,
∑∑H I
	EventArgs
∑∑J S
e
∑∑T U
)
∑∑U V
{
∏∏ 	 
FormAbastecimiento
ππ 
abastecimiento
ππ -
=
ππ. /
new
ππ0 3 
FormAbastecimiento
ππ4 F
(
ππF G
)
ππG H
;
ππH I
abastecimiento
∫∫ 
.
∫∫ 
	MdiParent
∫∫ $
=
∫∫% &
this
∫∫' +
;
∫∫+ ,
abastecimiento
ªª 
.
ªª 
Show
ªª 
(
ªª  
)
ªª  !
;
ªª! "
foreach
ºº 
(
ºº 
Form
ºº 
formHijo
ºº "
in
ºº# %
this
ºº& *
.
ºº* +
MdiChildren
ºº+ 6
)
ºº6 7
{
ΩΩ 
if
ææ 
(
ææ 
formHijo
ææ 
!=
ææ 
abastecimiento
ææ  .
)
ææ. /
{
øø 
formHijo
¿¿ 
.
¿¿ 
Close
¿¿ "
(
¿¿" #
)
¿¿# $
;
¿¿$ %
}
¡¡ 
}
¬¬ 
}
√√ 	
private
ƒƒ 
void
ƒƒ 4
&abastecimientoToolStripMenuItem1_Click
ƒƒ ;
(
ƒƒ; <
object
ƒƒ< B
sender
ƒƒC I
,
ƒƒI J
	EventArgs
ƒƒK T
e
ƒƒU V
)
ƒƒV W
{
≈≈ 	 
FormAbastecimiento
∆∆ 
abastecimiento
∆∆ -
=
∆∆. /
new
∆∆0 3 
FormAbastecimiento
∆∆4 F
(
∆∆F G
)
∆∆G H
;
∆∆H I
abastecimiento
«« 
.
«« 
	MdiParent
«« $
=
««% &
this
««' +
;
««+ ,
abastecimiento
»» 
.
»» 
Show
»» 
(
»»  
)
»»  !
;
»»! "
foreach
…… 
(
…… 
Form
…… 
formHijo
…… "
in
……# %
this
……& *
.
……* +
MdiChildren
……+ 6
)
……6 7
{
   
if
ÀÀ 
(
ÀÀ 
formHijo
ÀÀ 
!=
ÀÀ 
abastecimiento
ÀÀ  .
)
ÀÀ. /
{
ÃÃ 
formHijo
ÕÕ 
.
ÕÕ 
Close
ÕÕ "
(
ÕÕ" #
)
ÕÕ# $
;
ÕÕ$ %
}
ŒŒ 
}
œœ 
}
–– 	
private
““ 
void
““ 7
)registroDePacienteToolStripMenuItem_Click
““ >
(
““> ?
object
““? E
sender
““F L
,
““L M
	EventArgs
““N W
e
““X Y
)
““Y Z
{
”” 	%
FormRegistrarVacunacion
‘‘ #
vacunas
‘‘$ +
=
‘‘, -
new
‘‘. 1%
FormRegistrarVacunacion
‘‘2 I
(
‘‘I J
)
‘‘J K
;
‘‘K L
vacunas
’’ 
.
’’ 
	MdiParent
’’ 
=
’’ 
this
’’  $
;
’’$ %
vacunas
÷÷ 
.
÷÷ 
Show
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
foreach
◊◊ 
(
◊◊ 
Form
◊◊ 
formHijo
◊◊ "
in
◊◊# %
this
◊◊& *
.
◊◊* +
MdiChildren
◊◊+ 6
)
◊◊6 7
{
ÿÿ 
if
ŸŸ 
(
ŸŸ 
formHijo
ŸŸ 
!=
ŸŸ 
vacunas
ŸŸ  '
)
ŸŸ' (
{
⁄⁄ 
formHijo
€€ 
.
€€ 
Close
€€ "
(
€€" #
)
€€# $
;
€€$ %
}
‹‹ 
}
›› 
}
ﬁﬁ 	
private
‡‡ 
void
‡‡ =
/accesoAHistoriasClinicasToolStripMenuItem_Click
‡‡ D
(
‡‡D E
object
‡‡E K
sender
‡‡L R
,
‡‡R S
	EventArgs
‡‡T ]
e
‡‡^ _
)
‡‡_ `
{
·· 	*
FormRegistrarDesparasitacion
‚‚ (
desparasitacion
‚‚) 8
=
‚‚9 :
new
‚‚; >*
FormRegistrarDesparasitacion
‚‚? [
(
‚‚[ \
)
‚‚\ ]
;
‚‚] ^
desparasitacion
„„ 
.
„„ 
	MdiParent
„„ %
=
„„& '
this
„„( ,
;
„„, -
desparasitacion
‰‰ 
.
‰‰ 
Show
‰‰  
(
‰‰  !
)
‰‰! "
;
‰‰" #
foreach
ÂÂ 
(
ÂÂ 
Form
ÂÂ 
formHijo
ÂÂ "
in
ÂÂ# %
this
ÂÂ& *
.
ÂÂ* +
MdiChildren
ÂÂ+ 6
)
ÂÂ6 7
{
ÊÊ 
if
ÁÁ 
(
ÁÁ 
formHijo
ÁÁ 
!=
ÁÁ 
desparasitacion
ÁÁ  /
)
ÁÁ/ 0
{
ËË 
formHijo
ÈÈ 
.
ÈÈ 
Close
ÈÈ "
(
ÈÈ" #
)
ÈÈ# $
;
ÈÈ$ %
}
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ :
,registroDeRecetaci√≥nToolStripMenuItem_Click
ÓÓ @
(
ÓÓ@ A
object
ÓÓA G
sender
ÓÓH N
,
ÓÓN O
	EventArgs
ÓÓP Y
e
ÓÓZ [
)
ÓÓ[ \
{
ÔÔ 	
FrmRecetario
 
	recetario
 "
=
# $
new
% (
FrmRecetario
) 5
(
5 6
)
6 7
;
7 8
	recetario
ÒÒ 
.
ÒÒ 
	MdiParent
ÒÒ 
=
ÒÒ  !
this
ÒÒ" &
;
ÒÒ& '
	recetario
ÚÚ 
.
ÚÚ 
Show
ÚÚ 
(
ÚÚ 
)
ÚÚ 
;
ÚÚ 
foreach
ÛÛ 
(
ÛÛ 
Form
ÛÛ 
formHijo
ÛÛ "
in
ÛÛ# %
this
ÛÛ& *
.
ÛÛ* +
MdiChildren
ÛÛ+ 6
)
ÛÛ6 7
{
ÙÙ 
if
ıı 
(
ıı 
formHijo
ıı 
!=
ıı 
	recetario
ıı  )
)
ıı) *
{
ˆˆ 
formHijo
˜˜ 
.
˜˜ 
Close
˜˜ "
(
˜˜" #
)
˜˜# $
;
˜˜$ %
}
¯¯ 
}
˘˘ 
}
˙˙ 	
private
¸¸ 
void
¸¸ 4
&registroDePagosToolStripMenuItem_Click
¸¸ ;
(
¸¸; <
object
¸¸< B
sender
¸¸C I
,
¸¸I J
	EventArgs
¸¸K T
e
¸¸U V
)
¸¸V W
{
˝˝ 	
RegistrarCliente
˛˛ 
Rcliente
˛˛ %
=
˛˛& '
new
˛˛( +
RegistrarCliente
˛˛, <
(
˛˛< =
)
˛˛= >
;
˛˛> ?
Rcliente
ˇˇ 
.
ˇˇ 
	MdiParent
ˇˇ 
=
ˇˇ  
this
ˇˇ! %
;
ˇˇ% &
Rcliente
ÄÄ 
.
ÄÄ 
Show
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
foreach
ÅÅ 
(
ÅÅ 
Form
ÅÅ 
formHijo
ÅÅ "
in
ÅÅ# %
this
ÅÅ& *
.
ÅÅ* +
MdiChildren
ÅÅ+ 6
)
ÅÅ6 7
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
formHijo
ÉÉ 
!=
ÉÉ 
Rcliente
ÉÉ  (
)
ÉÉ( )
{
ÑÑ 
formHijo
ÖÖ 
.
ÖÖ 
Close
ÖÖ "
(
ÖÖ" #
)
ÖÖ# $
;
ÖÖ$ %
}
ÜÜ 
}
áá 
}
àà 	
private
ää 
void
ää 0
"facturacionToolStripMenuItem_Click
ää 7
(
ää7 8
object
ää8 >
sender
ää? E
,
ääE F
	EventArgs
ääG P
e
ääQ R
)
ääR S
{
ãã 	
RegistrarPaciente
åå 
paciente
åå &
=
åå' (
new
åå) ,
RegistrarPaciente
åå- >
(
åå> ?
)
åå? @
;
åå@ A
paciente
çç 
.
çç 
	MdiParent
çç 
=
çç  
this
çç! %
;
çç% &
paciente
éé 
.
éé 
Show
éé 
(
éé 
)
éé 
;
éé 
foreach
èè 
(
èè 
Form
èè 
formHijo
èè "
in
èè# %
this
èè& *
.
èè* +
MdiChildren
èè+ 6
)
èè6 7
{
êê 
if
ëë 
(
ëë 
formHijo
ëë 
!=
ëë 
paciente
ëë  (
)
ëë( )
{
íí 
formHijo
ìì 
.
ìì 
Close
ìì "
(
ìì" #
)
ìì# $
;
ìì$ %
}
îî 
}
ïï 
}
ññ 	
private
òò 
void
òò A
3reporteDeHorariosDelPersonalToolStripMenuItem_Click
òò H
(
òòH I
object
òòI O
sender
òòP V
,
òòV W
	EventArgs
òòX a
e
òòb c
)
òòc d
{
ôô 	!
FormReporte_Vacunas
öö 
Rvacunas
öö  (
=
öö) *
new
öö+ .!
FormReporte_Vacunas
öö/ B
(
ööB C
)
ööC D
;
ööD E
Rvacunas
õõ 
.
õõ 
	MdiParent
õõ 
=
õõ  
this
õõ! %
;
õõ% &
Rvacunas
úú 
.
úú 
Show
úú 
(
úú 
)
úú 
;
úú 
foreach
ùù 
(
ùù 
Form
ùù 
formHijo
ùù "
in
ùù# %
this
ùù& *
.
ùù* +
MdiChildren
ùù+ 6
)
ùù6 7
{
ûû 
if
üü 
(
üü 
formHijo
üü 
!=
üü 
Rvacunas
üü  (
)
üü( )
{
†† 
formHijo
°° 
.
°° 
Close
°° "
(
°°" #
)
°°# $
;
°°$ %
}
¢¢ 
}
££ 
}
§§ 	
private
¶¶ 
void
¶¶ =
/reporteHistorialCl√≠nicoToolStripMenuItem_Click
¶¶ C
(
¶¶C D
object
¶¶D J
sender
¶¶K Q
,
¶¶Q R
	EventArgs
¶¶S \
e
¶¶] ^
)
¶¶^ _
{
ßß 	+
FormReporte_Historial_Clinico
®® )

RHcl√≠nico
®®* 3
=
®®4 5
new
®®6 9+
FormReporte_Historial_Clinico
®®: W
(
®®W X
)
®®X Y
;
®®Y Z

RHcl√≠nico
©© 
.
©© 
	MdiParent
©© 
=
©©  !
this
©©" &
;
©©& '

RHcl√≠nico
™™ 
.
™™ 
Show
™™ 
(
™™ 
)
™™ 
;
™™ 
foreach
´´ 
(
´´ 
Form
´´ 
formHijo
´´ "
in
´´# %
this
´´& *
.
´´* +
MdiChildren
´´+ 6
)
´´6 7
{
¨¨ 
if
≠≠ 
(
≠≠ 
formHijo
≠≠ 
!=
≠≠ 

RHcl√≠nico
≠≠  )
)
≠≠) *
{
ÆÆ 
formHijo
ØØ 
.
ØØ 
Close
ØØ "
(
ØØ" #
)
ØØ# $
;
ØØ$ %
}
∞∞ 
}
±± 
}
≤≤ 	
private
¥¥ 
void
¥¥ A
3reporteDePacientesPorDue√±oToolStripMenuItem1_Click
¥¥ G
(
¥¥G H
object
¥¥H N
sender
¥¥O U
,
¥¥U V
	EventArgs
¥¥W `
e
¥¥a b
)
¥¥b c
{
µµ 	.
 FormReporte_Paciente_DNI_Cliente
∂∂ ,
	RPxdue√±o
∂∂- 5
=
∂∂6 7
new
∂∂8 ;.
 FormReporte_Paciente_DNI_Cliente
∂∂< \
(
∂∂\ ]
)
∂∂] ^
;
∂∂^ _
	RPxdue√±o
∑∑ 
.
∑∑ 
	MdiParent
∑∑ 
=
∑∑  
this
∑∑! %
;
∑∑% &
	RPxdue√±o
∏∏ 
.
∏∏ 
Show
∏∏ 
(
∏∏ 
)
∏∏ 
;
∏∏ 
foreach
ππ 
(
ππ 
Form
ππ 
formHijo
ππ "
in
ππ# %
this
ππ& *
.
ππ* +
MdiChildren
ππ+ 6
)
ππ6 7
{
∫∫ 
if
ªª 
(
ªª 
formHijo
ªª 
!=
ªª 
	RPxdue√±o
ªª  (
)
ªª( )
{
ºº 
formHijo
ΩΩ 
.
ΩΩ 
Close
ΩΩ "
(
ΩΩ" #
)
ΩΩ# $
;
ΩΩ$ %
}
ææ 
}
øø 
}
¿¿ 	
private
¬¬ 
void
¬¬ B
4reporteEstad√≠ticoDePacientesToolStripMenuItem_Click
¬¬ H
(
¬¬H I
object
¬¬I O
sender
¬¬P V
,
¬¬V W
	EventArgs
¬¬X a
e
¬¬b c
)
¬¬c d
{
√√ 	/
!FormReporte_Estadistica_Pacientes
ƒƒ -
REP
ƒƒ. 1
=
ƒƒ2 3
new
ƒƒ4 7/
!FormReporte_Estadistica_Pacientes
ƒƒ8 Y
(
ƒƒY Z
)
ƒƒZ [
;
ƒƒ[ \
REP
≈≈ 
.
≈≈ 
	MdiParent
≈≈ 
=
≈≈ 
this
≈≈  
;
≈≈  !
REP
∆∆ 
.
∆∆ 
Show
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
foreach
«« 
(
«« 
Form
«« 
formHijo
«« "
in
««# %
this
««& *
.
««* +
MdiChildren
««+ 6
)
««6 7
{
»» 
if
…… 
(
…… 
formHijo
…… 
!=
…… 
REP
……  #
)
……# $
{
   
formHijo
ÀÀ 
.
ÀÀ 
Close
ÀÀ "
(
ÀÀ" #
)
ÀÀ# $
;
ÀÀ$ %
}
ÃÃ 
}
ÕÕ 
}
ŒŒ 	
private
–– 
void
–– /
!toolStripSplitButton2_ButtonClick
–– 6
(
––6 7
object
––7 =
sender
––> D
,
––D E
	EventArgs
––F O
e
––P Q
)
––Q R
{
—— 	
foreach
““ 
(
““ 
Form
““ 
formularioHijo
““ (
in
““) +
this
““, 0
.
““0 1
MdiChildren
““1 <
)
““< =
{
”” 
formularioHijo
‘‘ 
.
‘‘ 
Close
‘‘ $
(
‘‘$ %
)
‘‘% &
;
‘‘& '
}
’’ 
}
÷÷ 	
}
◊◊ 
}ÿÿ ⁄%
ÄC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormReporteHorarioPersonal.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class &
FormReporteHorarioPersonal 3
:4 5
Form6 :
{ 
int 
total85 
= 
$num 
, 
total812 
= 
$num  
,  !
total125! )
=* +
$num, -
;- .
public &
FormReporteHorarioPersonal )
() *
)* +
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void $
btnReporteCompleto_Click -
(- .
object. 4
sender5 ;
,; <
	EventArgs= F
eG H
)H I
{ 	
} 	
private 
void 
btnGrafico_Click %
(% &
object& ,
sender- 3
,3 4
	EventArgs5 >
e? @
)@ A
{ 	
Series 
series85 
= 
new "
Series# )
() *
$str* 9
)9 :
;: ;
Series 
	series812 
= 
new "
Series# )
() *
$str* 9
)9 :
;: ;
Series 
	series125 
= 
new "
Series# )
() *
$str* 9
)9 :
;: ;
chart1 
. 
Series 
[ 
$str )
]) *
.* +
Points+ 1
.1 2
Clear2 7
(7 8
)8 9
;9 :
chart1   
.   
Series   
[   
$str   )
]  ) *
.  * +
Points  + 1
.  1 2
Clear  2 7
(  7 8
)  8 9
;  9 :
chart1!! 
.!! 
Series!! 
[!! 
$str!! )
]!!) *
.!!* +
Points!!+ 1
.!!1 2
Clear!!2 7
(!!7 8
)!!8 9
;!!9 :
chart1## 
.## 
Series## 
[## 
$str## )
]##) *
.##* +
IsValueShownAsLabel##+ >
=##? @
true##A E
;##E F
chart1$$ 
.$$ 
Series$$ 
[$$ 
$str$$ )
]$$) *
.$$* +
IsValueShownAsLabel$$+ >
=$$? @
true$$A E
;$$E F
chart1%% 
.%% 
Series%% 
[%% 
$str%% )
]%%) *
.%%* +
IsValueShownAsLabel%%+ >
=%%? @
true%%A E
;%%E F
chart1'' 
.'' 
Series'' 
['' 
$str'' )
]'') *
.''* +
Points''+ 1
.''1 2
AddXY''2 7
(''7 8
total85''8 ?
,''? @
total85''A H
+''I J
$num''K L
)''L M
;''M N
chart1(( 
.(( 
Series(( 
[(( 
$str(( )
](() *
.((* +
Points((+ 1
.((1 2
AddXY((2 7
(((7 8
total812((8 @
,((@ A
total812((B J
+((K L
$num((M N
)((N O
;((O P
chart1)) 
.)) 
Series)) 
[)) 
$str)) )
]))) *
.))* +
Points))+ 1
.))1 2
AddXY))2 7
())7 8
total125))8 @
,))@ A
total125))B J
+))K L
$num))M N
)))N O
;))O P
btnCargarDatos** 
.** 
Enabled** "
=**# $
false**% *
;*** +
},, 	
private.. 
void.. +
FormReporteHorarioPersonal_Load.. 4
(..4 5
object..5 ;
sender..< B
,..B C
	EventArgs..D M
e..N O
)..O P
{// 	
}11 	
private33 
void33 %
btnReporteIngresado_Click33 .
(33. /
object33/ 5
sender336 <
,33< =
	EventArgs33> G
e33H I
)33I J
{44 	
}66 	
public88 
void88 
btnLimpiar_Click88 $
(88$ %
object88% +
sender88, 2
,882 3
	EventArgs884 =
e88> ?
)88? @
{99 	
dgvLista;; 
.;; 
Rows;; 
.;; 
Clear;; 
(;;  
);;  !
;;;! "
}<< 	
}== 
}>> ˘è
wC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormProgramarCita.cs
	namespace 	
ProyectoFinal
 
{ 
public		 

partial		 
class		 
FormProgramarCita		 *
:		+ ,
Form		- 1
{

 
int #
id_pacienteSeleccionado #
;# $
string 

id_cliente 
, 
mot 
, 
ho  "
," #
tam$ '
;' (
int 
c_c 
; 
DateTime 
fe 
; 
private 
void 
btnLimpiar_Click %
(% &
object& ,
sender- 3
,3 4
	EventArgs5 >
e? @
)@ A
{ 	
	txtBuscar 
. 
Text 
= 
$str 
;  

Desactivar 
( 
) 
; 
LIMPIARPANTALLA 
( 
) 
; 
	cmbTamano 
. 
Enabled 
= 
false  %
;% &
} 	
private 
void 
btnBuscar_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
	txtBuscar& /
./ 0
Text0 4
)4 5
)5 6
{ 
CargarCliente 
( 
) 
;  
CargarTablaPaciente #
(# $
)$ %
;% &
if   
(   
dgvPacientes    
.    !
Rows  ! %
.  % &
Count  & +
==  , .
$num  / 0
)  0 1
{!! 

MessageBox"" 
."" 
Show"" #
(""# $
$str""$ N
,""N O
$str""P ]
,""] ^
MessageBoxButtons""_ p
.""p q
OK""q s
,""s t
MessageBoxIcon	""u É
.
""É Ñ
Error
""Ñ â
)
""â ä
;
""ä ã
}## 
}$$ 
else%% 
{&& 

MessageBox'' 
.'' 
Show'' 
(''  
$str''  3
,''3 4
$str''5 =
,''= >
MessageBoxButtons''? P
.''P Q
OK''Q S
,''S T
MessageBoxIcon''U c
.''c d
Error''d i
)''i j
;''j k
}(( 
})) 	
private++ 
void++ "
FormProgramarCita_Load++ +
(+++ ,
object++, 2
sender++3 9
,++9 :
	EventArgs++; D
e++E F
)++F G
{,, 	
CargarTablaCitas-- 
(-- 
)-- 
;-- 
CargarTablaPaciente.. 
(..  
)..  !
;..! "
CargarCliente// 
(// 
)// 
;// 

Desactivar00 
(00 
)00 
;00 
}11 	
private33 
void33 "
btnRegistrarCita_Click33 +
(33+ ,
object33, 2
sender333 9
,339 :
	EventArgs33; D
e33E F
)33F G
{44 	
if55 
(55 #
id_pacienteSeleccionado55 '
>55( )
$num55* +
)55+ ,
{66 
dgvPacientes77 
.77 

DataSource77 '
=77( )
null77* .
;77. /
	Programar88 
(88 
)88 
;88 
CargarTablaCitas99  
(99  !
)99! "
;99" #
CargarTablaPaciente:: #
(::# $
)::$ %
;::% &
};; 
else<< 
{== 

MessageBox>> 
.>> 
Show>> 
(>>  
$str>>  _
,>>_ `
$str>>a n
,>>n o
MessageBoxButtons	>>p Å
.
>>Å Ç
OK
>>Ç Ñ
,
>>Ñ Ö
MessageBoxIcon
>>Ü î
.
>>î ï
Information
>>ï †
)
>>† °
;
>>° ¢
}?? 
}@@ 	
publicBB 
voidBB 
CargarTablaPacienteBB '
(BB' (
)BB( )
{CC 	
tryDD 
{EE 
usingFF 
(FF 
varFF 
dcFF 
=FF 
newFF  #
MSOFTVETDataContextFF$ 7
(FF7 8
)FF8 9
)FF9 :
{GG 
ifHH 
(HH 
!HH 
stringHH 
.HH  
IsNullOrEmptyHH  -
(HH- .

id_clienteHH. 8
)HH8 9
)HH9 :
{II 
intJJ 

codClienteJJ &
=JJ' (
ConvertJJ) 0
.JJ0 1
ToInt32JJ1 8
(JJ8 9

id_clienteJJ9 C
)JJC D
;JJD E
varMM 
listaPacientesMM *
=MM+ ,
dcMM- /
.MM/ 0

V_PacienteMM0 :
.MM: ;
WhereMM; @
(MM@ A
pMMA B
=>MMC E
pMMF G
.MMG H
Cod_ClienteMMH S
==MMT V

codClienteMMW a
)MMa b
.MMb c
ToListMMc i
(MMi j
)MMj k
;MMk l
dgvPacientesPP $
.PP$ %

DataSourcePP% /
=PP0 1
listaPacientesPP2 @
;PP@ A
}RR 
}SS 
}TT 
catchUU 
(UU 
	ExceptionUU 
exUU 
)UU  
{VV 

MessageBoxWW 
.WW 
ShowWW 
(WW  
$"WW  "
$strWW" I
{WWI J
exWWJ L
.WWL M
MessageWWM T
}WWT U
"WWU V
,WWV W
$strWWX _
,WW_ `
MessageBoxButtonsWWa r
.WWr s
OKWWs u
,WWu v
MessageBoxIcon	WWw Ö
.
WWÖ Ü
Error
WWÜ ã
)
WWã å
;
WWå ç
}XX 
}YY 	
public[[ 
void[[ 
CargarCliente[[ !
([[! "
)[[" #
{\\ 	
MSOFTVETDataContext^^ 
dc^^  "
=^^# $
new^^% (
MSOFTVETDataContext^^) <
(^^< =
)^^= >
;^^> ?
string`` 
dniBusqueda`` 
=``  
	txtBuscar``! *
.``* +
Text``+ /
;``/ 0
varbb 
clienteEncontradobb !
=bb" #
dcbb$ &
.bb& '
	V_Clientebb' 0
.bb0 1
FirstOrDefaultbb1 ?
(bb? @
cbb@ A
=>bbB D
cbbE F
.bbF G
DNIbbG J
==bbK M
dniBusquedabbN Y
)bbY Z
;bbZ [
ifdd 
(dd 
clienteEncontradodd !
!=dd" $
nulldd% )
)dd) *
{ee 
txtNomClienteff 
.ff 
Textff "
=ff# $
clienteEncontradoff% 6
.ff6 7
Nombreff7 =
;ff= >
txtApelClientegg 
.gg 
Textgg #
=gg$ %
clienteEncontradogg& 7
.gg7 8
Apellidogg8 @
.gg@ A
ToStringggA I
(ggI J
)ggJ K
;ggK L

id_clientehh 
=hh 
clienteEncontradohh .
.hh. /
Cod_Clientehh/ :
.hh: ;
ToStringhh; C
(hhC D
)hhD E
;hhE F
Activarii 
(ii 
)ii 
;ii 
	cmbTamanojj 
.jj 
Enabledjj !
=jj" #
truejj$ (
;jj( )
}kk 
elsell 
{mm 
txtNomClientenn 
.nn 
Textnn "
=nn# $
$strnn% <
;nn< =
LIMPIARPANTALLAoo 
(oo  
)oo  !
;oo! "
}pp 
}qq 	
privatess 
voidss 
	Programarss 
(ss 
)ss  
{tt 	
tryuu 
{vv 
usingww 
(ww 
varww 
dcww 
=ww 
newww  #
MSOFTVETDataContextww$ 7
(ww7 8
)ww8 9
)ww9 :
{xx 
c_cyy 
=yy 
Convertyy !
.yy! "
ToInt32yy" )
(yy) *

id_clienteyy* 4
)yy4 5
;yy5 6
fezz 
=zz 
	dtPicker1zz "
.zz" #
Valuezz# (
.zz( )
Datezz) -
;zz- .
ho{{ 
={{ 
txtHora{{  
.{{  !
Text{{! %
;{{% &
mot|| 
=|| 
	txtMotivo|| #
.||# $
Text||$ (
;||( )
tam}} 
=}} 
	cmbTamano}} #
.}}# $
Text}}$ (
;}}( )
if~~ 
(~~ 
!~~ 
string~~ 
.~~  
IsNullOrEmpty~~  -
(~~- .
ho~~. 0
)~~0 1
&&~~2 4
!~~5 6
string~~6 <
.~~< =
IsNullOrEmpty~~= J
(~~J K
mot~~K N
)~~N O
&&~~P R
!~~S T
string~~T Z
.~~Z [
IsNullOrEmpty~~[ h
(~~h i
tam~~i l
)~~l m
)~~m n
{ 
string
ÄÄ 
est
ÄÄ "
=
ÄÄ# $
$str
ÄÄ% 0
;
ÄÄ0 1
dc
ÇÇ 
.
ÇÇ 
SP_AgregarCita
ÇÇ )
(
ÇÇ) *
mot
ÇÇ* -
,
ÇÇ- .
fe
ÇÇ/ 1
,
ÇÇ1 2
ho
ÇÇ3 5
,
ÇÇ5 6
c_c
ÇÇ7 :
,
ÇÇ: ;
est
ÇÇ< ?
,
ÇÇ? @
tam
ÇÇA D
,
ÇÇD E%
id_pacienteSeleccionado
ÇÇF ]
)
ÇÇ] ^
;
ÇÇ^ _

MessageBox
ÉÉ "
.
ÉÉ" #
Show
ÉÉ# '
(
ÉÉ' (
$str
ÉÉ( B
,
ÉÉB C
$str
ÉÉD K
,
ÉÉK L
MessageBoxButtons
ÉÉM ^
.
ÉÉ^ _
OK
ÉÉ_ a
,
ÉÉa b
MessageBoxIcon
ÉÉc q
.
ÉÉq r
Information
ÉÉr }
)
ÉÉ} ~
;
ÉÉ~ 
LIMPIARPANTALLA
ÑÑ '
(
ÑÑ' (
)
ÑÑ( )
;
ÑÑ) *

Desactivar
ÖÖ "
(
ÖÖ" #
)
ÖÖ# $
;
ÖÖ$ %
	txtBuscar
ÜÜ !
.
ÜÜ! "
Text
ÜÜ" &
=
ÜÜ' (
$str
ÜÜ) +
;
ÜÜ+ ,
	cmbTamano
áá !
.
áá! "
Enabled
áá" )
=
áá* +
false
áá, 1
;
áá1 2
}
àà 
else
ââ 
{
ää 

MessageBox
ãã "
.
ãã" #
Show
ãã# '
(
ãã' (
$str
ãã( @
,
ãã@ A
$str
ããB O
,
ããO P
MessageBoxButtons
ããQ b
.
ããb c
OK
ããc e
,
ããe f
MessageBoxIcon
ããg u
.
ããu v
Informationããv Å
)ããÅ Ç
;ããÇ É
}
åå 
}
çç 
}
éé 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
êê 

MessageBox
ëë 
.
ëë 
Show
ëë 
(
ëë  
$"
ëë  "
$str
ëë" ;
{
ëë; <
ex
ëë< >
.
ëë> ?
Message
ëë? F
}
ëëF G
"
ëëG H
,
ëëH I
$str
ëëJ Q
,
ëëQ R
MessageBoxButtons
ëëS d
.
ëëd e
OK
ëëe g
,
ëëg h
MessageBoxIcon
ëëi w
.
ëëw x
Error
ëëx }
)
ëë} ~
;
ëë~ 
}
íí 
}
ìì 	
public
ïï 
void
ïï 
CargarTablaCitas
ïï $
(
ïï$ %
)
ïï% &
{
ññ 	
try
óó 
{
òò 
using
ôô 
(
ôô 
var
ôô 
dc
ôô 
=
ôô 
new
ôô  #!
MSOFTVETDataContext
ôô$ 7
(
ôô7 8
)
ôô8 9
)
ôô9 :
{
öö 
var
úú 

listaCitas
úú "
=
úú# $
dc
úú% '
.
úú' (
V_CargarCitas
úú( 5
.
úú5 6
ToList
úú6 <
(
úú< =
)
úú= >
;
úú> ?
	dgvTabla1
ûû 
.
ûû 

DataSource
ûû (
=
ûû) *
null
ûû+ /
;
ûû/ 0
	dgvTabla1
üü 
.
üü 

DataSource
üü (
=
üü) *

listaCitas
üü+ 5
;
üü5 6
}
†† 
}
°° 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 

MessageBox
§§ 
.
§§ 
Show
§§ 
(
§§  
$"
§§  "
$str
§§" E
{
§§E F
ex
§§F H
.
§§H I
Message
§§I P
}
§§P Q
"
§§Q R
,
§§R S
$str
§§T [
,
§§[ \
MessageBoxButtons
§§] n
.
§§n o
OK
§§o q
,
§§q r
MessageBoxIcon§§s Å
.§§Å Ç
Error§§Ç á
)§§á à
;§§à â
}
•• 
}
¶¶ 	
public
®® 
void
®® 
LIMPIARPANTALLA
®® #
(
®®# $
)
®®$ %
{
©© 	
txtNomCliente
™™ 
.
™™ 
Text
™™ 
=
™™  
$str
™™! #
;
™™# $
txtApelCliente
´´ 
.
´´ 
Text
´´ 
=
´´  !
$str
´´" $
;
´´$ %
	txtMotivo
¨¨ 
.
¨¨ 
Text
¨¨ 
=
¨¨ 
$str
¨¨ 
;
¨¨  
txtHora
≠≠ 
.
≠≠ 
Text
≠≠ 
=
≠≠ 
$str
≠≠ 
;
≠≠ 
dgvPacientes
ÆÆ 
.
ÆÆ 

DataSource
ÆÆ #
=
ÆÆ$ %
null
ÆÆ& *
;
ÆÆ* +
dgvPacientes
ØØ 
.
ØØ 
Rows
ØØ 
.
ØØ 
Clear
ØØ #
(
ØØ# $
)
ØØ$ %
;
ØØ% &
txtPaciente
∞∞ 
.
∞∞ 
Text
∞∞ 
=
∞∞ 
string
∞∞ %
.
∞∞% &
Empty
∞∞& +
;
∞∞+ ,
	cmbTamano
±± 
.
±± 
SelectedIndex
±± #
=
±±$ %
-
±±& '
$num
±±' (
;
±±( )

id_cliente
≤≤ 
=
≤≤ 
null
≤≤ 
;
≤≤ %
id_pacienteSeleccionado
≥≥ #
=
≥≥$ %
$num
≥≥& '
;
≥≥' (
}
¥¥ 	
public
∂∂ 
void
∂∂ 

Desactivar
∂∂ 
(
∂∂ 
)
∂∂  
{
∑∑ 	
	txtMotivo
∏∏ 
.
∏∏ 
Enabled
∏∏ 
=
∏∏ 
false
∏∏  %
;
∏∏% &
txtHora
ππ 
.
ππ 
Enabled
ππ 
=
ππ 
false
ππ #
;
ππ# $
	dtPicker1
∫∫ 
.
∫∫ 
Enabled
∫∫ 
=
∫∫ 
false
∫∫  %
;
∫∫% &
btnRegistrarCita
ªª 
.
ªª 
Enabled
ªª $
=
ªª% &
false
ªª' ,
;
ªª, -
txtPaciente
ºº 
.
ºº 
Enabled
ºº 
=
ºº  !
false
ºº" '
;
ºº' (
}
ΩΩ 	
private
øø 
void
øø 
btnAgregar_Click
øø %
(
øø% &
object
øø& ,
sender
øø- 3
,
øø3 4
	EventArgs
øø5 >
e
øø? @
)
øø@ A
{
¿¿ 	
RegistrarCliente
¡¡ 
registrarCliente
¡¡ -
=
¡¡. /
new
¡¡0 3
RegistrarCliente
¡¡4 D
(
¡¡D E
)
¡¡E F
;
¡¡F G
this
¬¬ 
.
¬¬ 
Hide
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬ 
registrarCliente
√√ 
.
√√ 
Show
√√ !
(
√√! "
)
√√" #
;
√√# $
}
ƒƒ 	
private
∆∆ 
void
∆∆ $
dgvPacientes_CellClick
∆∆ +
(
∆∆+ ,
object
∆∆, 2
sender
∆∆3 9
,
∆∆9 :'
DataGridViewCellEventArgs
∆∆; T
e
∆∆U V
)
∆∆V W
{
«« 	
if
»» 
(
»» 
e
»» 
.
»» 
RowIndex
»» 
>=
»» 
$num
»» 
)
»»  
{
…… 
DataGridViewRow
   
selectedRow
    +
=
  , -
dgvPacientes
  . :
.
  : ;
Rows
  ; ?
[
  ? @
e
  @ A
.
  A B
RowIndex
  B J
]
  J K
;
  K L%
id_pacienteSeleccionado
ÕÕ '
=
ÕÕ( )
Convert
ÕÕ* 1
.
ÕÕ1 2
ToInt32
ÕÕ2 9
(
ÕÕ9 :
selectedRow
ÕÕ: E
.
ÕÕE F
Cells
ÕÕF K
[
ÕÕK L
$str
ÕÕL Z
]
ÕÕZ [
.
ÕÕ[ \
Value
ÕÕ\ a
)
ÕÕa b
;
ÕÕb c
txtPaciente
–– 
.
–– 
Text
––  
=
––! "
selectedRow
––# .
.
––. /
Cells
––/ 4
[
––4 5
$str
––5 =
]
––= >
.
––> ?
Value
––? D
?
––D E
.
––E F
ToString
––F N
(
––N O
)
––O P
;
––P Q
}
—— 
else
““ 
{
”” 
LIMPIARPANTALLA
‘‘ 
(
‘‘  
)
‘‘  !
;
‘‘! "
}
’’ 
}
÷÷ 	
public
ÿÿ 
void
ÿÿ 
Activar
ÿÿ 
(
ÿÿ 
)
ÿÿ 
{
ŸŸ 	
	txtMotivo
⁄⁄ 
.
⁄⁄ 
Enabled
⁄⁄ 
=
⁄⁄ 
true
⁄⁄  $
;
⁄⁄$ %
txtHora
€€ 
.
€€ 
Enabled
€€ 
=
€€ 
true
€€ "
;
€€" #
	dtPicker1
‹‹ 
.
‹‹ 
Enabled
‹‹ 
=
‹‹ 
true
‹‹  $
;
‹‹$ %
btnRegistrarCita
›› 
.
›› 
Enabled
›› $
=
››% &
true
››' +
;
››+ ,
}
ﬁﬁ 	
public
‡‡ 
FormProgramarCita
‡‡  
(
‡‡  !
)
‡‡! "
{
·· 	!
InitializeComponent
‚‚ 
(
‚‚  
)
‚‚  !
;
‚‚! "
	cmbTamano
„„ 
.
„„ 
Enabled
„„ 
=
„„ 
false
„„  %
;
„„% &
}
‰‰ 	
}
ÂÂ 
}ÊÊ û
oC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormAdmin.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
	FormAdmin "
:# $
Form% )
{ 
bool 
existe 
; 
string 
usuario 
, 
password  
;  !
string 
codunico 
; 
string 
texto 
; 
String 
[ 
] 
campo 
= 
new 
string #
[# $
$num$ %
]% &
;& '
public 
	FormAdmin 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
button1_Click "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
	FormLogin 
login 
= 
new !
	FormLogin" +
(+ ,
), -
;- .
this 
. 
Hide 
( 
) 
; 
login   
.   
Show   
(   
)   
;   
}!! 	
private## 
void## 
FormAdmin_Load## #
(### $
object##$ *
sender##+ 1
,##1 2
	EventArgs##3 <
e##= >
)##> ?
{$$ 	
GenerarCaptch%% 
(%% 
)%% 
;%% 
}&& 	
public'' 
void'' 
GenerarCaptch'' !
(''! "
)''" #
{(( 	
Random)) 
rnd)) 
=)) 
new)) 
Random)) #
())# $
)))$ %
;))% &
string** 
[** 
]** 
codigo** 
=** 
{** 
$str**  '
,**' (
$str**) 1
,**1 2
$str**3 ;
,**; <
$str**= E
,**E F
$str**G O
}**P Q
;**Q R
int++ 
indiceAleatorio++ 
=++  
rnd++  #
.++# $
Next++$ (
(++( )
$num++) *
,++* +
codigo++, 2
.++2 3
Length++3 9
)++9 :
;++: ;
string,, 
captchaAleatorio,, #
=,,$ %
codigo,,& ,
[,,, -
indiceAleatorio,,- <
],,< =
;,,= >

txtcaptcha-- 
.-- 
Text-- 
=-- 
captchaAleatorio-- -
;--- .
}.. 	
private// 
void// 
btnIngresar_Click// &
(//& '
object//' -
sender//. 4
,//4 5
	EventArgs//6 ?
e//@ A
)//A B
{00 	
existe11 
=11 
false11 
;11 
usuario22 
=22 
txtRegUsuario22 #
.22# $
Text22$ (
;22( )
password33 
=33 
txtRegPassword33 %
.33% &
Text33& *
;33* +
codunico44 
=44 
txtCodUnico44 "
.44" #
Text44# '
;44' (
string55 
captcha55 
=55 

txtcaptcha55 '
.55' (
Text55( ,
;55, -
}66 	
}77 
}88 •A
oC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormLogin.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
	FormLogin "
:# $
Form% )
{ 
bool 
existe 
; 
string 
usuario 
, 
contrase√±a "
," #
nombre$ *
,* +
	categoria, 5
;5 6
private 
void 
label9_Click !
(! "
object" (
sender) /
,/ 0
	EventArgs1 :
e; <
)< =
{ 	
string 
usuario 
, 
clave !
;! "
usuario 
= 
Interaction !
.! "
InputBox" *
(* +
$str+ <
,< =
$str> G
)G H
;H I
clave 
= 
Interaction 
.  
InputBox  (
(( )
$str) 8
,8 9
$str: A
)A B
;B C
if 
( 
ValidarUsuario 
( 
usuario &
,& '
clave( -
)- .
). /
{ 
if 
( 
	categoria 
. 
Equals $
($ %
$str% (
)( )
)) *
{   
RegistrarUsuario"" $
admin""% *
=""+ ,
new""- 0
RegistrarUsuario""1 A
(""A B
)""B C
;""C D
this## 
.## 
Hide## 
(## 
)## 
;##  
admin$$ 
.$$ 
Show$$ 
($$ 
)$$  
;$$  !
}%% 
else&& 
{'' 

MessageBox(( 
.(( 
Show(( #
(((# $
$str(($ p
)((p q
;((q r
})) 
}** 
else++ 
{,, 

MessageBox-- 
.-- 
Show-- 
(--  
$str--  =
,--= >
$str--? Z
,--Z [
MessageBoxButtons--\ m
.--m n
OK--n p
,--p q
MessageBoxIcon	--r Ä
.
--Ä Å
Error
--Å Ü
)
--Ü á
;
--á à
}// 
}00 	
private22 
void22 
FormLogin_Load22 #
(22# $
object22$ *
sender22+ 1
,221 2
	EventArgs223 <
e22= >
)22> ?
{33 	
}55 	
private66 
void66 
AbrirWeb66 
(66 
string66 $
url66% (
)66( )
{77 	
try88 
{99 
Process:: 
.:: 
Start:: 
(:: 
new:: !
ProcessStartInfo::" 2
(::2 3
url::3 6
)::6 7
{::8 9
UseShellExecute::: I
=::J K
true::L P
}::Q R
)::R S
;::S T
};; 
catch<< 
(<< 
	Exception<< 
ex<< 
)<<  
{== 

MessageBox>> 
.>> 
Show>> 
(>>  
$">>  "
$str>>" <
{>>< =
ex>>= ?
.>>? @
Message>>@ G
}>>G H
">>H I
,>>I J
$str>>K R
,>>R S
MessageBoxButtons>>T e
.>>e f
OK>>f h
,>>h i
MessageBoxIcon>>j x
.>>x y
Error>>y ~
)>>~ 
;	>> Ä
}?? 
}@@ 	
privateAA 
voidAA 
pictureBox6_ClickAA &
(AA& '
objectAA' -
senderAA. 4
,AA4 5
	EventArgsAA6 ?
eAA@ A
)AAA B
{BB 	
AbrirWebCC 
(CC 
$strCC >
)CC> ?
;CC? @
}DD 	
privateFF 
voidFF 
pictureBox4_ClickFF &
(FF& '
objectFF' -
senderFF. 4
,FF4 5
	EventArgsFF6 ?
eFF@ A
)FFA B
{GG 	
AbrirWebHH 
(HH 
$strHH 8
)HH8 9
;HH9 :
}II 	
privateKK 
voidKK 
pictureBox5_ClickKK &
(KK& '
objectKK' -
senderKK. 4
,KK4 5
	EventArgsKK6 ?
eKK@ A
)KKA B
{LL 	
AbrirWebMM 
(MM 
$strMM /
)MM/ 0
;MM0 1
}NN 	
publicPP 
	FormLoginPP 
(PP 
)PP 
{QQ 	
InitializeComponentRR 
(RR  
)RR  !
;RR! "
}SS 	
privateTT 
boolTT 
ValidarUsuarioTT #
(TT# $
stringTT$ *
usuarioTT+ 2
,TT2 3
stringTT4 :
passwordTT; C
)TTC D
{UU 	
MSOFTVETDataContextVV 
dcVV  "
=VV# $
newVV% (
MSOFTVETDataContextVV) <
(VV< =
)VV= >
;VV> ?
tryXX 
{YY 
varZZ 
consultaZZ 
=ZZ 
dcZZ !
.ZZ! "
SP_AutenticarZZ" /
(ZZ/ 0
usuarioZZ0 7
,ZZ7 8
passwordZZ9 A
)ZZA B
.ZZB C
SingleOrDefaultZZC R
(ZZR S
)ZZS T
;ZZT U
if\\ 
(\\ 
consulta\\ 
!=\\ 
null\\  $
)\\$ %
{]] 
	categoria^^ 
=^^ 
consulta^^  (
.^^( )
	Categoria^^) 2
;^^2 3
nombre__ 
=__ 
consulta__ %
.__% &
NOMBRE__& ,
;__, -
return`` 
true`` 
;``  
}aa 
elsebb 
{cc 
returndd 
falsedd  
;dd  !
}ee 
}ff 
catchgg 
(gg 
	Exceptiongg 
exgg 
)gg  
{hh 

MessageBoxii 
.ii 
Showii 
(ii  
$strii  7
+ii8 9
exii: <
.ii< =
Messageii= D
,iiD E
$striiF M
,iiM N
MessageBoxButtonsiiO `
.ii` a
OKiia c
,iic d
MessageBoxIconiie s
.iis t
Erroriit y
)iiy z
;iiz {
returnjj 
falsejj 
;jj 
}kk 
}mm 	
privatenn 
voidnn 
btnIngresar_Clicknn &
(nn& '
objectnn' -
sendernn. 4
,nn4 5
	EventArgsnn6 ?
enn@ A
)nnA B
{oo 	
usuariopp 
=pp 

txtUsuariopp  
.pp  !
Textpp! %
;pp% &
contrase√±aqq 
=qq 
txtPasswordqq $
.qq$ %
Textqq% )
;qq) *
ifrr 
(rr 
ValidarUsuariorr 
(rr 
usuariorr &
,rr& '
contrase√±arr( 2
)rr2 3
)rr3 4
{ss 

MessageBoxtt 
.tt 
Showtt 
(tt  
$strtt  @
+ttA B
$strttC I
+ttJ K
nombrettL R
,ttR S
$strttT e
,tte f
MessageBoxButtonsttg x
.ttx y
OKtty {
,tt{ |
MessageBoxIcon	tt} ã
.
ttã å
Information
ttå ó
)
ttó ò
;
ttò ô
MDIPrincipaluu 
MDIuu  
=uu! "
newuu# &
MDIPrincipaluu' 3
(uu3 4
)uu4 5
;uu5 6
thisvv 
.vv 
Hidevv 
(vv 
)vv 
;vv 
MDIww 
.ww 
Showww 
(ww 
)ww 
;ww 
}xx 
elseyy 
{zz 

MessageBox{{ 
.{{ 
Show{{ 
({{  
$str{{  F
,{{F G
$str{{H Y
,{{Y Z
MessageBoxButtons{{[ l
.{{l m
OK{{m o
,{{o p
MessageBoxIcon{{q 
.	{{ Ä
Error
{{Ä Ö
)
{{Ö Ü
;
{{Ü á
}|| 
}}} 	
}~~ 
} èﬁ
vC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormEditarAgenda.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
FormEditarAgenda )
:* +
Form, 0
{ 
string 
motivo 
, 

id_cliente !
,! "
hora# '
,' (
estado) /
,/ 0
tama√±o1 7
;7 8
DateTime 
fecha 
; 
int 
id_cita 
; 
private 
void !
FormEditarAgenda_Load *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
rbtnDNI 
. 
Checked 
= 
true "
;" #
MostrarClientes 
( 
) 
; 

Desactivar 
( 
) 
; 
} 	
private 
void "
rbtnDNI_CheckedChanged +
(+ ,
object, 2
sender3 9
,9 :
	EventArgs; D
eE F
)F G
{ 	
dgvTabla 
. 

DataSource 
=  !
null" &
;& '

Desactivar 
( 
) 
; 
dgvTabla   
.   
Rows   
.   
Clear   
(    
)    !
;  ! "
MostrarClientes!! 
(!! 
)!! 
;!! 
txtId"" 
."" 
Text"" 
="" 
$str"" 
;"" 
}## 	
private%% 
void%% !
rbtnId_CheckedChanged%% *
(%%* +
object%%+ 1
sender%%2 8
,%%8 9
	EventArgs%%: C
e%%D E
)%%E F
{&& 	
dgvTabla'' 
.'' 

DataSource'' 
=''  !
null''" &
;''& '

Desactivar(( 
((( 
)(( 
;(( 
dgvTabla)) 
.)) 
Rows)) 
.)) 
Clear)) 
())  
)))  !
;))! "
MostrarClientes** 
(** 
)** 
;** 
txtDNI++ 
.++ 
Text++ 
=++ 
$str++ 
;++ 
}-- 	
private// 
void// 
btnEditar_Click// $
(//$ %
object//% +
sender//, 2
,//2 3
	EventArgs//4 =
e//> ?
)//? @
{00 	
try11 
{22 
using33 
(33 
var33 
dc33 
=33 
new33  #
MSOFTVETDataContext33$ 7
(337 8
)338 9
)339 :
{44 
if66 
(66 
int66 
.66 
TryParse66 $
(66$ %
txtCita66% ,
.66, -
Text66- 1
,661 2
out663 6
int667 :
idCita66; A
)66A B
)66B C
{77 
motivo99 
=99  
	txtMotivo99! *
.99* +
Text99+ /
;99/ 0
fecha:: 
=:: 
	dtPicker1::  )
.::) *
Value::* /
.::/ 0
Date::0 4
;::4 5
hora;; 
=;; 
txtHora;; &
.;;& '
Text;;' +
;;;+ ,
estado<< 
=<<  
	cmbEstado<<! *
.<<* +
SelectedItem<<+ 7
.<<7 8
ToString<<8 @
(<<@ A
)<<A B
;<<B C
tama√±o== 
===  
	cmbTamano==! *
.==* +
SelectedItem==+ 7
.==7 8
ToString==8 @
(==@ A
)==A B
;==B C
dc@@ 
.@@ 
SP_EditarCita@@ (
(@@( )
idCita@@) /
,@@/ 0
motivo@@1 7
,@@7 8
fecha@@9 >
,@@> ?
hora@@@ D
,@@D E
estado@@F L
,@@L M
tama√±o@@N T
)@@T U
;@@U V

MessageBoxBB "
.BB" #
ShowBB# '
(BB' (
$strBB( A
,BBA B
$strBBC J
,BBJ K
MessageBoxButtonsBBL ]
.BB] ^
OKBB^ `
,BB` a
MessageBoxIconBBb p
.BBp q
InformationBBq |
)BB| }
;BB} ~!
MostrarHistorialCitasCC -
(CC- .
)CC. /
;CC/ 0
	cmbTamanoDD !
.DD! "
EnabledDD" )
=DD* +
trueDD, 0
;DD0 1
}EE 
elseFF 
{GG 

MessageBoxHH "
.HH" #
ShowHH# '
(HH' (
$strHH( >
,HH> ?
$strHH@ G
,HHG H
MessageBoxButtonsHHI Z
.HHZ [
OKHH[ ]
,HH] ^
MessageBoxIconHH_ m
.HHm n
WarningHHn u
)HHu v
;HHv w
}II 
}JJ 
}KK 
catchLL 
(LL 
	ExceptionLL 
exLL 
)LL  
{MM 

MessageBoxNN 
.NN 
ShowNN 
(NN  
$"NN  "
$strNN" ;
{NN; <
exNN< >
.NN> ?
MessageNN? F
}NNF G
"NNG H
,NNH I
$strNNJ Q
,NNQ R
MessageBoxButtonsNNS d
.NNd e
OKNNe g
,NNg h
MessageBoxIconNNi w
.NNw x
ErrorNNx }
)NN} ~
;NN~ 
}OO 
}PP 	
privateRR 
voidRR 
btnBuscar_ClickRR $
(RR$ %
objectRR% +
senderRR, 2
,RR2 3
	EventArgsRR4 =
eRR> ?
)RR? @
{SS 	
ifTT 
(TT 
rbtnDNITT 
.TT 
CheckedTT 
)TT  
{UU 
BuscarClientePorDNIVV #
(VV# $
)VV$ %
;VV% &
}WW 
elseXX 
ifXX 
(XX 
rbtnIdXX 
.XX 
CheckedXX #
)XX# $
{YY 
BuscarClientePorIDZZ "
(ZZ" #
)ZZ# $
;ZZ$ %
}[[ 
}\\ 	
public^^ 
FormEditarAgenda^^ 
(^^  
)^^  !
{__ 	
InitializeComponent`` 
(``  
)``  !
;``! "
}aa 	
publiccc 
voidcc 
Limpiarcc 
(cc 
)cc 
{dd 	
	txtMotivoee 
.ee 
Textee 
=ee 
$stree 
;ee  
txtHoraff 
.ff 
Textff 
=ff 
$strff 
;ff 
txtCitagg 
.gg 
Textgg 
=gg 
$strgg 
;gg 
txtDNIhh 
.hh 
Texthh 
=hh 
stringhh  
.hh  !
Emptyhh! &
;hh& '
txtIdii 
.ii 
Textii 
=ii 
stringii 
.ii  
Emptyii  %
;ii% &
rbtnDNIjj 
.jj 
Checkedjj 
=jj 
falsejj #
;jj# $
rbtnIdkk 
.kk 
Checkedkk 
=kk 
falsekk "
;kk" #
}ll 	
publicnn 
voidnn 

Desactivarnn 
(nn 
)nn  
{oo 	
	txtMotivopp 
.pp 
Enabledpp 
=pp 
falsepp  %
;pp% &
txtHoraqq 
.qq 
Enabledqq 
=qq 
falseqq #
;qq# $
	dtPicker1rr 
.rr 
Enabledrr 
=rr 
falserr  %
;rr% &
	btnEditarss 
.ss 
Enabledss 
=ss 
falsess  %
;ss% &
	cmbEstadott 
.tt 
Enabledtt 
=tt 
falsett  %
;tt% &
	cmbTamanouu 
.uu 
Enableduu 
=uu 
falseuu  %
;uu% &
txtCitavv 
.vv 
Enabledvv 
=vv 
falsevv #
;vv# $
btnBuscarCitaww 
.ww 
Enabledww !
=ww" #
falseww$ )
;ww) *
}xx 	
publiczz 
voidzz 
Activarzz 
(zz 
)zz 
{{{ 	
	txtMotivo|| 
.|| 
Enabled|| 
=|| 
true||  $
;||$ %
txtHora}} 
.}} 
Enabled}} 
=}} 
true}} "
;}}" #
	dtPicker1~~ 
.~~ 
Enabled~~ 
=~~ 
true~~  $
;~~$ %
	btnEditar 
. 
Enabled 
= 
true  $
;$ %
	cmbEstado
ÄÄ 
.
ÄÄ 
Enabled
ÄÄ 
=
ÄÄ 
true
ÄÄ  $
;
ÄÄ$ %
}
ÅÅ 	
public
ÉÉ 
void
ÉÉ !
BuscarClientePorDNI
ÉÉ '
(
ÉÉ' (
)
ÉÉ( )
{
ÑÑ 	!
MSOFTVETDataContext
ÖÖ 
dc
ÖÖ  "
=
ÖÖ# $
new
ÖÖ% (!
MSOFTVETDataContext
ÖÖ) <
(
ÖÖ< =
)
ÖÖ= >
;
ÖÖ> ?
string
áá 
dniBusqueda
áá 
=
áá  
txtDNI
áá! '
.
áá' (
Text
áá( ,
;
áá, -
var
àà 
clienteEncontrado
àà !
=
àà" #
dc
àà$ &
.
àà& '
	V_Cliente
àà' 0
.
àà0 1
FirstOrDefault
àà1 ?
(
àà? @
c
àà@ A
=>
ààB D
c
ààE F
.
ààF G
DNI
ààG J
==
ààK M
dniBusqueda
ààN Y
)
ààY Z
;
ààZ [
if
ää 
(
ää 
clienteEncontrado
ää !
!=
ää" $
null
ää% )
)
ää) *
{
ãã 

id_cliente
åå 
=
åå 
clienteEncontrado
åå .
.
åå. /
Cod_Cliente
åå/ :
.
åå: ;
ToString
åå; C
(
ååC D
)
ååD E
;
ååE F#
MostrarHistorialCitas
çç %
(
çç% &
)
çç& '
;
çç' (
}
éé 
else
èè 
{
êê 

MessageBox
ëë 
.
ëë 
Show
ëë 
(
ëë  
$str
ëë  7
,
ëë7 8
$str
ëë9 C
,
ëëC D
MessageBoxButtons
ëëE V
.
ëëV W
OK
ëëW Y
,
ëëY Z
MessageBoxIcon
ëë[ i
.
ëëi j
Stop
ëëj n
)
ëën o
;
ëëo p
	cmbTamano
íí 
.
íí 
Enabled
íí !
=
íí" #
false
íí$ )
;
íí) *
txtCita
ìì 
.
ìì 
Enabled
ìì 
=
ìì  !
false
ìì" '
;
ìì' (
}
îî 
}
ïï 	
private
óó 
void
óó 
button1_Click
óó "
(
óó" #
object
óó# )
sender
óó* 0
,
óó0 1
	EventArgs
óó2 ;
e
óó< =
)
óó= >
{
òò 	
try
ôô 
{
öö 
using
õõ 
(
õõ 
var
õõ 
dc
õõ 
=
õõ 
new
õõ  #!
MSOFTVETDataContext
õõ$ 7
(
õõ7 8
)
õõ8 9
)
õõ9 :
{
úú 
if
ùù 
(
ùù 
int
ùù 
.
ùù 
TryParse
ùù $
(
ùù$ %
txtCita
ùù% ,
.
ùù, -
Text
ùù- 1
,
ùù1 2
out
ùù3 6
int
ùù7 :
idCita
ùù; A
)
ùùA B
)
ùùB C
{
ûû 
var
†† 
cita
††  
=
††! "
dc
††# %
.
††% &
V_CargarCitas
††& 3
.
††3 4
FirstOrDefault
††4 B
(
††B C
c
††C D
=>
††E G
c
††H I
.
††I J
ID_Cita
††J Q
==
††R T
idCita
††U [
)
††[ \
;
††\ ]
if
¢¢ 
(
¢¢ 
cita
¢¢  
!=
¢¢! #
null
¢¢$ (
)
¢¢( )
{
££ 
	txtMotivo
•• %
.
••% &
Text
••& *
=
••+ ,
cita
••- 1
.
••1 2
Motivo
••2 8
;
••8 9
	dtPicker1
¶¶ %
.
¶¶% &
Value
¶¶& +
=
¶¶, -
cita
¶¶. 2
.
¶¶2 3
Fecha
¶¶3 8
;
¶¶8 9
txtHora
ßß #
.
ßß# $
Text
ßß$ (
=
ßß) *
cita
ßß+ /
.
ßß/ 0
Hora
ßß0 4
;
ßß4 5
	cmbEstado
®® %
.
®®% &
SelectedItem
®®& 2
=
®®3 4
cita
®®5 9
.
®®9 :
Estado
®®: @
;
®®@ A
	cmbTamano
©© %
.
©©% &
SelectedItem
©©& 2
=
©©3 4
cita
©©5 9
.
©©9 :
Tama√±o
©©: @
;
©©@ A
Activar
™™ #
(
™™# $
)
™™$ %
;
™™% &
	btnBuscar
´´ %
.
´´% &
Enabled
´´& -
=
´´. /
false
´´0 5
;
´´5 6
	cmbTamano
¨¨ %
.
¨¨% &
Enabled
¨¨& -
=
¨¨. /
true
¨¨0 4
;
¨¨4 5
}
≠≠ 
else
ÆÆ 
{
ØØ 

MessageBox
∞∞ &
.
∞∞& '
Show
∞∞' +
(
∞∞+ ,
$str
∞∞, @
,
∞∞@ A
$str
∞∞B I
,
∞∞I J
MessageBoxButtons
∞∞K \
.
∞∞\ ]
OK
∞∞] _
,
∞∞_ `
MessageBoxIcon
∞∞a o
.
∞∞o p
Warning
∞∞p w
)
∞∞w x
;
∞∞x y
}
±± 
}
≤≤ 
else
≥≥ 
{
¥¥ 

MessageBox
µµ "
.
µµ" #
Show
µµ# '
(
µµ' (
$str
µµ( >
,
µµ> ?
$str
µµ@ G
,
µµG H
MessageBoxButtons
µµI Z
.
µµZ [
OK
µµ[ ]
,
µµ] ^
MessageBoxIcon
µµ_ m
.
µµm n
Warning
µµn u
)
µµu v
;
µµv w
}
∂∂ 
}
∑∑ 
}
∏∏ 
catch
ππ 
(
ππ 
	Exception
ππ 
ex
ππ 
)
ππ  
{
∫∫ 

MessageBox
ªª 
.
ªª 
Show
ªª 
(
ªª  
$"
ªª  "
$str
ªª" ;
{
ªª; <
ex
ªª< >
.
ªª> ?
Message
ªª? F
}
ªªF G
"
ªªG H
,
ªªH I
$str
ªªJ Q
,
ªªQ R
MessageBoxButtons
ªªS d
.
ªªd e
OK
ªªe g
,
ªªg h
MessageBoxIcon
ªªi w
.
ªªw x
Error
ªªx }
)
ªª} ~
;
ªª~ 
}
ºº 
}
ΩΩ 	
private
øø 
void
øø  
dgvTabla_CellClick
øø '
(
øø' (
object
øø( .
sender
øø/ 5
,
øø5 6'
DataGridViewCellEventArgs
øø7 P
e
øøQ R
)
øøR S
{
¿¿ 	
try
¡¡ 
{
¬¬ 
if
√√ 
(
√√ 
e
√√ 
.
√√ 
RowIndex
√√ 
>=
√√ !
$num
√√" #
)
√√# $
{
ƒƒ 
DataGridViewRow
≈≈ #
selectedRow
≈≈$ /
=
≈≈0 1
dgvTabla
≈≈2 :
.
≈≈: ;
Rows
≈≈; ?
[
≈≈? @
e
≈≈@ A
.
≈≈A B
RowIndex
≈≈B J
]
≈≈J K
;
≈≈K L
id_cita
»» 
=
»» 
Convert
»» %
.
»»% &
ToInt32
»»& -
(
»»- .
selectedRow
»». 9
.
»»9 :
Cells
»»: ?
[
»»? @
$str
»»@ I
]
»»I J
.
»»J K
Value
»»K P
)
»»P Q
;
»»Q R
txtCita
…… 
.
…… 
Text
……  
=
……! "
id_cita
……# *
.
……* +
ToString
……+ 3
(
……3 4
)
……4 5
;
……5 6
	txtMotivo
   
.
   
Text
   "
=
  # $
selectedRow
  % 0
.
  0 1
Cells
  1 6
[
  6 7
$str
  7 ?
]
  ? @
.
  @ A
Value
  A F
?
  F G
.
  G H
ToString
  H P
(
  P Q
)
  Q R
;
  R S
	dtPicker1
ÀÀ 
.
ÀÀ 
Value
ÀÀ #
=
ÀÀ$ %
Convert
ÀÀ& -
.
ÀÀ- .

ToDateTime
ÀÀ. 8
(
ÀÀ8 9
selectedRow
ÀÀ9 D
.
ÀÀD E
Cells
ÀÀE J
[
ÀÀJ K
$str
ÀÀK R
]
ÀÀR S
.
ÀÀS T
Value
ÀÀT Y
)
ÀÀY Z
;
ÀÀZ [
txtHora
ÃÃ 
.
ÃÃ 
Text
ÃÃ  
=
ÃÃ! "
selectedRow
ÃÃ# .
.
ÃÃ. /
Cells
ÃÃ/ 4
[
ÃÃ4 5
$str
ÃÃ5 ;
]
ÃÃ; <
.
ÃÃ< =
Value
ÃÃ= B
?
ÃÃB C
.
ÃÃC D
ToString
ÃÃD L
(
ÃÃL M
)
ÃÃM N
;
ÃÃN O
	cmbEstado
ÕÕ 
.
ÕÕ 
SelectedItem
ÕÕ *
=
ÕÕ+ ,
selectedRow
ÕÕ- 8
.
ÕÕ8 9
Cells
ÕÕ9 >
[
ÕÕ> ?
$str
ÕÕ? G
]
ÕÕG H
.
ÕÕH I
Value
ÕÕI N
?
ÕÕN O
.
ÕÕO P
ToString
ÕÕP X
(
ÕÕX Y
)
ÕÕY Z
;
ÕÕZ [
	cmbTamano
ŒŒ 
.
ŒŒ 
SelectedItem
ŒŒ *
=
ŒŒ+ ,
selectedRow
ŒŒ- 8
.
ŒŒ8 9
Cells
ŒŒ9 >
[
ŒŒ> ?
$str
ŒŒ? G
]
ŒŒG H
.
ŒŒH I
Value
ŒŒI N
?
ŒŒN O
.
ŒŒO P
ToString
ŒŒP X
(
ŒŒX Y
)
ŒŒY Z
;
ŒŒZ [
	cmbTamano
œœ 
.
œœ 
Enabled
œœ %
=
œœ& '
true
œœ( ,
;
œœ, -
Activar
–– 
(
–– 
)
–– 
;
–– 
}
—— 
}
““ 
catch
”” 
{
‘‘ 
if
’’ 
(
’’ 
e
’’ 
.
’’ 
RowIndex
’’ 
>=
’’ !
$num
’’" #
)
’’# $
{
÷÷ 
DataGridViewRow
◊◊ #
selectedRow
◊◊$ /
=
◊◊0 1
dgvTabla
◊◊2 :
.
◊◊: ;
Rows
◊◊; ?
[
◊◊? @
e
◊◊@ A
.
◊◊A B
RowIndex
◊◊B J
]
◊◊J K
;
◊◊K L
if
ŸŸ 
(
ŸŸ 
rbtnDNI
ŸŸ 
.
ŸŸ  
Checked
ŸŸ  '
)
ŸŸ' (
{
⁄⁄ 
txtDNI
€€ 
.
€€ 
Text
€€ #
=
€€$ %
selectedRow
€€& 1
.
€€1 2
Cells
€€2 7
[
€€7 8
$str
€€8 =
]
€€= >
.
€€> ?
Value
€€? D
?
€€D E
.
€€E F
ToString
€€F N
(
€€N O
)
€€O P
;
€€P Q
}
‹‹ 
else
›› 
if
›› 
(
›› 
rbtnId
›› #
.
››# $
Checked
››$ +
)
››+ ,
{
ﬁﬁ 
txtId
ﬂﬂ 
.
ﬂﬂ 
Text
ﬂﬂ "
=
ﬂﬂ# $
selectedRow
ﬂﬂ% 0
.
ﬂﬂ0 1
Cells
ﬂﬂ1 6
[
ﬂﬂ6 7
$str
ﬂﬂ7 D
]
ﬂﬂD E
.
ﬂﬂE F
Value
ﬂﬂF K
?
ﬂﬂK L
.
ﬂﬂL M
ToString
ﬂﬂM U
(
ﬂﬂU V
)
ﬂﬂV W
;
ﬂﬂW X
}
‡‡ 
}
·· 
}
‚‚ 
}
„„ 	
private
ÂÂ 
void
ÂÂ 
btnCancelar_Click
ÂÂ &
(
ÂÂ& '
object
ÂÂ' -
sender
ÂÂ. 4
,
ÂÂ4 5
	EventArgs
ÂÂ6 ?
e
ÂÂ@ A
)
ÂÂA B
{
ÊÊ 	

Desactivar
ÁÁ 
(
ÁÁ 
)
ÁÁ 
;
ÁÁ 
	btnBuscar
ËË 
.
ËË 
Enabled
ËË 
=
ËË 
true
ËË  $
;
ËË$ %
Limpiar
ÈÈ 
(
ÈÈ 
)
ÈÈ 
;
ÈÈ 
rbtnDNI
ÍÍ 
.
ÍÍ 
Checked
ÍÍ 
=
ÍÍ 
true
ÍÍ "
;
ÍÍ" #
}
ÎÎ 	
public
ÌÌ 
void
ÌÌ  
BuscarClientePorID
ÌÌ &
(
ÌÌ& '
)
ÌÌ' (
{
ÓÓ 	!
MSOFTVETDataContext
ÔÔ 
dc
ÔÔ  "
=
ÔÔ# $
new
ÔÔ% (!
MSOFTVETDataContext
ÔÔ) <
(
ÔÔ< =
)
ÔÔ= >
;
ÔÔ> ?
if
ÒÒ 
(
ÒÒ 
int
ÒÒ 
.
ÒÒ 
TryParse
ÒÒ 
(
ÒÒ 
txtId
ÒÒ "
.
ÒÒ" #
Text
ÒÒ# '
,
ÒÒ' (
out
ÒÒ) ,
int
ÒÒ- 0

idBusqueda
ÒÒ1 ;
)
ÒÒ; <
)
ÒÒ< =
{
ÚÚ 
var
ÛÛ 
clienteEncontrado
ÛÛ %
=
ÛÛ& '
dc
ÛÛ( *
.
ÛÛ* +
	V_Cliente
ÛÛ+ 4
.
ÛÛ4 5
FirstOrDefault
ÛÛ5 C
(
ÛÛC D
c
ÛÛD E
=>
ÛÛF H
c
ÛÛI J
.
ÛÛJ K
Cod_Cliente
ÛÛK V
==
ÛÛW Y

idBusqueda
ÛÛZ d
)
ÛÛd e
;
ÛÛe f
if
ıı 
(
ıı 
clienteEncontrado
ıı %
!=
ıı& (
null
ıı) -
)
ıı- .
{
ˆˆ 

id_cliente
˜˜ 
=
˜˜  
clienteEncontrado
˜˜! 2
.
˜˜2 3
Cod_Cliente
˜˜3 >
.
˜˜> ?
ToString
˜˜? G
(
˜˜G H
)
˜˜H I
;
˜˜I J#
MostrarHistorialCitas
¯¯ )
(
¯¯) *
)
¯¯* +
;
¯¯+ ,
}
˘˘ 
else
˙˙ 
{
˚˚ 

MessageBox
¸¸ 
.
¸¸ 
Show
¸¸ #
(
¸¸# $
$str
¸¸$ ;
,
¸¸; <
$str
¸¸= G
,
¸¸G H
MessageBoxButtons
¸¸I Z
.
¸¸Z [
OK
¸¸[ ]
,
¸¸] ^
MessageBoxIcon
¸¸_ m
.
¸¸m n
Stop
¸¸n r
)
¸¸r s
;
¸¸s t
	cmbTamano
˝˝ 
.
˝˝ 
Enabled
˝˝ %
=
˝˝& '
false
˝˝( -
;
˝˝- .
txtCita
˛˛ 
.
˛˛ 
Enabled
˛˛ #
=
˛˛$ %
false
˛˛& +
;
˛˛+ ,
}
ˇˇ 
}
ÄÄ 
else
ÅÅ 
{
ÇÇ 

MessageBox
ÉÉ 
.
ÉÉ 
Show
ÉÉ 
(
ÉÉ  
$str
ÉÉ  .
,
ÉÉ. /
$str
ÉÉ0 :
,
ÉÉ: ;
MessageBoxButtons
ÉÉ< M
.
ÉÉM N
OK
ÉÉN P
,
ÉÉP Q
MessageBoxIcon
ÉÉR `
.
ÉÉ` a
Stop
ÉÉa e
)
ÉÉe f
;
ÉÉf g
}
ÑÑ 
}
ÖÖ 	
public
áá 
void
áá #
MostrarHistorialCitas
áá )
(
áá) *
)
áá* +
{
àà 	
try
ââ 
{
ää !
MSOFTVETDataContext
ãã #
dc
ãã$ &
=
ãã' (
new
ãã) ,!
MSOFTVETDataContext
ãã- @
(
ãã@ A
)
ããA B
;
ããB C
var
åå 
historialCitas
åå "
=
åå# $
dc
åå% '
.
åå' (
V_CargarCitas
åå( 5
.
çç 
Where
çç 
(
çç 
c
çç 
=>
çç 
c
çç  !
.
çç! "
Cod_Cliente
çç" -
==
çç. 0
Convert
çç1 8
.
çç8 9
ToInt32
çç9 @
(
çç@ A

id_cliente
ççA K
)
ççK L
)
ççL M
.
éé 
Select
éé 
(
éé 
c
éé 
=>
éé  
new
éé! $
{
èè 
c
êê 
.
êê 
ID_Cita
êê !
,
êê! "
c
ëë 
.
ëë 
Nombre
ëë  
,
ëë  !
c
íí 
.
íí 
Apellido
íí "
,
íí" #
c
ìì 
.
ìì 
Paciente
ìì "
,
ìì" #
c
îî 
.
îî 
Motivo
îî  
,
îî  !
c
ïï 
.
ïï 
Tama√±o
ïï  
,
ïï  !
c
ññ 
.
ññ 
Fecha
ññ 
,
ññ  
c
óó 
.
óó 
Hora
óó 
,
óó 
c
òò 
.
òò 
Estado
òò  
}
ôô 
)
ôô 
.
öö 
ToList
öö 
(
öö 
)
öö 
;
öö 
if
úú 
(
úú 
historialCitas
úú "
.
úú" #
Any
úú# &
(
úú& '
)
úú' (
)
úú( )
{
ùù 
dgvTabla
ûû 
.
ûû 

DataSource
ûû '
=
ûû( )
historialCitas
ûû* 8
;
ûû8 9
dgvTabla
üü 
.
üü 
Columns
üü $
[
üü$ %
$num
üü% &
]
üü& '
.
üü' (
Width
üü( -
=
üü. /
$num
üü0 2
;
üü2 3
	cmbTamano
†† 
.
†† 
Enabled
†† %
=
††& '
false
††( -
;
††- .
txtCita
°° 
.
°° 
Enabled
°° #
=
°°# $
true
°°$ (
;
°°( )
btnBuscarCita
¢¢ !
.
¢¢! "
Enabled
¢¢" )
=
¢¢* +
true
¢¢, 0
;
¢¢0 1
}
££ 
else
§§ 
{
•• 

MessageBox
¶¶ 
.
¶¶ 
Show
¶¶ #
(
¶¶# $
$str
¶¶$ P
,
¶¶P Q
$str
¶¶R _
,
¶¶_ `
MessageBoxButtons
¶¶a r
.
¶¶r s
OK
¶¶s u
,
¶¶u v
MessageBoxIcon¶¶w Ö
.¶¶Ö Ü
Information¶¶Ü ë
)¶¶ë í
;¶¶í ì
}
ßß 
}
®® 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
™™ 

MessageBox
´´ 
.
´´ 
Show
´´ 
(
´´  
$"
´´  "
$str
´´" I
{
´´I J
ex
´´J L
.
´´L M
Message
´´M T
}
´´T U
"
´´U V
,
´´V W
$str
´´X _
,
´´_ `
MessageBoxButtons
´´a r
.
´´r s
OK
´´s u
,
´´u v
MessageBoxIcon´´w Ö
.´´Ö Ü
Error´´Ü ã
)´´ã å
;´´å ç
}
¨¨ 
}
≠≠ 	
private
ØØ 
void
ØØ 
MostrarClientes
ØØ $
(
ØØ$ %
)
ØØ% &
{
∞∞ 	
try
±± 
{
≤≤ 
using
≥≥ 
(
≥≥ 
var
≥≥ 
dc
≥≥ 
=
≥≥ 
new
≥≥  #!
MSOFTVETDataContext
≥≥$ 7
(
≥≥7 8
)
≥≥8 9
)
≥≥9 :
{
¥¥ 
var
µµ 
todosClientes
µµ %
=
µµ& '
dc
µµ( *
.
µµ* +
	V_Cliente
µµ+ 4
.
µµ4 5
Select
µµ5 ;
(
µµ; <
c
µµ< =
=>
µµ> @
new
µµA D
{
µµE F
c
µµG H
.
µµH I
Cod_Cliente
µµI T
,
µµT U
c
µµV W
.
µµW X
Nombre
µµX ^
,
µµ^ _
c
µµ` a
.
µµa b
Apellido
µµb j
,
µµj k
c
µµl m
.
µµm n
DNI
µµn q
}
µµr s
)
µµs t
.
µµt u
ToList
µµu {
(
µµ{ |
)
µµ| }
;
µµ} ~
dgvTabla
∑∑ 
.
∑∑ 

DataSource
∑∑ '
=
∑∑( )
null
∑∑* .
;
∑∑. /
dgvTabla
∏∏ 
.
∏∏ 

DataSource
∏∏ '
=
∏∏( )
todosClientes
∏∏* 7
;
∏∏7 8
dgvTabla
ππ 
.
ππ 
Columns
ππ $
[
ππ$ %
$num
ππ% &
]
ππ& '
.
ππ' (
Width
ππ( -
=
ππ. /
$num
ππ0 2
;
ππ2 3
}
∫∫ 
}
ªª 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
ΩΩ 

MessageBox
ææ 
.
ææ 
Show
ææ 
(
ææ  
$"
ææ  "
$str
ææ" G
{
ææG H
ex
ææH J
.
ææJ K
Message
ææK R
}
ææR S
"
ææS T
,
ææT U
$str
ææV ]
,
ææ] ^
MessageBoxButtons
ææ_ p
.
ææp q
OK
ææq s
,
ææs t
MessageBoxIconææu É
.ææÉ Ñ
ErrorææÑ â
)ææâ ä
;ææä ã
}
øø 
}
¿¿ 	
}
¬¬ 
}√√ ÙZ
zC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormCitasProgramadas.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class  
FormCitasProgramadas -
:. /
Form0 4
{ 
private		 
ClsCita		 
objCita		 
=		  !
new		" %
ClsCita		& -
(		- .
)		. /
;		/ 0
public  
FormCitasProgramadas #
(# $
)$ %
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
btnVerTodo_Click %
(% &
object& ,
sender- 3
,3 4
	EventArgs5 >
e? @
)@ A
{ 	
MostrarCitas 
( 
) 
; 
} 	
private 
void 
btnActualizar_Click (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
try 
{ 
DateTime 
fechaSeleccionada *
=+ ,
	dtPicker1- 6
.6 7
Value7 <
.< =
Date= A
;A B
var 

citasFecha 
=  
objCita! (
.( ) 
ObtenerCitasPorFecha) =
(= >
fechaSeleccionada> O
)O P
;P Q
dgvCitas 
. 

DataSource #
=$ %

citasFecha& 0
;0 1
dgvCitas 
. 
Columns  
[  !
$num! "
]" #
.# $
Width$ )
=* +
$num, .
;. /
} 
catch 
( 
	Exception 
ex 
)  
{ 

MessageBox   
.   
Show   
(    
$"    "
$str  " X
{  X Y
ex  Y [
.  [ \
Message  \ c
}  c d
"  d e
,  e f
$str  g n
,  n o
MessageBoxButtons	  p Å
.
  Å Ç
OK
  Ç Ñ
,
  Ñ Ö
MessageBoxIcon
  Ü î
.
  î ï
Error
  ï ö
)
  ö õ
;
  õ ú
}!! 
}"" 	
private$$ 
void$$ %
FormCitasProgramadas_Load$$ .
($$. /
object$$/ 5
sender$$6 <
,$$< =
	EventArgs$$> G
e$$H I
)$$I J
{%% 	
var&& 
citasPendientes&& 
=&&  !
objCita&&" )
.&&) *
Cargar&&* 0
(&&0 1
)&&1 2
;&&2 3
dgvCitas'' 
.'' 

DataSource'' 
=''  !
citasPendientes''" 1
;''1 2
dgvCitas(( 
.(( 
Columns(( 
[(( 
$num(( 
](( 
.((  
Width((  %
=((& '
$num((( *
;((* +
})) 	
public++ 
void++ 
MostrarCitas++  
(++  !
)++! "
{,, 	
try-- 
{.. 
var// 

todasCitas// 
=//  
objCita//! (
.//( )
ObtenerTodasCitas//) :
(//: ;
)//; <
;//< =
dgvCitas00 
.00 

DataSource00 #
=00$ %

todasCitas00& 0
;000 1
dgvCitas11 
.11 
Columns11  
[11  !
$num11! "
]11" #
.11# $
Width11$ )
=11* +
$num11, .
;11. /
}22 
catch33 
(33 
	Exception33 
ex33 
)33  
{44 

MessageBox55 
.55 
Show55 
(55  
$"55  "
$str55" =
{55= >
ex55> @
.55@ A
Message55A H
}55H I
"55I J
,55J K
$str55L S
,55S T
MessageBoxButtons55U f
.55f g
OK55g i
,55i j
MessageBoxIcon55k y
.55y z
Error55z 
)	55 Ä
;
55Ä Å
}66 
}77 	
private99 
void99 
btnEliminar_Click99 &
(99& '
object99' -
sender99. 4
,994 5
	EventArgs996 ?
e99@ A
)99A B
{:: 	
try;; 
{<< 
if== 
(== 
int== 
.== 
TryParse==  
(==  !
txtCancelar==! ,
.==, -
Text==- 1
,==1 2
out==3 6
int==7 :
idCita==; A
)==A B
)==B C
{>> 
objCita@@ 
.@@ 
CancelarCita@@ (
(@@( )
idCita@@) /
)@@/ 0
;@@0 1

MessageBoxCC 
.CC 
ShowCC #
(CC# $
$strCC$ ?
,CC? @
$strCCA H
,CCH I
MessageBoxButtonsCCJ [
.CC[ \
OKCC\ ^
,CC^ _
MessageBoxIconCC` n
.CCn o
InformationCCo z
)CCz {
;CC{ |
MostrarCitasDD  
(DD  !
)DD! "
;DD" #
}EE 
elseFF 
{GG 

MessageBoxHH 
.HH 
ShowHH #
(HH# $
$strHH$ :
,HH: ;
$strHH< C
,HHC D
MessageBoxButtonsHHE V
.HHV W
OKHHW Y
,HHY Z
MessageBoxIconHH[ i
.HHi j
WarningHHj q
)HHq r
;HHr s
}II 
}JJ 
catchKK 
(KK 
	ExceptionKK 
exKK 
)KK  
{LL 

MessageBoxMM 
.MM 
ShowMM 
(MM  
$"MM  "
$strMM" =
{MM= >
exMM> @
.MM@ A
MessageMMA H
}MMH I
"MMI J
,MMJ K
$strMML S
,MMS T
MessageBoxButtonsMMU f
.MMf g
OKMMg i
,MMi j
MessageBoxIconMMk y
.MMy z
ErrorMMz 
)	MM Ä
;
MMÄ Å
}NN 
}OO 	
privateQQ 
voidQQ 
btnVerEstado_ClickQQ '
(QQ' (
objectQQ( .
senderQQ/ 5
,QQ5 6
	EventArgsQQ7 @
eQQA B
)QQB C
{RR 	
trySS 
{TT 
stringVV 
estadoSeleccionadoVV )
=VV* +
	cmbEstadoVV, 5
.VV5 6
SelectedItemVV6 B
?VVB C
.VVC D
ToStringVVD L
(VVL M
)VVM N
;VVN O
ifXX 
(XX 
stringXX 
.XX 
IsNullOrEmptyXX (
(XX( )
estadoSeleccionadoXX) ;
)XX; <
)XX< =
{YY 

MessageBoxZZ 
.ZZ 
ShowZZ #
(ZZ# $
$strZZ$ Y
,ZZY Z
$strZZ[ h
,ZZh i
MessageBoxButtonsZZj {
.ZZ{ |
OKZZ| ~
,ZZ~ 
MessageBoxIcon
ZZÄ é
.
ZZé è
Warning
ZZè ñ
)
ZZñ ó
;
ZZó ò
return[[ 
;[[ 
}\\ 
var__ 
citasConEstado__ "
=__# $
objCita__% ,
.__, -!
ObtenerCitasPorEstado__- B
(__B C
estadoSeleccionado__C U
)__U V
;__V W
dgvCitasbb 
.bb 

DataSourcebb #
=bb$ %
citasConEstadobb& 4
;bb4 5
dgvCitascc 
.cc 
Columnscc  
[cc  !
$numcc! "
]cc" #
.cc# $
Widthcc$ )
=cc* +
$numcc, .
;cc. /
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 

MessageBoxgg 
.gg 
Showgg 
(gg  
$"gg  "
$strgg" X
{ggX Y
exggY [
.gg[ \
Messagegg\ c
}ggc d
"ggd e
,gge f
$strggg n
,ggn o
MessageBoxButtons	ggp Å
.
ggÅ Ç
OK
ggÇ Ñ
,
ggÑ Ö
MessageBoxIcon
ggÜ î
.
ggî ï
Error
ggï ö
)
ggö õ
;
ggõ ú
}hh 
}ii 	
privatekk 
voidkk #
dgvCitas_CellFormattingkk ,
(kk, -
objectkk- 3
senderkk4 :
,kk: ;/
#DataGridViewCellFormattingEventArgskk< _
ekk` a
)kka b
{ll 	
intmm 
estadoColumnIndexmm !
=mm" #
dgvCitasmm$ ,
.mm, -
Columnsmm- 4
[mm4 5
$strmm5 =
]mm= >
.mm> ?
Indexmm? D
;mmD E
ifpp 
(pp 
epp 
.pp 
ColumnIndexpp 
==pp  
estadoColumnIndexpp! 2
&&pp3 5
epp6 7
.pp7 8
RowIndexpp8 @
>=ppA C
$numppD E
)ppE F
{qq 
stringss 
estadoss 
=ss 
dgvCitasss  (
.ss( )
Rowsss) -
[ss- .
ess. /
.ss/ 0
RowIndexss0 8
]ss8 9
.ss9 :
Cellsss: ?
[ss? @
ess@ A
.ssA B
ColumnIndexssB M
]ssM N
.ssN O
ValuessO T
.ssT U
ToStringssU ]
(ss] ^
)ss^ _
;ss_ `
ifvv 
(vv 
estadovv 
==vv 
$strvv )
)vv) *
{ww 
exx 
.xx 
	CellStylexx 
.xx  
	BackColorxx  )
=xx* +
Systemxx, 2
.xx2 3
Drawingxx3 :
.xx: ;
Colorxx; @
.xx@ A
YellowxxA G
;xxG H
eyy 
.yy 
	CellStyleyy 
.yy  
	ForeColoryy  )
=yy* +
Systemyy, 2
.yy2 3
Drawingyy3 :
.yy: ;
Coloryy; @
.yy@ A
BlackyyA F
;yyF G
}zz 
else{{ 
if{{ 
({{ 
estado{{ 
=={{  "
$str{{# .
){{. /
{|| 
e}} 
.}} 
	CellStyle}} 
.}}  
	BackColor}}  )
=}}* +
System}}, 2
.}}2 3
Drawing}}3 :
.}}: ;
Color}}; @
.}}@ A
Red}}A D
;}}D E
e~~ 
.~~ 
	CellStyle~~ 
.~~  
	ForeColor~~  )
=~~* +
System~~, 2
.~~2 3
Drawing~~3 :
.~~: ;
Color~~; @
.~~@ A
White~~A F
;~~F G
} 
else
ÄÄ 
if
ÄÄ 
(
ÄÄ 
estado
ÄÄ 
==
ÄÄ  "
$str
ÄÄ# -
)
ÄÄ- .
{
ÅÅ 
e
ÇÇ 
.
ÇÇ 
	CellStyle
ÇÇ 
.
ÇÇ  
	BackColor
ÇÇ  )
=
ÇÇ* +
System
ÇÇ, 2
.
ÇÇ2 3
Drawing
ÇÇ3 :
.
ÇÇ: ;
Color
ÇÇ; @
.
ÇÇ@ A
Green
ÇÇA F
;
ÇÇF G
e
ÉÉ 
.
ÉÉ 
	CellStyle
ÉÉ 
.
ÉÉ  
	ForeColor
ÉÉ  )
=
ÉÉ* +
System
ÉÉ, 2
.
ÉÉ2 3
Drawing
ÉÉ3 :
.
ÉÉ: ;
Color
ÉÉ; @
.
ÉÉ@ A
White
ÉÉA F
;
ÉÉF G
}
ÑÑ 
}
ÖÖ 
}
ÜÜ 	
}
áá 
}àà Ùﬁ
wC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\RegistrarPaciente.cs
	namespace 	
ProyectoFinal
 
{		 
public

 

partial

 
class

 
RegistrarPaciente

 *
:

+ ,
Form

- 1
{ 
private 
ClsPaciente 
paciente $
;$ %
string 
dni 
; 
private 
void  
btnAgregarProp_Click )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
RegistrarCliente 
registrarCliente -
=. /
new0 3
RegistrarCliente4 D
(D E
)E F
;F G
this 
. 
Hide 
( 
) 
; 
registrarCliente 
. 
Show !
(! "
)" #
;# $
} 	
private 
void +
cmbEspecie_SelectedIndexChanged 4
(4 5
object5 ;
sender< B
,B C
	EventArgsD M
eN O
)O P
{ 	
if 
( 

cmbEspecie 
. 
SelectedIndex (
==) +
$num, -
)- .
{ 
pictpaciente 
. 
Image "
=# $
ProyectoFinal% 2
.2 3

Properties3 =
.= >
	Resources> G
.G H
perroH M
;M N
} 
else 
if 
( 

cmbEspecie 
.  
SelectedIndex  -
==. 0
$num1 2
)2 3
{ 
pictpaciente 
. 
Image "
=# $
ProyectoFinal% 2
.2 3

Properties3 =
.= >
	Resources> G
.G H
gatoH L
;L M
} 
else   
{!! 
pictpaciente"" 
."" 
Image"" "
=""# $
ProyectoFinal""% 2
.""2 3

Properties""3 =
.""= >
	Resources""> G
.""G H
registrarmascota""H X
;""X Y
}## 
}$$ 	
private%% 
void%% 
button2_Click%% "
(%%" #
object%%# )
sender%%* 0
,%%0 1
	EventArgs%%2 ;
e%%< =
)%%= >
{&& 	
dni'' 
='' 
	txtBuscar'' 
.'' 
Text''  
;''  !
if)) 
()) 
!)) 
string)) 
.)) 
IsNullOrEmpty)) %
())% &
dni))& )
)))) *
&&))+ -
dni)). 1
.))1 2
Length))2 8
==))9 ;
$num))< =
)))= >
{** 
BuscarClientePorDNI++ #
(++# $
dni++$ '
)++' (
;++( )
if-- 
(-- 
int-- 
.-- 
TryParse--  
(--  !
txtCodCliente--! .
.--. /
Text--/ 3
,--3 4
out--5 8
int--9 <

codCliente--= G
)--G H
)--H I
{.. 
BuscarPacientes// #
(//# $

codCliente//$ .
)//. /
;/// 0
DesactivarCampos00 $
(00$ %
true00% )
,00) *
true00+ /
,00/ 0
true001 5
,005 6
true007 ;
,00; <
true00= A
)00A B
;00B C
}11 
else22 
{33 
}44 
}55 
else66 
{77 

MessageBox88 
.88 
Show88 
(88  
$str88  B
,88B C
$str88D K
,88K L
MessageBoxButtons88M ^
.88^ _
OK88_ a
,88a b
MessageBoxIcon88c q
.88q r
Error88r w
)88w x
;88x y
}99 
}:: 	
private<< 
void<< 
btnLimpiar_Click_1<< '
(<<' (
object<<( .
sender<</ 5
,<<5 6
	EventArgs<<7 @
e<<A B
)<<B C
{== 	
	txtBuscar>> 
.>> 
Text>> 
=>> 
$str>> 
;>>  

CargarTodo?? 
(?? 
)?? 
;?? 
LIMPIARPANTALLA@@ 
(@@ 
)@@ 
;@@ 
DesactivarCamposAA 
(AA 
falseAA "
,AA" #
falseAA$ )
,AA) *
falseAA+ 0
,AA0 1
falseAA2 7
,AA7 8
falseAA9 >
)AA> ?
;AA? @
}BB 	
privateDD 
voidDD  
btnRegistrar_Click_1DD )
(DD) *
objectDD* 0
senderDD1 7
,DD7 8
	EventArgsDD9 B
eDDC D
)DDD E
{EE 	
tryFF 
{GG 
CargarDatosHH 
(HH 
)HH 
;HH 
pacienteII 
.II 

CodClienteII #
=II$ %
ConvertII& -
.II- .
ToInt32II. 5
(II5 6
txtCodClienteII6 C
.IIC D
TextIID H
)IIH I
;III J
ifKK 
(KK 
pacienteKK 
.KK 

CodClienteKK '
>KK( )
$numKK* +
&&KK, .
pacienteKK/ 7
.KK7 8
ValidarDatosKK8 D
(KKD E
)KKE F
)KKF G
{LL 
pacienteMM 
.MM !
InsertarEnBaseDeDatosMM 2
(MM2 3
)MM3 4
;MM4 5

MessageBoxOO 
.OO 
ShowOO #
(OO# $
$strOO$ 6
,OO6 7
$strOO8 B
,OOB C
MessageBoxButtonsOOD U
.OOU V
OKOOV X
,OOX Y
MessageBoxIconOOZ h
.OOh i
InformationOOi t
)OOt u
;OOu v
DesactivarCamposPP $
(PP$ %
falsePP% *
,PP* +
falsePP, 1
,PP1 2
falsePP3 8
,PP8 9
falsePP: ?
,PP? @
falsePPA F
)PPF G
;PPG H

CargarTodoQQ 
(QQ 
)QQ  
;QQ  !
}RR 
elseSS 
{TT 

MessageBoxUU 
.UU 
ShowUU #
(UU# $
$strUU$ F
,UUF G
$strUUH O
,UUO P
MessageBoxButtonsUUQ b
.UUb c
OKUUc e
,UUe f
MessageBoxIconUUg u
.UUu v
ErrorUUv {
)UU{ |
;UU| }
}VV 
LIMPIARPANTALLAXX 
(XX  
)XX  !
;XX! "
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ  
{[[ 

MessageBox\\ 
.\\ 
Show\\ 
(\\  
$"\\  "
$str\\" G
{\\G H
ex\\H J
.\\J K
Message\\K R
}\\R S
"\\S T
,\\T U
$str\\V ]
,\\] ^
MessageBoxButtons\\_ p
.\\p q
OK\\q s
,\\s t
MessageBoxIcon	\\u É
.
\\É Ñ
Error
\\Ñ â
)
\\â ä
;
\\ä ã
}]] 
}^^ 	
public`` 
void`` 
LIMPIARPANTALLA`` #
(``# $
)``$ %
{aa 	
	txtBuscarbb 
.bb 
Textbb 
=bb 
$strbb 
;bb  
txtNombreMascotacc 
.cc 
Textcc !
=cc" #
$strcc$ &
;cc& '

cmbEspeciedd 
.dd 
SelectedIndexdd $
=dd% &
-dd' (
$numdd( )
;dd) *
txtRazaee 
.ee 
Textee 
=ee 
$stree 
;ee 
	cmbGeneroff 
.ff 
SelectedIndexff #
=ff$ %
-ff& '
$numff' (
;ff( )
datePickPacientegg 
.gg 
Valuegg "
=gg# $
DateTimegg% -
.gg- .
Nowgg. 1
;gg1 2
txtCodClientehh 
.hh 
Texthh 
=hh  
$strhh! #
;hh# $
txtCodClienteii 
.ii 
Textii 
=ii  
$strii! #
;ii# $
txtNomClientejj 
.jj 
Textjj 
=jj  
$strjj! #
;jj# $
txtApelClientekk 
.kk 
Textkk 
=kk  !
$strkk" $
;kk$ %
txtTelClientell 
.ll 
Textll 
=ll  
$strll! #
;ll# $
txtGenClientemm 
.mm 
Textmm 
=mm  
$strmm! #
;mm# $
textDNInn 
.nn 
Textnn 
=nn 
$strnn 
;nn 
txtDirecoo 
.oo 
Textoo 
=oo 
$stroo 
;oo 
pacientepp 
=pp 
newpp 
ClsPacientepp &
(pp& '
)pp' (
;pp( )
}qq 	
publictt 
RegistrarPacientett  
(tt  !
)tt! "
{uu 	
InitializeComponentvv 
(vv  
)vv  !
;vv! "

CargarTodoww 
(ww 
)ww 
;ww 
DesactivarCamposxx 
(xx 
falsexx "
,xx" #
falsexx$ )
,xx) *
falsexx+ 0
,xx0 1
falsexx2 7
,xx7 8
falsexx9 >
)xx> ?
;xx? @
pacienteyy 
=yy 
newyy 
ClsPacienteyy &
(yy& '
)yy' (
;yy( )
}zz 	
private|| 
void|| 
BuscarClientePorDNI|| (
(||( )
string||) /
dni||0 3
)||3 4
{}} 	
using~~ 
(~~ 
var~~ 
dc~~ 
=~~ 
new~~ 
MSOFTVETDataContext~~  3
(~~3 4
)~~4 5
)~~5 6
{ 
var
ÄÄ 
clienteEncontrado
ÄÄ %
=
ÄÄ& '
dc
ÄÄ( *
.
ÄÄ* +
SP_BuscarCliente
ÄÄ+ ;
(
ÄÄ; <
dni
ÄÄ< ?
)
ÄÄ? @
.
ÄÄ@ A
FirstOrDefault
ÄÄA O
(
ÄÄO P
)
ÄÄP Q
;
ÄÄQ R
if
ÇÇ 
(
ÇÇ 
clienteEncontrado
ÇÇ %
!=
ÇÇ& (
null
ÇÇ) -
)
ÇÇ- .
{
ÉÉ 
txtCodCliente
ÑÑ !
.
ÑÑ! "
Text
ÑÑ" &
=
ÑÑ' (
clienteEncontrado
ÑÑ) :
.
ÑÑ: ;
Cod_Cliente
ÑÑ; F
.
ÑÑF G
ToString
ÑÑG O
(
ÑÑO P
)
ÑÑP Q
;
ÑÑQ R
txtNomCliente
ÖÖ !
.
ÖÖ! "
Text
ÖÖ" &
=
ÖÖ' (
clienteEncontrado
ÖÖ) :
.
ÖÖ: ;
Nombre
ÖÖ; A
;
ÖÖA B
txtApelCliente
ÜÜ "
.
ÜÜ" #
Text
ÜÜ# '
=
ÜÜ( )
clienteEncontrado
ÜÜ* ;
.
ÜÜ; <
Apellido
ÜÜ< D
;
ÜÜD E
txtTelCliente
áá !
.
áá! "
Text
áá" &
=
áá' (
clienteEncontrado
áá) :
.
áá: ;
Telefono
áá; C
;
ááC D
txtGenCliente
àà !
.
àà! "
Text
àà" &
=
àà' (
clienteEncontrado
àà) :
.
àà: ;
Genero
àà; A
;
ààA B
textDNI
ââ 
.
ââ 
Text
ââ  
=
ââ! "
clienteEncontrado
ââ# 4
.
ââ4 5
DNI
ââ5 8
;
ââ8 9
txtDirec
ää 
.
ää 
Text
ää !
=
ää" #
clienteEncontrado
ää$ 5
.
ää5 6
	Direccion
ää6 ?
;
ää? @
}
ãã 
else
åå 
{
çç 

MessageBox
éé 
.
éé 
Show
éé #
(
éé# $
$str
éé$ <
,
éé< =
$str
éé> E
,
ééE F
MessageBoxButtons
ééG X
.
ééX Y
OK
ééY [
,
éé[ \
MessageBoxIcon
éé] k
.
éék l
Error
éél q
)
ééq r
;
éér s
LIMPIARPANTALLA
èè #
(
èè# $
)
èè$ %
;
èè% &
}
êê 
}
ëë 
}
íí 	
private
îî 
void
îî 
BuscarPacientes
îî $
(
îî$ %
int
îî% (

codCliente
îî) 3
)
îî3 4
{
ïï 	
try
ññ 
{
óó 
using
òò 
(
òò 
var
òò 
dc
òò 
=
òò 
new
òò  #!
MSOFTVETDataContext
òò$ 7
(
òò7 8
)
òò8 9
)
òò9 :
{
ôô 
var
öö 
	pacientes
öö !
=
öö" #
dc
öö$ &
.
öö& '

V_Paciente
öö' 1
.
öö1 2
Where
öö2 7
(
öö7 8
p
öö8 9
=>
öö: <
p
öö= >
.
öö> ?
Cod_Cliente
öö? J
==
ööK M

codCliente
ööN X
)
ööX Y
.
ööY Z
ToList
ööZ `
(
öö` a
)
ööa b
;
ööb c
dgvPaciente
úú 
.
úú  

DataSource
úú  *
=
úú+ ,
	pacientes
úú- 6
;
úú6 7
}
ùù 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
†† 

MessageBox
°° 
.
°° 
Show
°° 
(
°°  
$"
°°  "
$str
°°" =
{
°°= >
ex
°°> @
.
°°@ A
Message
°°A H
}
°°H I
"
°°I J
,
°°J K
$str
°°L S
,
°°S T
MessageBoxButtons
°°U f
.
°°f g
OK
°°g i
,
°°i j
MessageBoxIcon
°°k y
.
°°y z
Error
°°z 
)°° Ä
;°°Ä Å
}
¢¢ 
}
££ 	
private
•• 
void
•• 
CargarTabla
••  
(
••  !
)
••! "
{
¶¶ 	
if
ßß 
(
ßß 
int
ßß 
.
ßß 
TryParse
ßß 
(
ßß 
txtCodCliente
ßß *
.
ßß* +
Text
ßß+ /
,
ßß/ 0
out
ßß1 4
int
ßß5 8

codCliente
ßß9 C
)
ßßC D
)
ßßD E
{
®® 
dgvPaciente
©© 
.
©© 

DataSource
©© &
=
©©' (
ClsPaciente
©©) 4
.
©©4 5#
ObtenerListaPacientes
©©5 J
(
©©J K

codCliente
©©K U
)
©©U V
;
©©V W
}
´´ 
}
¨¨ 	
private
≠≠ 
void
≠≠ 

CargarTodo
≠≠ 
(
≠≠  
)
≠≠  !
{
ÆÆ 	
dgvPaciente
ØØ 
.
ØØ 

DataSource
ØØ "
=
ØØ# $
ClsPaciente
ØØ% 0
.
ØØ0 1

CargarTodo
ØØ1 ;
(
ØØ; <
)
ØØ< =
;
ØØ= >
dgvPaciente
∞∞ 
.
∞∞ 
Columns
∞∞ 
[
∞∞  
$num
∞∞  !
]
∞∞! "
.
∞∞" #
Width
∞∞# (
=
∞∞) *
$num
∞∞+ -
;
∞∞- .
dgvPaciente
±± 
.
±± 
Columns
±± 
[
±±  
$num
±±  !
]
±±! "
.
±±" #
Width
±±# (
=
±±) *
$num
±±+ -
;
±±- .
dgvPaciente
≤≤ 
.
≤≤ 
Columns
≤≤ 
[
≤≤  
$num
≤≤  !
]
≤≤! "
.
≤≤" #
Width
≤≤# (
=
≤≤) *
$num
≤≤+ -
;
≤≤- .
dgvPaciente
≥≥ 
.
≥≥ 
Columns
≥≥ 
[
≥≥  
$num
≥≥  !
]
≥≥! "
.
≥≥" #
Width
≥≥# (
=
≥≥) *
$num
≥≥+ -
;
≥≥- .
dgvPaciente
¥¥ 
.
¥¥ 
Columns
¥¥ 
[
¥¥  
$num
¥¥  !
]
¥¥! "
.
¥¥" #
Width
¥¥# (
=
¥¥) *
$num
¥¥+ -
;
¥¥- .
dgvPaciente
µµ 
.
µµ 
Columns
µµ 
[
µµ  
$num
µµ  !
]
µµ! "
.
µµ" #
Width
µµ# (
=
µµ) *
$num
µµ+ -
;
µµ- .
}
∂∂ 	
private
∏∏ 
void
∏∏ 
DesactivarCampos
∏∏ %
(
∏∏% &
bool
∏∏& *
n
∏∏+ ,
,
∏∏, -
bool
∏∏. 2
r
∏∏3 4
,
∏∏4 5
bool
∏∏6 :
e
∏∏; <
,
∏∏< =
bool
∏∏> B
g
∏∏C D
,
∏∏D E
bool
∏∏F J
f
∏∏K L
)
∏∏L M
{
ππ 	
txtNombreMascota
∫∫ 
.
∫∫ 
Enabled
∫∫ $
=
∫∫% &
n
∫∫' (
;
∫∫( )
txtRaza
ªª 
.
ªª 
Enabled
ªª 
=
ªª 
r
ªª 
;
ªª  

cmbEspecie
ºº 
.
ºº 
Enabled
ºº 
=
ºº  
e
ºº! "
;
ºº" #
	cmbGenero
ΩΩ 
.
ΩΩ 
Enabled
ΩΩ 
=
ΩΩ 
g
ΩΩ  !
;
ΩΩ! "
datePickPaciente
ææ 
.
ææ 
Enabled
ææ $
=
ææ% &
f
ææ' (
;
ææ( )
}
øø 	
private
¿¿ 
void
¿¿ 
CargarDatos
¿¿  
(
¿¿  !
)
¿¿! "
{
¡¡ 	
paciente
¬¬ 
.
¬¬ 
Nombre
¬¬ 
=
¬¬ 
txtNombreMascota
¬¬ .
.
¬¬. /
Text
¬¬/ 3
;
¬¬3 4
paciente
√√ 
.
√√ 
Especie
√√ 
=
√√ 

cmbEspecie
√√ )
.
√√) *
SelectedItem
√√* 6
?
√√6 7
.
√√7 8
ToString
√√8 @
(
√√@ A
)
√√A B
;
√√B C
paciente
ƒƒ 
.
ƒƒ 
Raza
ƒƒ 
=
ƒƒ 
txtRaza
ƒƒ #
.
ƒƒ# $
Text
ƒƒ$ (
;
ƒƒ( )
paciente
≈≈ 
.
≈≈ 
Sexo
≈≈ 
=
≈≈ 
(
≈≈ 
	cmbGenero
≈≈ &
.
≈≈& '
SelectedIndex
≈≈' 4
==
≈≈5 7
$num
≈≈8 9
)
≈≈9 :
?
≈≈; <
$str
≈≈= D
:
≈≈E F
(
≈≈G H
	cmbGenero
≈≈H Q
.
≈≈Q R
SelectedIndex
≈≈R _
==
≈≈` b
$num
≈≈c d
)
≈≈d e
?
≈≈f g
$str
≈≈h p
:
≈≈q r
$str
≈≈s z
;
≈≈z {
paciente
∆∆ 
.
∆∆ 
FechaNacimiento
∆∆ $
=
∆∆% &
datePickPaciente
∆∆' 7
.
∆∆7 8
Value
∆∆8 =
;
∆∆= >
}
«« 	
private
…… 
void
…… #
dgvPaciente_CellClick
…… *
(
……* +
object
……+ 1
sender
……2 8
,
……8 9'
DataGridViewCellEventArgs
……: S
e
……T U
)
……U V
{
   	
if
ÀÀ 
(
ÀÀ 
e
ÀÀ 
.
ÀÀ 
RowIndex
ÀÀ 
>=
ÀÀ 
$num
ÀÀ 
&&
ÀÀ  "
e
ÀÀ# $
.
ÀÀ$ %
RowIndex
ÀÀ% -
<
ÀÀ. /
dgvPaciente
ÀÀ0 ;
.
ÀÀ; <
Rows
ÀÀ< @
.
ÀÀ@ A
Count
ÀÀA F
)
ÀÀF G
{
ÃÃ 
DataGridViewRow
ÕÕ 
fila
ÕÕ  $
=
ÕÕ% &
dgvPaciente
ÕÕ' 2
.
ÕÕ2 3
Rows
ÕÕ3 7
[
ÕÕ7 8
e
ÕÕ8 9
.
ÕÕ9 :
RowIndex
ÕÕ: B
]
ÕÕB C
;
ÕÕC D
try
œœ 
{
–– 
paciente
—— 
.
—— 
CodPaciente
—— (
=
——) *
Convert
——+ 2
.
——2 3
ToInt32
——3 :
(
——: ;
fila
——; ?
.
——? @
Cells
——@ E
[
——E F
$str
——F T
]
——T U
.
——U V
Value
——V [
)
——[ \
;
——\ ]
paciente
““ 
.
““ 
Nombre
““ #
=
““$ %
fila
““& *
.
““* +
Cells
““+ 0
[
““0 1
$str
““1 9
]
““9 :
.
““: ;
Value
““; @
.
““@ A
ToString
““A I
(
““I J
)
““J K
;
““K L
paciente
”” 
.
”” 
Especie
”” $
=
””% &
fila
””' +
.
””+ ,
Cells
””, 1
[
””1 2
$str
””2 ;
]
””; <
.
””< =
Value
””= B
.
””B C
ToString
””C K
(
””K L
)
””L M
;
””M N
paciente
‘‘ 
.
‘‘ 
Raza
‘‘ !
=
‘‘" #
fila
‘‘$ (
.
‘‘( )
Cells
‘‘) .
[
‘‘. /
$str
‘‘/ 5
]
‘‘5 6
.
‘‘6 7
Value
‘‘7 <
.
‘‘< =
ToString
‘‘= E
(
‘‘E F
)
‘‘F G
;
‘‘G H
paciente
’’ 
.
’’ 
Sexo
’’ !
=
’’" #
fila
’’$ (
.
’’( )
Cells
’’) .
[
’’. /
$str
’’/ 5
]
’’5 6
.
’’6 7
Value
’’7 <
.
’’< =
ToString
’’= E
(
’’E F
)
’’F G
;
’’G H
paciente
÷÷ 
.
÷÷ 
FechaNacimiento
÷÷ ,
=
÷÷- .
Convert
÷÷/ 6
.
÷÷6 7

ToDateTime
÷÷7 A
(
÷÷A B
fila
÷÷B F
.
÷÷F G
Cells
÷÷G L
[
÷÷L M
$str
÷÷M T
]
÷÷T U
.
÷÷U V
Value
÷÷V [
)
÷÷[ \
;
÷÷\ ]
paciente
◊◊ 
.
◊◊ 

CodCliente
◊◊ '
=
◊◊( )
Convert
◊◊* 1
.
◊◊1 2
ToInt32
◊◊2 9
(
◊◊9 :
fila
◊◊: >
.
◊◊> ?
Cells
◊◊? D
[
◊◊D E
$str
◊◊E R
]
◊◊R S
.
◊◊S T
Value
◊◊T Y
)
◊◊Y Z
;
◊◊Z [
txtNombreMascota
ŸŸ $
.
ŸŸ$ %
Text
ŸŸ% )
=
ŸŸ* +
paciente
ŸŸ, 4
.
ŸŸ4 5
Nombre
ŸŸ5 ;
;
ŸŸ; <

cmbEspecie
⁄⁄ 
.
⁄⁄ 
SelectedItem
⁄⁄ +
=
⁄⁄, -
paciente
⁄⁄. 6
.
⁄⁄6 7
Especie
⁄⁄7 >
;
⁄⁄> ?
txtRaza
€€ 
.
€€ 
Text
€€  
=
€€! "
paciente
€€# +
.
€€+ ,
Raza
€€, 0
;
€€0 1
string
‹‹ 
sexo
‹‹ 
=
‹‹  !
paciente
‹‹" *
.
‹‹* +
Sexo
‹‹+ /
;
‹‹/ 0
	cmbGenero
›› 
.
›› 
SelectedItem
›› *
=
››+ ,
(
››- .
sexo
››. 2
==
››3 5
$str
››6 =
)
››= >
?
››? @
$str
››A H
:
››I J
(
››K L
sexo
››L P
==
››Q S
$str
››T \
)
››\ ]
?
››^ _
$str
››` h
:
››i j
$str
››k r
;
››r s
datePickPaciente
ﬁﬁ $
.
ﬁﬁ$ %
Value
ﬁﬁ% *
=
ﬁﬁ+ ,
paciente
ﬁﬁ- 5
.
ﬁﬁ5 6
FechaNacimiento
ﬁﬁ6 E
;
ﬁﬁE F
txtCodCliente
ﬂﬂ !
.
ﬂﬂ! "
Text
ﬂﬂ" &
=
ﬂﬂ' (
paciente
ﬂﬂ) 1
.
ﬂﬂ1 2

CodCliente
ﬂﬂ2 <
.
ﬂﬂ< =
ToString
ﬂﬂ= E
(
ﬂﬂE F
)
ﬂﬂF G
;
ﬂﬂG H
}
‡‡ 
catch
·· 
{
‚‚ 
}
‰‰ 
}
ÂÂ 
}
ÊÊ 	
private
ËË 
void
ËË  
btnModificar_Click
ËË '
(
ËË' (
object
ËË( .
sender
ËË/ 5
,
ËË5 6
	EventArgs
ËË7 @
e
ËËA B
)
ËËB C
{
ÈÈ 	
try
ÍÍ 
{
ÎÎ 
CargarDatos
ÏÏ 
(
ÏÏ 
)
ÏÏ 
;
ÏÏ 
if
ÌÌ 
(
ÌÌ 
paciente
ÌÌ 
.
ÌÌ 
CodPaciente
ÌÌ (
>
ÌÌ) *
$num
ÌÌ+ ,
)
ÌÌ, -
{
ÓÓ 
paciente
ÔÔ 
.
ÔÔ $
ModificarEnBaseDeDatos
ÔÔ 3
(
ÔÔ3 4
)
ÔÔ4 5
;
ÔÔ5 6

MessageBox
 
.
 
Show
 #
(
# $
$str
$ R
,
R S
$str
T ^
,
^ _
MessageBoxButtons
` q
.
q r
OK
r t
,
t u
MessageBoxIconv Ñ
.Ñ Ö
InformationÖ ê
)ê ë
;ë í
DesactivarCampos
ÒÒ $
(
ÒÒ$ %
false
ÒÒ% *
,
ÒÒ* +
false
ÒÒ, 1
,
ÒÒ1 2
false
ÒÒ3 8
,
ÒÒ8 9
false
ÒÒ: ?
,
ÒÒ? @
false
ÒÒA F
)
ÒÒF G
;
ÒÒG H

CargarTodo
ÚÚ 
(
ÚÚ 
)
ÚÚ  
;
ÚÚ  !
LIMPIARPANTALLA
ÛÛ #
(
ÛÛ# $
)
ÛÛ$ %
;
ÛÛ% &
}
ÙÙ 
else
ıı 
{
ˆˆ 

MessageBox
˜˜ 
.
˜˜ 
Show
˜˜ #
(
˜˜# $
$str
˜˜$ L
,
˜˜L M
$str
˜˜N U
,
˜˜U V
MessageBoxButtons
˜˜W h
.
˜˜h i
OK
˜˜i k
,
˜˜k l
MessageBoxIcon
˜˜m {
.
˜˜{ |
Error˜˜| Å
)˜˜Å Ç
;˜˜Ç É
}
¯¯ 
}
˘˘ 
catch
˙˙ 
(
˙˙ 
	Exception
˙˙ 
ex
˙˙ 
)
˙˙  
{
˚˚ 

MessageBox
¸¸ 
.
¸¸ 
Show
¸¸ 
(
¸¸  
$"
¸¸  "
$str
¸¸" C
"
¸¸C D
,
¸¸D E
$str
¸¸F M
,
¸¸M N
MessageBoxButtons
¸¸O `
.
¸¸` a
OK
¸¸a c
,
¸¸c d
MessageBoxIcon
¸¸e s
.
¸¸s t
Error
¸¸t y
)
¸¸y z
;
¸¸z {
}
˝˝ 
}
˛˛ 	
private
ÄÄ 
void
ÄÄ 
btnEliminar_Click
ÄÄ &
(
ÄÄ& '
object
ÄÄ' -
sender
ÄÄ. 4
,
ÄÄ4 5
	EventArgs
ÄÄ6 ?
e
ÄÄ@ A
)
ÄÄA B
{
ÅÅ 	
try
ÇÇ 
{
ÉÉ 
if
ÑÑ 
(
ÑÑ 
paciente
ÑÑ 
.
ÑÑ 
CodPaciente
ÑÑ (
>
ÑÑ) *
$num
ÑÑ+ ,
)
ÑÑ, -
{
ÖÖ 
paciente
ÜÜ 
.
ÜÜ #
EliminarEnBaseDeDatos
ÜÜ 2
(
ÜÜ2 3
)
ÜÜ3 4
;
ÜÜ4 5

MessageBox
àà 
.
àà 
Show
àà #
(
àà# $
$str
àà$ Q
,
ààQ R
$str
ààS ]
,
àà] ^
MessageBoxButtons
àà_ p
.
ààp q
OK
ààq s
,
ààs t
MessageBoxIconààu É
.ààÉ Ñ
InformationààÑ è
)ààè ê
;ààê ë
DesactivarCampos
ââ $
(
ââ$ %
false
ââ% *
,
ââ* +
false
ââ, 1
,
ââ1 2
false
ââ3 8
,
ââ8 9
false
ââ: ?
,
ââ? @
false
ââA F
)
ââF G
;
ââG H

CargarTodo
ää 
(
ää 
)
ää  
;
ää  !
LIMPIARPANTALLA
ãã #
(
ãã# $
)
ãã$ %
;
ãã% &
}
åå 
else
çç 
{
éé 

MessageBox
èè 
.
èè 
Show
èè #
(
èè# $
$str
èè$ K
,
èèK L
$str
èèM T
,
èèT U
MessageBoxButtons
èèV g
.
èèg h
OK
èèh j
,
èèj k
MessageBoxIcon
èèl z
.
èèz {
Errorèè{ Ä
)èèÄ Å
;èèÅ Ç
}
êê 
}
ëë 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
ìì 

MessageBox
îî 
.
îî 
Show
îî 
(
îî  
$"
îî  "
$str
îî" F
"
îîF G
,
îîG H
$str
îîI P
,
îîP Q
MessageBoxButtons
îîR c
.
îîc d
OK
îîd f
,
îîf g
MessageBoxIcon
îîh v
.
îîv w
Error
îîw |
)
îî| }
;
îî} ~
}
ïï 
}
ññ 	
private
òò 
void
òò $
RegistrarPaciente_Load
òò +
(
òò+ ,
object
òò, 2
sender
òò3 9
,
òò9 :
	EventArgs
òò; D
e
òòE F
)
òòF G
{
ôô 	
}
õõ 	
}
úú 
}ùù Û 
rC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FrmRecetario.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
FrmRecetario %
:& '
Form( ,
{ 
private 
int 

codcliente 
; 
public 
FrmRecetario 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
ActivarCampos 
( 
true 
, 
false  %
,% &
false' ,
,, -
false. 3
,3 4
false5 :
,: ;
false< A
)A B
;B C
ActivarBotones 
( 
true 
,  
true  $
,$ %
false% *
,* +
false+ 0
,0 1
false1 6
,6 7
false7 <
)< =
;= >
CargarRecetario 
( 
) 
; 
} 	
public 
void 
ActivarCampos !
(! "
bool" &
d' (
,( )
bool* .
n/ 0
,0 1
bool1 5
a6 7
,7 8
bool9 =
i> ?
,? @
boolA E
fF G
,G H
boolI M
desN Q
)Q R
{ 	
txtDNI 
. 
Enabled 
= 
d 
; 
	txtNombre 
. 
Enabled 
= 
n  !
;! "
txtApellido 
. 
Enabled 
=  !
a" #
;# $
txtId 
. 
Enabled 
= 
i 
; 
	dtPicker1 
. 
Enabled 
= 
f  !
;! "
txtDescripcion   
.   
Enabled   "
=  # $
des  % (
;  ( )
}!! 	
public"" 
void"" 
ActivarBotones"" "
(""" #
bool""# '
b""( )
,"") *
bool""+ /
c""0 1
,""1 2
bool""3 7
ed""8 :
,"": ;
bool""< @
el""A C
,""C D
bool""E I
i""J K
,""K L
bool""M Q
r""R S
)""S T
{## 	
	btnBuscar$$ 
.$$ 
Enabled$$ 
=$$ 
b$$  !
;$$! "
btnCancelar%% 
.%% 
Enabled%% 
=%%  !
c%%" #
;%%# $

btnIniciar(( 
.(( 
Enabled(( 
=((  
i((! "
;((" #
btnRegistrar)) 
.)) 
Enabled))  
=))! "
r))# $
;))$ %
}** 	
public,, 
void,, 
LimpiarCampos,, !
(,,! "
),," #
{-- 	
txtDNI.. 
... 
Text.. 
=.. 
$str.. 
;.. 
	txtNombre// 
.// 
Text// 
=// 
$str// 
;//  
txtApellido00 
.00 
Text00 
=00 
$str00 !
;00! "
txtId11 
.11 
Text11 
=11 
$str11 
;11 
txtDescripcion22 
.22 
Text22 
=22  !
$str22" $
;22$ %
}33 	
private55 
void55 
btnBuscar_Click55 $
(55$ %
object55% +
sender55, 2
,552 3
	EventArgs554 =
e55> ?
)55? @
{66 	
MSOFTVETDataContext77 
dc77  "
=77# $
new77% (
MSOFTVETDataContext77) <
(77< =
)77= >
;77> ?
string99 
dniBusqueda99 
=99  
txtDNI99! '
.99' (
Text99( ,
;99, -
var;; 
clienteEncontrado;; !
=;;" #
dc;;$ &
.;;& '
	V_Cliente;;' 0
.;;0 1
FirstOrDefault;;1 ?
(;;? @
c;;@ A
=>;;B D
c;;E F
.;;F G
DNI;;G J
==;;K M
dniBusqueda;;N Y
);;Y Z
;;;Z [
if== 
(== 
clienteEncontrado== !
!===" $
null==% )
)==) *
{>> 

codcliente?? 
=?? 
clienteEncontrado?? .
.??. /
Cod_Cliente??/ :
;??: ;
varBB 
pacienteRegistradoBB &
=BB' (
dcBB) +
.BB+ ,

V_PacienteBB, 6
.BB6 7
AnyBB7 :
(BB: ;
pBB; <
=>BB= ?
pBB@ A
.BBA B
Cod_ClienteBBB M
==BBN P

codclienteBBQ [
)BB[ \
;BB\ ]
ifDD 
(DD 
pacienteRegistradoDD &
)DD& '
{EE 
	txtNombreFF 
.FF 
TextFF "
=FF# $
clienteEncontradoFF% 6
.FF6 7
NombreFF7 =
;FF= >
txtApellidoGG 
.GG  
TextGG  $
=GG% &
clienteEncontradoGG' 8
.GG8 9
ApellidoGG9 A
;GGA B
ActivarCamposHH !
(HH! "
falseHH" '
,HH' (
falseHH) .
,HH. /
falseHH0 5
,HH5 6
trueHH7 ;
,HH; <
falseHH= B
,HHB C
falseHHD I
)HHI J
;HHJ K
ActivarBotonesII "
(II" #
falseII# (
,II( )
trueII* .
,II. /
falseII0 5
,II5 6
falseII7 <
,II< =
trueII> B
,IIB C
falseIID I
)III J
;IIJ K 
CargarTablaPacientesJJ (
(JJ( )
)JJ) *
;JJ* +
}KK 
elseLL 
{MM 
ifNN 
(NN 

MessageBoxNN "
.NN" #
ShowNN# '
(NN' (
$strNN( j
,NNj k
$strNNl v
,NNv w
MessageBoxButtons	NNx â
.
NNâ ä
YesNo
NNä è
,
NNè ê
MessageBoxIcon
NNê û
.
NNû ü
Error
NNü §
)
NN§ •
==
NN¶ ®
DialogResult
NN© µ
.
NNµ ∂
Yes
NN∂ π
)
NNπ ∫
{OO 
}QQ 
elseRR 
{SS 
}UU 
}VV 
}WW 
elseXX 
{YY 
ifZZ 
(ZZ 

MessageBoxZZ 
.ZZ 
ShowZZ #
(ZZ# $
$strZZ$ R
,ZZR S
$strZZT ]
,ZZ] ^
MessageBoxButtonsZZ_ p
.ZZp q
YesNoZZq v
,ZZv w
MessageBoxIcon	ZZx Ü
.
ZZÜ á
Error
ZZá å
)
ZZå ç
==
ZZé ê
DialogResult
ZZë ù
.
ZZù û
Yes
ZZû °
)
ZZ° ¢
{[[ 
RegistrarCliente\\ $
registrarCliente\\% 5
=\\6 7
new\\8 ;
RegistrarCliente\\< L
(\\L M
)\\M N
;\\N O
this]] 
.]] 
Hide]] 
(]] 
)]] 
;]]  
registrarCliente^^ $
.^^$ %
Show^^% )
(^^) *
)^^* +
;^^+ ,
}__ 
else`` 
{aa 
}cc 
}dd 
}ee 	
privategg 
voidgg  
CargarTablaPacientesgg )
(gg) *
)gg* +
{hh 	
MSOFTVETDataContextii 
dcii  "
=ii# $
newii% (
MSOFTVETDataContextii) <
(ii< =
)ii= >
;ii> ?
varkk 
pacienteEncontradokk "
=kk# $
dckk% '
.kk' (

V_Pacientekk( 2
.kk2 3
Wherekk3 8
(kk8 9
ckk9 :
=>kk; =
ckk> ?
.kk? @
Cod_Clientekk@ K
==kkL N

codclientekkO Y
)kkY Z
.kkZ [
Selectkk[ a
(kka b
pkkb c
=>kkd f
newkkg j
{kkj k
Codkkk n
=kko p
pkkq r
.kkr s
Cod_Pacientekks 
,	kk Ä
p
kkÄ Å
.
kkÅ Ç
Nombre
kkÇ à
,
kkà â
p
kkä ã
.
kkã å
Especie
kkå ì
}
kkì î
)
kkî ï
.
kkï ñ
ToList
kkñ ú
(
kkú ù
)
kkù û
;
kkû ü
ifmm 
(mm 
pacienteEncontradomm "
!=mm# %
nullmm& *
)mm* +
{nn 
dgvPacienteoo 
.oo 

DataSourceoo &
=oo' (
pacienteEncontradooo) ;
;oo; <
dgvPacientepp 
.pp 
Columnspp #
[pp# $
$numpp$ %
]pp% &
.pp& '
Widthpp' ,
=pp- .
$numpp/ 1
;pp1 2
dgvPacienteqq 
.qq 
Columnsqq #
[qq# $
$numqq$ %
]qq% &
.qq& '
Widthqq' ,
=qq- .
$numqq/ 2
;qq2 3
dgvPacienterr 
.rr 
Columnsrr #
[rr# $
$numrr$ %
]rr% &
.rr& '
Widthrr' ,
=rr- .
$numrr/ 2
;rr2 3
ActivarCamposss 
(ss 
falsess #
,ss# $
falsess% *
,ss* +
falsess, 1
,ss1 2
truess3 7
,ss7 8
falsess9 >
,ss> ?
falsess@ E
)ssE F
;ssF G
}uu 
elsevv 
{ww 

MessageBoxxx 
.xx 
Showxx 
(xx  
$strxx  >
,xx> ?
$strxx@ I
,xxI J
MessageBoxButtonsxxK \
.xx\ ]
OKxx] _
,xx_ `
MessageBoxIconxxa o
.xxo p
Errorxxp u
)xxu v
;xxv w
}yy 
}zz 	
private|| 
void|| 
VerificarPacientes|| '
(||' (
)||( )
{}} 	
MSOFTVETDataContext~~ 
dc~~  "
=~~# $
new~~% (
MSOFTVETDataContext~~) <
(~~< =
)~~= >
;~~> ?
if
ÄÄ 
(
ÄÄ 
int
ÄÄ 
.
ÄÄ 
TryParse
ÄÄ 
(
ÄÄ 
txtId
ÄÄ "
.
ÄÄ" #
Text
ÄÄ# '
,
ÄÄ' (
out
ÄÄ) ,
int
ÄÄ- 0
	bpaciente
ÄÄ1 :
)
ÄÄ: ;
)
ÄÄ; <
{
ÅÅ 
var
ÇÇ  
pacienteEncontrado
ÇÇ &
=
ÇÇ' (
dc
ÇÇ) +
.
ÇÇ+ ,

V_Paciente
ÇÇ, 6
.
ÉÉ 
Where
ÉÉ 
(
ÉÉ 
c
ÉÉ 
=>
ÉÉ 
c
ÉÉ  !
.
ÉÉ! "
Cod_Cliente
ÉÉ" -
==
ÉÉ. 0

codcliente
ÉÉ1 ;
)
ÉÉ; <
.
ÑÑ 
FirstOrDefault
ÑÑ #
(
ÑÑ# $
p
ÑÑ$ %
=>
ÑÑ& (
p
ÑÑ) *
.
ÑÑ* +
Cod_Paciente
ÑÑ+ 7
==
ÑÑ8 :
	bpaciente
ÑÑ; D
)
ÑÑD E
;
ÑÑE F
if
ÜÜ 
(
ÜÜ  
pacienteEncontrado
ÜÜ &
!=
ÜÜ' )
null
ÜÜ* .
)
ÜÜ. /
{
áá 
ActivarCampos
àà !
(
àà! "
false
àà" '
,
àà' (
false
àà) .
,
àà. /
false
àà0 5
,
àà5 6
false
àà7 <
,
àà< =
true
àà> B
,
ààB C
true
ààD H
)
ààH I
;
ààI J
ActivarBotones
ââ "
(
ââ" #
false
ââ# (
,
ââ( )
true
ââ* .
,
ââ. /
false
ââ0 5
,
ââ5 6
false
ââ7 <
,
ââ< =
false
ââ> C
,
ââC D
true
ââE I
)
ââI J
;
ââJ K
}
ää 
else
ãã 
{
åå 

MessageBox
çç 
.
çç 
Show
çç #
(
çç# $
$str
çç$ @
,
çç@ A
$str
ççB K
,
ççK L
MessageBoxButtons
ççM ^
.
çç^ _
OK
çç_ a
,
çça b
MessageBoxIcon
ççc q
.
ççq r
Error
ççr w
)
ççw x
;
ççx y
}
éé 
}
èè 
else
êê 
{
ëë 

MessageBox
íí 
.
íí 
Show
íí 
(
íí  
$str
íí  C
,
ííC D
$str
ííE L
,
ííL M
MessageBoxButtons
ííN _
.
íí_ `
OK
íí` b
,
ííb c
MessageBoxIcon
ííd r
.
íír s
Error
íís x
)
ííx y
;
ííy z
}
ìì 
}
îî 	
private
ññ 
void
ññ !
RegistrarRecetacion
ññ (
(
ññ( )
)
ññ) *
{
óó 	!
MSOFTVETDataContext
òò 
dc
òò  "
=
òò# $
new
òò% (!
MSOFTVETDataContext
òò) <
(
òò< =
)
òò= >
;
òò> ?
int
ôô 
codPaciente
ôô 
=
ôô 
Convert
ôô %
.
ôô% &
ToInt32
ôô& -
(
ôô- .
txtId
ôô. 3
.
ôô3 4
Text
ôô4 8
)
ôô8 9
;
ôô9 :
if
úú 
(
úú 
!
úú 
string
úú 
.
úú 
IsNullOrEmpty
úú %
(
úú% &
txtDescripcion
úú& 4
.
úú4 5
Text
úú5 9
)
úú9 :
)
úú: ;
{
ùù 
try
ûû 
{
üü 
dc
†† 
.
†† #
SP_Agregar_Recetacion
†† ,
(
††, -
txtDescripcion
††- ;
.
††; <
Text
††< @
,
††@ A
	dtPicker1
††B K
.
††K L
Value
††L Q
,
††Q R
codPaciente
††S ^
)
††^ _
;
††_ `

MessageBox
°° 
.
°° 
Show
°° #
(
°°# $
$str
°°$ B
,
°°B C
$str
°°D K
,
°°K L
MessageBoxButtons
°°M ^
.
°°^ _
OK
°°_ a
,
°°a b
MessageBoxIcon
°°c q
.
°°q r
Information
°°r }
)
°°} ~
;
°°~ 
LimpiarCampos
¢¢ !
(
¢¢! "
)
¢¢" #
;
¢¢# $
ActivarBotones
££ "
(
££" #
true
££# '
,
££' (
true
££) -
,
££- .
false
££/ 4
,
££4 5
false
££6 ;
,
££; <
false
££= B
,
££B C
false
££D I
)
££I J
;
££J K
ActivarCampos
§§ !
(
§§! "
true
§§" &
,
§§& '
false
§§( -
,
§§- .
false
§§/ 4
,
§§4 5
false
§§6 ;
,
§§; <
false
§§= B
,
§§B C
false
§§D I
)
§§I J
;
§§J K
dgvPaciente
•• 
.
••  

DataSource
••  *
=
••+ ,
null
••- 1
;
••1 2
dgvPaciente
¶¶ 
.
¶¶  
Rows
¶¶  $
.
¶¶$ %
Clear
¶¶% *
(
¶¶* +
)
¶¶+ ,
;
¶¶, -
}
ßß 
catch
®® 
(
®® 
	Exception
®®  
ex
®®! #
)
®®# $
{
©© 

MessageBox
™™ 
.
™™ 
Show
™™ #
(
™™# $
$str
™™$ N
+
™™O P
ex
™™Q S
.
™™S T
Message
™™T [
,
™™[ \
$str
™™] d
,
™™d e
MessageBoxButtons
™™f w
.
™™w x
OK
™™x z
,
™™z {
MessageBoxIcon™™| ä
.™™ä ã
Error™™ã ê
)™™ê ë
;™™ë í
}
´´ 
}
¨¨ 
else
≠≠ 
{
ÆÆ 

MessageBox
ØØ 
.
ØØ 
Show
ØØ 
(
ØØ  
$str
ØØ  F
,
ØØF G
$str
ØØH O
,
ØØO P
MessageBoxButtons
ØØQ b
.
ØØb c
OK
ØØc e
,
ØØe f
MessageBoxIcon
ØØg u
.
ØØu v
Error
ØØv {
)
ØØ{ |
;
ØØ| }
}
∞∞ 
}
±± 	
private
≥≥ 
void
≥≥ 
btnIniciar_Click
≥≥ %
(
≥≥% &
object
≥≥& ,
sender
≥≥- 3
,
≥≥3 4
	EventArgs
≥≥5 >
e
≥≥? @
)
≥≥@ A
{
¥¥ 	 
VerificarPacientes
µµ 
(
µµ 
)
µµ  
;
µµ  !
}
∂∂ 	
private
∏∏ 
void
∏∏  
btnRegistrar_Click
∏∏ '
(
∏∏' (
object
∏∏( .
sender
∏∏/ 5
,
∏∏5 6
	EventArgs
∏∏7 @
e
∏∏A B
)
∏∏B C
{
ππ 	!
RegistrarRecetacion
∫∫ 
(
∫∫  
)
∫∫  !
;
∫∫! "
CargarRecetario
ªª 
(
ªª 
)
ªª 
;
ªª 
}
ºº 	
private
ææ 
void
ææ 
btnCancelar_Click
ææ &
(
ææ& '
object
ææ' -
sender
ææ. 4
,
ææ4 5
	EventArgs
ææ6 ?
e
ææ@ A
)
ææA B
{
øø 	
ActivarCampos
¿¿ 
(
¿¿ 
true
¿¿ 
,
¿¿ 
false
¿¿  %
,
¿¿% &
false
¿¿' ,
,
¿¿, -
false
¿¿. 3
,
¿¿3 4
false
¿¿5 :
,
¿¿: ;
false
¿¿< A
)
¿¿A B
;
¿¿B C
ActivarBotones
¡¡ 
(
¡¡ 
true
¡¡ 
,
¡¡  
true
¡¡! %
,
¡¡% &
false
¡¡' ,
,
¡¡, -
false
¡¡. 3
,
¡¡3 4
false
¡¡5 :
,
¡¡: ;
false
¡¡< A
)
¡¡A B
;
¡¡B C
dgvPaciente
¬¬ 
.
¬¬ 

DataSource
¬¬ "
=
¬¬# $
null
¬¬% )
;
¬¬) *
dgvPaciente
√√ 
.
√√ 
Rows
√√ 
.
√√ 
Clear
√√ "
(
√√" #
)
√√# $
;
√√$ %
LimpiarCampos
ƒƒ 
(
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
≈≈ 	
public
«« 
void
«« 
CargarRecetario
«« #
(
««# $
)
««$ %
{
»» 	
using
…… 
(
…… 
var
…… 
dc
…… 
=
…… 
new
…… !
MSOFTVETDataContext
……  3
(
……3 4
)
……4 5
)
……5 6
{
   
var
ÀÀ 
consulta
ÀÀ 
=
ÀÀ 
(
ÀÀ  
from
ÀÀ  $
x
ÀÀ% &
in
ÀÀ' )
dc
ÀÀ* ,
.
ÀÀ, -
V_Recetaciones
ÀÀ- ;
select
ÃÃ  &
new
ÃÃ' *
{
ÕÕ  !
ID
ŒŒ$ &
=
ŒŒ' (
x
ŒŒ) *
.
ŒŒ* +
id
ŒŒ+ -
,
ŒŒ- .
Descripcion
œœ$ /
=
œœ0 1
x
œœ2 3
.
œœ3 4 
Descripcion_Receta
œœ4 F
,
œœF G
Fecha
––$ )
=
––* +
x
––, -
.
––- .
Fecha_Receta
––. :
,
––: ;

IdPaciente
——$ .
=
——/ 0
x
——1 2
.
——2 3
cod_paciente
——3 ?
}
““  !
)
““! "
.
““" #
ToList
““# )
(
““) *
)
““* +
;
““+ ,
	dgvReceta
”” 
.
”” 

DataSource
”” $
=
””% &
consulta
””' /
;
””/ 0
	dgvReceta
‘‘ 
.
‘‘ 
Columns
‘‘ !
[
‘‘! "
$num
‘‘" #
]
‘‘# $
.
‘‘$ %
Width
‘‘% *
=
‘‘+ ,
$num
‘‘- /
;
‘‘/ 0
	dgvReceta
’’ 
.
’’ 
Columns
’’ !
[
’’! "
$num
’’" #
]
’’# $
.
’’$ %
Width
’’% *
=
’’+ ,
$num
’’- 0
;
’’0 1
	dgvReceta
÷÷ 
.
÷÷ 
Columns
÷÷ !
[
÷÷! "
$num
÷÷" #
]
÷÷# $
.
÷÷$ %
Width
÷÷% *
=
÷÷+ ,
$num
÷÷- 0
;
÷÷0 1
	dgvReceta
◊◊ 
.
◊◊ 
Columns
◊◊ !
[
◊◊! "
$num
◊◊" #
]
◊◊# $
.
◊◊$ %
Width
◊◊% *
=
◊◊+ ,
$num
◊◊- 0
;
◊◊0 1
}
ÿÿ 
}
ŸŸ 	
private
€€ 
void
€€ #
dgvPaciente_CellClick
€€ *
(
€€* +
object
€€+ 1
sender
€€2 8
,
€€8 9'
DataGridViewCellEventArgs
€€: S
e
€€T U
)
€€U V
{
‹‹ 	
if
›› 
(
›› 
e
›› 
.
›› 
RowIndex
›› 
>=
›› 
$num
›› 
&&
››  "
e
››# $
.
››$ %
RowIndex
››% -
<
››. /
dgvPaciente
››0 ;
.
››; <
Rows
››< @
.
››@ A
Count
››A F
)
››F G
{
ﬁﬁ 
DataGridViewRow
ﬂﬂ 
fila
ﬂﬂ  $
=
ﬂﬂ% &
dgvPaciente
ﬂﬂ' 2
.
ﬂﬂ2 3
Rows
ﬂﬂ3 7
[
ﬂﬂ7 8
e
ﬂﬂ8 9
.
ﬂﬂ9 :
RowIndex
ﬂﬂ: B
]
ﬂﬂB C
;
ﬂﬂC D
string
‚‚ 
codPaciente
‚‚ "
=
‚‚# $
fila
‚‚% )
.
‚‚) *
Cells
‚‚* /
[
‚‚/ 0
$num
‚‚0 1
]
‚‚1 2
.
‚‚2 3
Value
‚‚3 8
.
‚‚8 9
ToString
‚‚9 A
(
‚‚A B
)
‚‚B C
;
‚‚C D
txtId
ÂÂ 
.
ÂÂ 
Text
ÂÂ 
=
ÂÂ 
codPaciente
ÂÂ (
;
ÂÂ( )
}
ÊÊ 
}
ÁÁ 	
private
ÈÈ 
void
ÈÈ ,
comboBox1_SelectedIndexChanged
ÈÈ 3
(
ÈÈ3 4
object
ÈÈ4 :
sender
ÈÈ; A
,
ÈÈA B
	EventArgs
ÈÈC L
e
ÈÈM N
)
ÈÈN O
{
ÍÍ 	
string
ÎÎ 
opcionOrden
ÎÎ 
=
ÎÎ  

cmbOrdenar
ÎÎ! +
.
ÎÎ+ ,
SelectedItem
ÎÎ, 8
.
ÎÎ8 9
ToString
ÎÎ9 A
(
ÎÎA B
)
ÎÎB C
;
ÎÎC D
switch
ÌÌ 
(
ÌÌ 
opcionOrden
ÌÌ 
)
ÌÌ  
{
ÓÓ 
case
ÔÔ 
$str
ÔÔ 
:
ÔÔ  
CargarRecetario
 #
(
# $
)
$ %
;
% &
break
ÒÒ 
;
ÒÒ 
case
ÚÚ 
$str
ÚÚ !
:
ÚÚ! "
OrdenarRecetario
ÛÛ $
(
ÛÛ$ %
true
ÛÛ% )
)
ÛÛ) *
;
ÛÛ* +
break
ÙÙ 
;
ÙÙ 
case
ıı 
$str
ıı "
:
ıı" #
OrdenarRecetario
ˆˆ $
(
ˆˆ$ %
false
ˆˆ% *
)
ˆˆ* +
;
ˆˆ+ ,
break
˜˜ 
;
˜˜ 
}
¯¯ 
}
˘˘ 	
private
˚˚ 
void
˚˚ 
OrdenarRecetario
˚˚ %
(
˚˚% &
bool
˚˚& *

ascendente
˚˚+ 5
)
˚˚5 6
{
¸¸ 	
using
˝˝ 
(
˝˝ 
var
˝˝ 
dc
˝˝ 
=
˝˝ 
new
˝˝ !
MSOFTVETDataContext
˝˝  3
(
˝˝3 4
)
˝˝4 5
)
˝˝5 6
{
˛˛ 
var
ˇˇ 
consulta
ˇˇ 
=
ˇˇ 
(
ˇˇ  
from
ˇˇ  $
x
ˇˇ% &
in
ˇˇ' )
dc
ˇˇ* ,
.
ˇˇ, -
V_Recetaciones
ˇˇ- ;
orderby
ÄÄ  '
x
ÄÄ( )
.
ÄÄ) *
Fecha_Receta
ÄÄ* 6
	ascending
ÄÄ7 @
select
ÅÅ  &
new
ÅÅ' *
{
ÇÇ  !
ID
ÉÉ$ &
=
ÉÉ' (
x
ÉÉ) *
.
ÉÉ* +
id
ÉÉ+ -
,
ÉÉ- .
Descripcion
ÑÑ$ /
=
ÑÑ0 1
x
ÑÑ2 3
.
ÑÑ3 4 
Descripcion_Receta
ÑÑ4 F
,
ÑÑF G
Fecha
ÖÖ$ )
=
ÖÖ* +
x
ÖÖ, -
.
ÖÖ- .
Fecha_Receta
ÖÖ. :
,
ÖÖ: ;

IdPaciente
ÜÜ$ .
=
ÜÜ/ 0
x
ÜÜ1 2
.
ÜÜ2 3
cod_paciente
ÜÜ3 ?
}
áá  !
)
áá! "
.
áá" #
ToList
áá# )
(
áá) *
)
áá* +
;
áá+ ,
if
ââ 
(
ââ 
!
ââ 

ascendente
ââ 
)
ââ  
{
ää 
consulta
ãã 
.
ãã 
Reverse
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
}
åå 
	dgvReceta
çç 
.
çç 

DataSource
çç $
=
çç% &
null
çç' +
;
çç+ ,
	dgvReceta
éé 
.
éé 

DataSource
éé $
=
éé% &
consulta
éé' /
;
éé/ 0
	dgvReceta
èè 
.
èè 
Columns
èè !
[
èè! "
$num
èè" #
]
èè# $
.
èè$ %
Width
èè% *
=
èè+ ,
$num
èè- /
;
èè/ 0
	dgvReceta
êê 
.
êê 
Columns
êê !
[
êê! "
$num
êê" #
]
êê# $
.
êê$ %
Width
êê% *
=
êê+ ,
$num
êê- 0
;
êê0 1
	dgvReceta
ëë 
.
ëë 
Columns
ëë !
[
ëë! "
$num
ëë" #
]
ëë# $
.
ëë$ %
Width
ëë% *
=
ëë+ ,
$num
ëë- 0
;
ëë0 1
	dgvReceta
íí 
.
íí 
Columns
íí !
[
íí! "
$num
íí" #
]
íí# $
.
íí$ %
Width
íí% *
=
íí+ ,
$num
íí- 0
;
íí0 1
}
ìì 
}
îî 	
private
ññ 
void
ññ 
FrmRecetario_Load
ññ &
(
ññ& '
object
ññ' -
sender
ññ. 4
,
ññ4 5
	EventArgs
ññ6 ?
e
ññ@ A
)
ññA B
{
óó 	

cmbOrdenar
òò 
.
òò 
SelectedIndex
òò $
=
òò% &
$num
òò' (
;
òò( )
}
ôô 	
}
öö 
}õõ ó	
zC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormReporte_Clientes.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class  
FormReporte_Clientes -
:. /
Form0 4
{ 
public  
FormReporte_Clientes #
(# $
)$ %
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void %
FormReporte_Clientes_Load .
(. /
object/ 5
sender6 <
,< =
	EventArgs> G
eH I
)I J
{ 	
this 
. 
clienteTableAdapter $
.$ %
Fill% )
() *
this* .
.. /#
sOFTVETDataSet_Clientes/ F
.F G
ClienteG N
)N O
;O P
this 
. 
reportViewer1 
. 
RefreshReport ,
(, -
)- .
;. /
} 	
} 
} á	
yC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormReporte_Vacunas.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
FormReporte_Vacunas ,
:- .
Form/ 3
{ 
public 
FormReporte_Vacunas "
(" #
)# $
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void #
FormReporteVacunas_Load ,
(, -
object- 3
sender4 :
,: ;
	EventArgs< E
eF G
)G H
{ 	
this 
. 
vacunaTableAdapter #
.# $
Fill$ (
(( )
this) -
.- .
sOFTVETDataSet. <
.< =
Vacuna= C
)C D
;D E
this 
. 
reportViewer1 
. 
RefreshReport ,
(, -
)- .
;. /
} 	
} 
} øB
ÜC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormReporte_Paciente_DNI_Cliente.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class ,
 FormReporte_Paciente_DNI_Cliente 9
:: ;
Form< @
{ 
private 
string 
[ 
] 

myAdjuntos #
;# $
private 
CorreoManager 
correoManager +
;+ ,
string 
dni 
, 
	correocli 
, 

codcliente )
,) *

nomcliente* 4
,4 5

apecliente5 ?
;? @
public ,
 FormReporte_Paciente_DNI_Cliente /
(/ 0
)0 1
{ 	
InitializeComponent 
(  
)  !
;! "
correoManager 
= 
new 
CorreoManager  -
(- .
). /
;/ 0
} 	
private 
void 1
%FormReporte_Paciente_DNI_Cliente_Load :
(: ;
object; A
senderB H
,H I
	EventArgsJ S
eT U
)U V
{   	
}## 	
private&& 
void&& 
btnGenerar_Click&& %
(&&% &
object&&& ,
sender&&- 3
,&&3 4
	EventArgs&&5 >
e&&? @
)&&@ A
{'' 	
dni(( 
=(( 
txtDNI(( 
.(( 
Text(( 
;(( 
this** 
.** +
sP_PacientexClienteTableAdapter** 0
.**0 1
Fill**1 5
(**5 6
this**6 :
.**: ;(
sOFTVETDataSet_PacientesxDNI**; W
.**W X
SP_PacientexCliente**X k
,**k l
dni**m p
)**p q
;**q r
this,, 
.,, 
reportViewer1,, 
.,, 
RefreshReport,, ,
(,,, -
),,- .
;,,. /
this-- 
.-- 
reportViewer1-- 
.-- 
RefreshReport-- ,
(--, -
)--- .
;--. /

GrupoEnvio// 
.// 
Enabled// 
=//  
true//! %
;//% &
}11 	
private33 
void33 
btnSubir_Click33 #
(33# $
object33$ *
sender33+ 1
,331 2
	EventArgs333 <
e33= >
)33> ?
{44 	
AdjuntarArchivos55 
(55 
)55 
;55 
}66 	
private77 
void77 
CrearCuerpoCorreo77 &
(77& '
)77' (
{88 	
correoManager99 
.99 
CrearCuerpoCorreo99 +
(99+ ,
	correocli99, 5
,995 6
$str997 L
,99L M
$str99N U
+99U V

nomcliente99V `
+99` a
$str99a d
+99d e

apecliente99e o
+99o p
$str	99p ≠
,
99≠ Æ

myAdjuntos
99Ø π
)
99π ∫
;
99∫ ª
}:: 	
private<< 
void<< 
AdjuntarArchivos<< %
(<<% &
)<<& '
{== 	
var>> 
names>> 
=>> 
$str>> 
;>> 
OpenFileDialog?? 
ofd?? 
=??  
new??! $
OpenFileDialog??% 3
(??3 4
)??4 5
;??5 6
ofd@@ 
.@@ 
Multiselect@@ 
=@@ 
true@@ "
;@@" #
ofdAA 
.AA 
TitleAA 
=AA 
$strAA 5
;AA5 6
ifDD 
(DD 
ofdDD 
.DD 

ShowDialogDD 
(DD 
)DD  
==DD! #
DialogResultDD$ 0
.DD0 1
OKDD1 3
)DD3 4
{EE 

myAdjuntosFF 
=FF 
ofdFF  
.FF  !
	FileNamesFF! *
;FF* +
}GG 
forII 
(II 
intII 
iII 
=II 
$numII 
;II 
iII 
<II 

myAdjuntosII  *
.II* +
LengthII+ 1
;II1 2
iII3 4
++II4 6
)II6 7
{JJ 
namesKK 
+=KK 

myAdjuntosKK #
[KK# $
iKK$ %
]KK% &
+KK' (
$strKK) -
;KK- .
}LL 
lblFilesNN 
.NN 
TextNN 
=NN 
namesNN !
;NN! "
	btnEnviarOO 
.OO 
EnabledOO 
=OO 
trueOO  $
;OO$ %
}PP 	
privateQQ 
voidQQ 
EnviarQQ 
(QQ 
)QQ 
{RR 	
trySS 
{TT 
correoManagerUU 
.UU 
EnviarUU $
(UU$ %
)UU% &
;UU& '

MessageBoxVV 
.VV 
ShowVV 
(VV  
$strVV  )
,VV) *
$strVV* A
,VVA B
MessageBoxButtonsVVB S
.VVS T
OKVVT V
,VVV W
MessageBoxIconVVW e
.VVe f
InformationVVf q
)VVq r
;VVr s
lblFilesWW 
.WW 
TextWW 
=WW 
$strWW  "
;WW" #
	btnEnviarXX 
.XX 
EnabledXX !
=XX" #
falseXX$ )
;XX) *
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ  
{[[ 

MessageBox\\ 
.\\ 
Show\\ 
(\\  
ex\\  "
.\\" #
Message\\# *
)\\* +
;\\+ ,
}]] 
}^^ 	
privatebb 
voidbb 
button1_Clickbb "
(bb" #
objectbb# )
senderbb* 0
,bb0 1
	EventArgsbb2 ;
ebb< =
)bb= >
{cc 	
ifdd 
(dd 
!dd 
stringdd 
.dd 
IsNullOrEmptydd %
(dd% &
dnidd& )
)dd) *
)dd* +
{ee 
BuscarClientegg 
(gg 
dnigg !
)gg! "
;gg" #
}hh 
elseii 
{jj 

MessageBoxkk 
.kk 
Showkk 
(kk  
$strkk  B
,kkB C
$strkkD K
,kkK L
MessageBoxButtonskkM ^
.kk^ _
OKkk_ a
,kka b
MessageBoxIconkkc q
.kkq r
Errorkkr w
)kkw x
;kkx y
}ll 
CrearCuerpoCorreonn 
(nn 
)nn 
;nn  
Enviaroo 
(oo 
)oo 
;oo 
}qq 	
publicss 
voidss 
BuscarClientess !
(ss! "
stringss" (
dniss) ,
)ss, -
{tt 	
tryuu 
{vv 
usingww 
(ww 
varww 
dcww 
=ww 
newww  #
MSOFTVETDataContextww$ 7
(ww7 8
)ww8 9
)ww9 :
{xx 
varzz 
clienteEncontradozz )
=zz* +
dczz, .
.zz. /
SP_BuscarClientezz/ ?
(zz? @
dnizz@ C
)zzC D
.zzD E
FirstOrDefaultzzE S
(zzS T
)zzT U
;zzU V
if|| 
(|| 
clienteEncontrado|| )
!=||* ,
null||- 1
)||1 2
{}} 

codcliente "
=# $
clienteEncontrado% 6
.6 7
Cod_Cliente7 B
.B C
ToStringC K
(K L
)L M
;M N
	correocli
ÄÄ !
=
ÄÄ" #
clienteEncontrado
ÄÄ$ 5
.
ÄÄ5 6
Correo
ÄÄ6 <
;
ÄÄ< =

nomcliente
ÅÅ "
=
ÅÅ# $
clienteEncontrado
ÅÅ% 6
.
ÅÅ6 7
Nombre
ÅÅ7 =
;
ÅÅ= >

apecliente
ÇÇ "
=
ÇÇ# $
clienteEncontrado
ÇÇ% 6
.
ÇÇ6 7
Apellido
ÇÇ7 ?
;
ÇÇ? @

MessageBox
ÉÉ "
.
ÉÉ" #
Show
ÉÉ# '
(
ÉÉ' (
$str
ÉÉ( E
+
ÉÉF G
	correocli
ÉÉH Q
)
ÉÉQ R
;
ÉÉR S
}
ÑÑ 
}
ÖÖ 
}
ÜÜ 
catch
áá 
{
àà 
}
ää 
}
ãã 	
}
åå 
}çç –{
ÉC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormReporte_Historial_Clinico.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class )
FormReporte_Historial_Clinico 6
:7 8
Form9 =
{ 
private 
string 
[ 
] 

myAdjuntos #
;# $
private 
CorreoManager 
correoManager +
;+ ,
string 

nomcliente 
, 

apecliente &
,& '
	correocli' 0
;0 1
string 
id 
; 
ClsHclinica 
objHclinica 
=  !
new" %
ClsHclinica& 1
(1 2
)2 3
;3 4
string 
dni 
, 

codcliente 
, 

idpaciente  *
;* +
public )
FormReporte_Historial_Clinico ,
(, -
)- .
{ 	
InitializeComponent 
(  
)  !
;! "
correoManager 
= 
new 
CorreoManager  -
(- .
). /
;/ 0
} 	
private   
void   .
"FormReporte_Historial_Clinico_Load   7
(  7 8
object  8 >
sender  ? E
,  E F
	EventArgs  G P
e  Q R
)  R S
{!! 	
}## 	
public$$ 
void$$ 
GenerarReporte$$ "
($$" #
)$$# $
{%% 	
id&& 
=&& 

idpaciente&& 
;&& 
this(( 
.(( ,
 sP_HistorialClinicoTableAdapter1(( 1
.((1 2
Fill((2 6
(((6 7
this((7 ;
.((; <*
sOFTVETDataSet_HC_Cli_Paciente((< Z
.((Z [
SP_HistorialClinico(([ n
,((n o
id((p r
)((r s
;((s t
this)) 
.)) '
sPR_HvacunacionTableAdapter)) ,
.)), -
Fill))- 1
())1 2
this))2 6
.))6 7(
sOFTVETDataSet_HC_Vacunacion))7 S
.))S T
SPR_Hvacunacion))T c
,))c d
id))e g
)))g h
;))h i
this** 
.** '
sPR_HRecetacionTableAdapter** ,
.**, -
Fill**- 1
(**1 2
this**2 6
.**6 7'
sOFTVETDataSet_HC_RECETARIO**7 R
.**R S
SPR_HRecetacion**S b
,**b c
id**d f
)**f g
;**g h
this++ 
.++ ,
 sPR_HdesparacitacionTableAdapter++ 1
.++1 2
Fill++2 6
(++6 7
this++7 ;
.++; <-
!sOFTVETDataSet_HC_Desparasitacion++< ]
.++] ^ 
SPR_Hdesparacitacion++^ r
,++r s
id++t v
)++v w
;++w x
this,, 
.,, 
reportViewer1,, 
.,, 
RefreshReport,, ,
(,,, -
),,- .
;,,. /
}-- 	
private// 
void// 
btnGenerar_Click// %
(//% &
object//& ,
sender//- 3
,//3 4
	EventArgs//5 >
e//? @
)//@ A
{00 	
}33 	
private55 
void55 
btnBuscar_Click55 $
(55$ %
object55% +
sender55, 2
,552 3
	EventArgs554 =
e55> ?
)55? @
{66 	
dni77 
=77 
txtDNI77 
.77 
Text77 
;77 
if88 
(88 
!88 
string88 
.88 
IsNullOrEmpty88 %
(88% &
dni88& )
)88) *
)88* +
{99 
BuscarCliente;; 
(;; 
dni;; !
);;! "
;;;" #
}<< 
else== 
{>> 

MessageBox?? 
.?? 
Show?? 
(??  
$str??  B
,??B C
$str??D K
,??K L
MessageBoxButtons??M ^
.??^ _
OK??_ a
,??a b
MessageBoxIcon??c q
.??q r
Error??r w
)??w x
;??x y
}@@ 
}AA 	
privateCC 
voidCC "
dgvPacientes_CellClickCC +
(CC+ ,
objectCC, 2
senderCC3 9
,CC9 :%
DataGridViewCellEventArgsCC; T
eCCU V
)CCV W
{DD 	
ifEE 
(EE 
eEE 
.EE 
RowIndexEE 
>=EE 
$numEE 
)EE  
{FF 
DataGridViewRowGG 
selectedRowGG  +
=GG, -
dgvPacientesGG. :
.GG: ;
RowsGG; ?
[GG? @
eGG@ A
.GGA B
RowIndexGGB J
]GGJ K
;GGK L

idpacienteHH 
=HH 
selectedRowHH (
.HH( )
CellsHH) .
[HH. /
$numHH/ 0
]HH0 1
.HH1 2
ValueHH2 7
?HH7 8
.HH8 9
ToStringHH9 A
(HHA B
)HHB C
;HHC D
objHclinicaII 
.II 

idpacienteII &
=II' (
ConvertII) 0
.II0 1
ToInt32II1 8
(II8 9

idpacienteII9 C
)IIC D
;IID E
GenerarReporteJJ 
(JJ 
)JJ  
;JJ  !

GrupoEnvioKK 
.KK 
EnabledKK "
=KK# $
trueKK% )
;KK) *
}LL 
elseMM 
{NN 

MessageBoxOO 
.OO 
ShowOO 
(OO  
$strOO  3
,OO3 4
$strOO5 <
)OO< =
;OO= >
}PP 
}RR 	
privateTT 
voidTT 
btnSubir_ClickTT #
(TT# $
objectTT$ *
senderTT+ 1
,TT1 2
	EventArgsTT3 <
eTT= >
)TT> ?
{UU 	
AdjuntarArchivosVV 
(VV 
)VV 
;VV 
}WW 	
privateXX 
voidXX 
CrearCuerpoCorreoXX &
(XX& '
)XX' (
{YY 	
correoManagerZZ 
.ZZ 
CrearCuerpoCorreoZZ +
(ZZ+ ,
	correocliZZ, 5
,ZZ5 6
$strZZ7 L
,ZZL M
$strZZN U
+ZZV W

nomclienteZZX b
+ZZc d
$strZZe h
+ZZi j

apeclienteZZk u
+ZZv w
$str	ZZx µ
,
ZZµ ∂

myAdjuntos
ZZ∑ ¡
)
ZZ¡ ¬
;
ZZ¬ √
}[[ 	
private]] 
void]] 
btnEnviar_Click]] $
(]]$ %
object]]% +
sender]], 2
,]]2 3
	EventArgs]]4 =
e]]> ?
)]]? @
{^^ 	
if__ 
(__ 
!__ 
string__ 
.__ 
IsNullOrEmpty__ )
(__) *
dni__* -
)__- .
)__. /
{`` 
BuscarClientebb !
(bb! "
dnibb" %
)bb% &
;bb& '
}cc 
elsedd 
{ee 

MessageBoxff 
.ff 
Showff #
(ff# $
$strff$ F
,ffF G
$strffH O
,ffO P
MessageBoxButtonsffQ b
.ffb c
OKffc e
,ffe f
MessageBoxIconffg u
.ffu v
Errorffv {
)ff{ |
;ff| }
}gg 
CrearCuerpoCorreoii !
(ii! "
)ii" #
;ii# $
Enviarjj 
(jj 
)jj 
;jj 
}kk 	
privatemm 
voidmm 
AdjuntarArchivosmm %
(mm% &
)mm& '
{nn 	
varoo 
namesoo 
=oo 
$stroo 
;oo 
OpenFileDialogpp 
ofdpp 
=pp  
newpp! $
OpenFileDialogpp% 3
(pp3 4
)pp4 5
;pp5 6
ofdqq 
.qq 
Multiselectqq 
=qq 
trueqq "
;qq" #
ofdrr 
.rr 
Titlerr 
=rr 
$strrr 5
;rr5 6
ofdss 
.ss 
InitialDirectoryss  
=ss! "
$strss# 1
;ss1 2
ifuu 
(uu 
ofduu 
.uu 

ShowDialoguu 
(uu 
)uu  
==uu! #
DialogResultuu$ 0
.uu0 1
OKuu1 3
)uu3 4
{vv 

myAdjuntosww 
=ww 
ofdww  
.ww  !
	FileNamesww! *
;ww* +
}xx 
forzz 
(zz 
intzz 
izz 
=zz 
$numzz 
;zz 
izz 
<zz 

myAdjuntoszz  *
.zz* +
Lengthzz+ 1
;zz1 2
izz3 4
++zz4 6
)zz6 7
{{{ 
names|| 
+=|| 

myAdjuntos|| #
[||# $
i||$ %
]||% &
+||' (
$str||) -
;||- .
}}} 
lblFiles 
. 
Text 
= 
names !
;! "
	btnEnviar
ÄÄ 
.
ÄÄ 
Enabled
ÄÄ 
=
ÄÄ 
true
ÄÄ  $
;
ÄÄ$ %
}
ÅÅ 	
private
ÇÇ 
void
ÇÇ 
Enviar
ÇÇ 
(
ÇÇ 
)
ÇÇ 
{
ÉÉ 	
try
ÑÑ 
{
ÖÖ 
correoManager
ÜÜ 
.
ÜÜ 
Enviar
ÜÜ $
(
ÜÜ$ %
)
ÜÜ% &
;
ÜÜ& '

MessageBox
áá 
.
áá 
Show
áá 
(
áá  
$str
áá  -
+
áá- .
	correocli
áá/ 8
,
áá8 9
$str
áá: Q
,
ááQ R
MessageBoxButtons
ááS d
.
áád e
OK
ááe g
,
áág h
MessageBoxIcon
áái w
.
ááw x
Informationááx É
)ááÉ Ñ
;ááÑ Ö
lblFiles
àà 
.
àà 
Text
àà 
=
àà 
$str
àà  "
;
àà" #
	btnEnviar
ââ 
.
ââ 
Enabled
ââ !
=
ââ" #
false
ââ$ )
;
ââ) *
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
åå 

MessageBox
çç 
.
çç 
Show
çç 
(
çç  
ex
çç  "
.
çç" #
Message
çç# *
)
çç* +
;
çç+ ,
}
éé 
}
èè 	
public
íí 
void
íí 
BuscarCliente
íí !
(
íí! "
string
íí" (
dni
íí) ,
)
íí, -
{
ìì 	
try
îî 
{
ïï 
using
ññ 
(
ññ 
var
ññ 
dc
ññ 
=
ññ 
new
ññ  #!
MSOFTVETDataContext
ññ$ 7
(
ññ7 8
)
ññ8 9
)
ññ9 :
{
óó 
var
ôô 
clienteEncontrado
ôô )
=
ôô* +
dc
ôô, .
.
ôô. /
SP_BuscarCliente
ôô/ ?
(
ôô? @
dni
ôô@ C
)
ôôC D
.
ôôD E
FirstOrDefault
ôôE S
(
ôôS T
)
ôôT U
;
ôôU V
if
õõ 
(
õõ 
clienteEncontrado
õõ )
!=
õõ* ,
null
õõ- 1
)
õõ1 2
{
úú 

codcliente
ûû "
=
ûû# $
clienteEncontrado
ûû% 6
.
ûû6 7
Cod_Cliente
ûû7 B
.
ûûB C
ToString
ûûC K
(
ûûK L
)
ûûL M
;
ûûM N
txtNombreCliente
üü (
.
üü( )
Text
üü) -
=
üü. /
clienteEncontrado
üü0 A
.
üüA B
Nombre
üüB H
;
üüH I

nomcliente
†† "
=
††" #
clienteEncontrado
††$ 5
.
††5 6
Nombre
††6 <
;
††< =
	correocli
°° !
=
°°" #
clienteEncontrado
°°$ 5
.
°°5 6
Correo
°°6 <
;
°°< =

apecliente
¢¢ "
=
¢¢" #
clienteEncontrado
¢¢$ 5
.
¢¢5 6
Apellido
¢¢6 >
;
¢¢> ?
CargarPaciente
££ &
(
££& '

codcliente
££' 1
)
££1 2
;
££2 3
}
§§ 
else
•• 
{
¶¶ 

MessageBox
ßß "
.
ßß" #
Show
ßß# '
(
ßß' (
$str
ßß( @
,
ßß@ A
$str
ßßB O
,
ßßO P
MessageBoxButtons
ßßQ b
.
ßßb c
OK
ßßc e
,
ßße f
MessageBoxIcon
ßßg u
.
ßßu v
Informationßßv Å
)ßßÅ Ç
;ßßÇ É
}
≠≠ 
}
ÆÆ 
}
ØØ 
catch
∞∞ 
(
∞∞ 
	Exception
∞∞ 
ex
∞∞ 
)
∞∞  
{
±± 

MessageBox
≤≤ 
.
≤≤ 
Show
≤≤ 
(
≤≤  
$"
≤≤  "
$str
≤≤" ;
{
≤≤; <
ex
≤≤< >
.
≤≤> ?
Message
≤≤? F
}
≤≤F G
"
≤≤G H
,
≤≤H I
$str
≤≤J Q
,
≤≤Q R
MessageBoxButtons
≤≤S d
.
≤≤d e
OK
≤≤e g
,
≤≤g h
MessageBoxIcon
≤≤i w
.
≤≤w x
Error
≤≤x }
)
≤≤} ~
;
≤≤~ 
}
≥≥ 
}
¥¥ 	
public
µµ 
void
µµ 
CargarPaciente
µµ "
(
µµ" #
string
µµ# )
codcl
µµ* /
)
µµ/ 0
{
∂∂ 	!
MSOFTVETDataContext
∏∏ 
dc
∏∏  "
=
∏∏# $
new
∏∏% (!
MSOFTVETDataContext
∏∏) <
(
∏∏< =
)
∏∏= >
;
∏∏> ?
var
ππ 
	pacientes
ππ 
=
ππ 
dc
ππ 
.
ππ 

V_Paciente
ππ )
.
ππ) *
Where
ππ* /
(
ππ/ 0
p
ππ0 1
=>
ππ2 4
p
ππ5 6
.
ππ6 7
Cod_Cliente
ππ7 B
.
ππB C
ToString
ππC K
(
ππK L
)
ππL M
==
ππN P
codcl
ππQ V
)
ππV W
.
ππW X
ToList
ππX ^
(
ππ^ _
)
ππ_ `
;
ππ` a
if
∫∫ 
(
∫∫ 
	pacientes
∫∫ 
.
∫∫ 
Any
∫∫ 
(
∫∫ 
)
∫∫ 
)
∫∫  
{
ªª 
dgvPacientes
ºº 
.
ºº 
Rows
ºº !
.
ºº! "
Clear
ºº" '
(
ºº' (
)
ºº( )
;
ºº) *
foreach
ææ 
(
ææ 
var
ææ 
paciente
ææ %
in
ææ& (
	pacientes
ææ) 2
)
ææ2 3
{
øø 
string
¿¿ 
codpaciente
¿¿ &
=
¿¿' (
paciente
¿¿) 1
.
¿¿1 2
Cod_Paciente
¿¿2 >
.
¿¿> ?
ToString
¿¿? G
(
¿¿G H
)
¿¿H I
;
¿¿I J
string
¡¡ 
nombrepaciente
¡¡ )
=
¡¡* +
paciente
¡¡, 4
.
¡¡4 5
Nombre
¡¡5 ;
;
¡¡; <
dgvPacientes
¬¬  
.
¬¬  !
Rows
¬¬! %
.
¬¬% &
Add
¬¬& )
(
¬¬) *
codpaciente
¬¬* 5
,
¬¬5 6
nombrepaciente
¬¬7 E
)
¬¬E F
;
¬¬F G
}
√√ 
}
ƒƒ 
else
≈≈ 
{
∆∆ 

MessageBox
«« 
.
«« 
Show
«« 
(
««  
$str
««  o
,
««o p
$str««q É
,««É Ñ!
MessageBoxButtons««Ö ñ
.««ñ ó
OK««ó ô
,««ô ö
MessageBoxIcon««õ ©
.««© ™
Warning««™ ±
)««± ≤
;««≤ ≥
}
»» 
}
   	
}
ÀÀ 
}ÃÃ Â

áC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormReporte_Estadistica_Pacientes.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class -
!FormReporte_Estadistica_Pacientes :
:; <
Form= A
{ 
public -
!FormReporte_Estadistica_Pacientes 0
(0 1
)1 2
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 2
&FormReporte_Estadistica_Pacientes_Load ;
(; <
object< B
senderC I
,I J
	EventArgsK T
eU V
)V W
{ 	
this 
.  
pacienteTableAdapter %
.% &
Fill& *
(* +
this+ /
./ 0'
sOFTVETDataSet_Est_Paciente0 K
.K L
PacienteL T
)T U
;U V
this 
. 
reportViewer1 
. 
RefreshReport ,
(, -
)- .
;. /
this 
. 
reportViewer1 
. 
RefreshReport ,
(, -
)- .
;. /
} 	
} 
} øp
}C:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormRegistrarVacunacion.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class #
FormRegistrarVacunacion 0
:1 2
Form3 7
{ 
	ClsVacuna 
objVacunacion 
=  !
new" %
	ClsVacuna& /
(/ 0
)0 1
;1 2
private 
string 
dni 
, 
nombre "
;" #
private 
string 
cod_cliente "
;" #
private 
string 

id_cliente !
;! "
private 
string 
id_paciente "
," #
	id_vacuna$ -
,- .
	nro_dosis/ 8
;8 9
DateTime 
fecha 
; 
public #
FormRegistrarVacunacion &
(& '
)' (
{ 	
InitializeComponent 
(  
)  !
;! "
Listar 
( 
) 
; 
ActivarBotones 
( 
true 
,  
false! &
,& '
false( -
)- .
;. /
DesactivarCampos 
( 
) 
; 
}   	
public!! 
void!! 
Cargar_Cliente!! "
(!!" #
)!!# $
{"" 	
objVacunacion## 
.## 
CargarCliente## '
(##' (
txtDNI##( .
,##. /
txtNombreCliente##0 @
,##@ A
txtCod_Cliente##B P
)##P Q
;##Q R
if$$ 
($$ 
txtNombreCliente$$  
.$$  !
Text$$! %
!=$$& (
$str$$) @
)$$@ A
{%% 
groupBoxVacunacion&& "
.&&" #
Enabled&&# *
=&&+ ,
true&&- 1
;&&1 2
Cargar_Mascota'' 
('' 
)''  
;''  !
CargarVacunas(( 
((( 
)(( 
;((  
Listar)) 
()) 
))) 
;)) 
}++ 
}-- 	
public// 
void// 
Cargar_Mascota// "
(//" #
)//# $
{00 	
objVacunacion11 
.11 
CargarMascota11 '
(11' (
dgvPacientes11( 4
)114 5
;115 6
}33 	
private55 
void55 
btnBuscar_Click55 $
(55$ %
object55% +
sender55, 2
,552 3
	EventArgs554 =
e55> ?
)55? @
{66 	
Cargar_Cliente77 
(77 
)77 
;77 
};; 	
public<< 
void<< 
ActivarBotones<< "
(<<" #
bool<<# '
n<<( )
,<<) *
bool<<+ /
a<<0 1
,<<1 2
bool<<3 7
c<<8 9
)<<9 :
{== 	
btnNuevo>> 
.>> 
Enabled>> 
=>> 
n>>  
;>>  !

btnAgregar?? 
.?? 
Enabled?? 
=??  
a??! "
;??" #
btnCancelar@@ 
.@@ 
Enabled@@ 
=@@  !
c@@" #
;@@# $
}AA 	
publicBB 
voidBB 
ActivarCamposBB !
(BB! "
)BB" #
{CC 	
txtidVacunacionDD 
.DD 
EnabledDD #
=DD$ %
falseDD& +
;DD+ ,
txtIDPacienteEE 
.EE 
EnabledEE !
=EE" #
trueEE$ (
;EE( )
txtIDVacunaFF 
.FF 
EnabledFF 
=FF  !
trueFF" &
;FF& '
txtNroDosisGG 
.GG 
EnabledGG 
=GG  !
trueGG" &
;GG& '
datePickVacunacionHH 
.HH 
EnabledHH &
=HH' (
trueHH) -
;HH- .
}II 	
publicJJ 
voidJJ 
DesactivarCamposJJ $
(JJ$ %
)JJ% &
{KK 	
txtidVacunacionLL 
.LL 
EnabledLL #
=LL$ %
falseLL& +
;LL+ ,
txtIDPacienteMM 
.MM 
EnabledMM !
=MM" #
falseMM$ )
;MM) *
txtIDVacunaNN 
.NN 
EnabledNN 
=NN  !
falseNN" '
;NN' (
txtNroDosisOO 
.OO 
EnabledOO 
=OO  !
falseOO" '
;OO' (
datePickVacunacionPP 
.PP 
EnabledPP &
=PP' (
falsePP) .
;PP. /
}QQ 	
publicRR 
voidRR 
LimpiarRR 
(RR 
)RR 
{SS 	
txtidVacunacionTT 
.TT 
TextTT  
=TT! "
$strTT# %
;TT% &
txtIDPacienteUU 
.UU 
TextUU 
=UU  
$strUU! #
;UU# $
txtIDVacunaVV 
.VV 
TextVV 
=VV 
$strVV !
;VV! "
txtNroDosisWW 
.WW 
TextWW 
=WW 
$strWW !
;WW! "
datePickVacunacionXX 
.XX 
TextXX #
=XX$ %
$strXX& (
;XX( )
txtDNIYY 
.YY 
TextYY 
=YY 
$strYY 
;YY 
txtNombreClienteZZ 
.ZZ 
TextZZ !
=ZZ" #
$strZZ$ &
;ZZ& '
txtCod_Cliente[[ 
.[[ 
Text[[ 
=[[  !
$str[[" $
;[[$ %
cod_cliente\\ 
=\\ 
$str\\ 
;\\ 
}^^ 	
public__ 
void__ 
AgregarVacunacion__ %
(__% &
)__& '
{`` 	
objVacunacionaa 
.aa 
Insertar_Vacunacionaa -
(aa- .
txtIDPacienteaa. ;
,aa; <
txtIDVacunaaa= H
,aaH I
txtNroDosisaaJ U
,aaU V
datePickVacunacionaaW i
)aai j
;aaj k
}bb 	
publicdd 
voiddd 
EliminarVacunaciondd &
(dd& '
)dd' (
{ee 	
ifff 
(ff 
txtidVacunacionff 
.ff  
Textff  $
!=ff% '
$strff( *
)ff* +
{gg 
	ClsVacunahh 
objVacunantehh &
=hh' (
newhh) ,
	ClsVacunahh- 6
(hh6 7
)hh7 8
;hh8 9
objVacunantekk 
.kk 
Eliminar_Vacunacionkk 0
(kk0 1
Convertkk1 8
.kk8 9
ToInt32kk9 @
(kk@ A
txtidVacunacionkkA P
.kkP Q
TextkkQ U
)kkU V
)kkV W
;kkW X
}nn 
}oo 	
publicrr 
voidrr 
Listarrr 
(rr 
)rr 
{ss 	
objVacunaciontt 
.tt 
ListarVacunadostt )
(tt) *
dgvVacunadostt* 6
)tt6 7
;tt7 8
dgvVacunadosuu 
.uu 
Columnsuu  
[uu  !
$numuu! "
]uu" #
.uu# $
Widthuu$ )
=uu* +
$numuu, .
;uu. /
dgvVacunadosvv 
.vv 
Columnsvv  
[vv  !
$numvv! "
]vv" #
.vv# $
Widthvv$ )
=vv* +
$numvv, .
;vv. /
}xx 	
privatezz 
voidzz "
dgvPacientes_CellClickzz +
(zz+ ,
objectzz, 2
senderzz3 9
,zz9 :%
DataGridViewCellEventArgszz; T
ezzU V
)zzV W
{{{ 	
if}} 
(}} 
e}} 
.}} 
RowIndex}} 
>=}} 
$num}} 
&&}}  "
e}}# $
.}}$ %
ColumnIndex}}% 0
>=}}1 3
$num}}4 5
)}}5 6
{~~ 
object
ÄÄ 

idPaciente
ÄÄ !
=
ÄÄ" #
dgvPacientes
ÄÄ$ 0
.
ÄÄ0 1
Rows
ÄÄ1 5
[
ÄÄ5 6
e
ÄÄ6 7
.
ÄÄ7 8
RowIndex
ÄÄ8 @
]
ÄÄ@ A
.
ÄÄA B
Cells
ÄÄB G
[
ÄÄG H
$str
ÄÄH L
]
ÄÄL M
.
ÄÄM N
Value
ÄÄN S
;
ÄÄS T
txtIDPaciente
ÉÉ 
.
ÉÉ 
Text
ÉÉ "
=
ÉÉ# $

idPaciente
ÉÉ% /
.
ÉÉ/ 0
ToString
ÉÉ0 8
(
ÉÉ8 9
)
ÉÉ9 :
;
ÉÉ: ;
}
ÑÑ 
}
ÖÖ 	
private
àà 
void
àà $
dgvVacunados_CellClick
àà +
(
àà+ ,
object
àà, 2
sender
àà3 9
,
àà9 :'
DataGridViewCellEventArgs
àà; T
e
ààU V
)
ààV W
{
ââ 	
}
ùù 	
private
ûû 
void
ûû 
btnAgregar_Click
ûû %
(
ûû% &
object
ûû& ,
sender
ûû- 3
,
ûû3 4
	EventArgs
ûû5 >
e
ûû? @
)
ûû@ A
{
üü 	
AgregarVacunacion
†† 
(
†† 
)
†† 
;
††  
ActivarBotones
°° 
(
°° 
true
°° 
,
°°  
true
°°! %
,
°°% &
true
°°' +
)
°°+ ,
;
°°, -
DesactivarCampos
¢¢ 
(
¢¢ 
)
¢¢ 
;
¢¢ 
Listar
££ 
(
££ 
)
££ 
;
££ 
CargarVacunas
§§ 
(
§§ 
)
§§ 
;
§§ 
}
¶¶ 	
private
®® 
void
®® 
btnEliminar_Click
®® &
(
®®& '
object
®®' -
sender
®®. 4
,
®®4 5
	EventArgs
®®6 ?
e
®®@ A
)
®®A B
{
©© 	 
EliminarVacunacion
™™ 
(
™™ 
)
™™  
;
™™  !
Listar
´´ 
(
´´ 
)
´´ 
;
´´ 
ActivarBotones
¨¨ 
(
¨¨ 
true
¨¨ 
,
¨¨  
true
¨¨! %
,
¨¨% &
true
¨¨' +
)
¨¨+ ,
;
¨¨, -
Limpiar
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
DesactivarCampos
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
CargarVacunas
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 	
private
≤≤ 
void
≤≤ 
btnNuevo_Click_1
≤≤ %
(
≤≤% &
object
≤≤& ,
sender
≤≤- 3
,
≤≤3 4
	EventArgs
≤≤5 >
e
≤≤? @
)
≤≤@ A
{
≥≥ 	
ActivarBotones
µµ 
(
µµ 
false
µµ  
,
µµ  !
true
µµ" &
,
µµ& '
true
µµ( ,
)
µµ, -
;
µµ- .
ActivarCampos
∂∂ 
(
∂∂ 
)
∂∂ 
;
∂∂ 
Listar
∑∑ 
(
∑∑ 
)
∑∑ 
;
∑∑ 
groupBoxCliente
∏∏ 
.
∏∏ 
Enabled
∏∏ #
=
∏∏$ %
true
∏∏& *
;
∏∏* +
CargarVacunas
ππ 
(
ππ 
)
ππ 
;
ππ 
}
ªª 	
private
ΩΩ 
void
ΩΩ 
btnCancelar_Click
ΩΩ &
(
ΩΩ& '
object
ΩΩ' -
sender
ΩΩ. 4
,
ΩΩ4 5
	EventArgs
ΩΩ6 ?
e
ΩΩ@ A
)
ΩΩA B
{
ææ 	
Limpiar
øø 
(
øø 
)
øø 
;
øø 
ActivarBotones
¿¿ 
(
¿¿ 
true
¿¿ 
,
¿¿  
false
¿¿! &
,
¿¿& '
true
¿¿( ,
)
¿¿, -
;
¿¿- .
DesactivarCampos
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡ 
dgvPacientes
¬¬ 
.
¬¬ 
Columns
¬¬  
.
¬¬  !
Clear
¬¬! &
(
¬¬& '
)
¬¬' (
;
¬¬( )
dgvTotalStock
√√ 
.
√√ 
Columns
√√ !
.
√√! "
Clear
√√" '
(
√√' (
)
√√( )
;
√√) *
}
∆∆ 	
private
»» 
void
»» %
dgvTotalStock_CellClick
»» ,
(
»», -
object
»»- 3
sender
»»4 :
,
»»: ;'
DataGridViewCellEventArgs
»»< U
e
»»V W
)
»»W X
{
…… 	
if
ÀÀ 
(
ÀÀ 
e
ÀÀ 
.
ÀÀ 
RowIndex
ÀÀ 
>=
ÀÀ 
$num
ÀÀ 
&&
ÀÀ  "
e
ÀÀ# $
.
ÀÀ$ %
ColumnIndex
ÀÀ% 0
>=
ÀÀ1 3
$num
ÀÀ4 5
)
ÀÀ5 6
{
ÃÃ 
object
ŒŒ 
idVacuna
ŒŒ 
=
ŒŒ  !
dgvTotalStock
ŒŒ" /
.
ŒŒ/ 0
Rows
ŒŒ0 4
[
ŒŒ4 5
e
ŒŒ5 6
.
ŒŒ6 7
RowIndex
ŒŒ7 ?
]
ŒŒ? @
.
ŒŒ@ A
Cells
ŒŒA F
[
ŒŒF G
$str
ŒŒG R
]
ŒŒR S
.
ŒŒS T
Value
ŒŒT Y
;
ŒŒY Z
txtIDVacuna
—— 
.
—— 
Text
——  
=
——! "
idVacuna
——# +
.
——+ ,
ToString
——, 4
(
——4 5
)
——5 6
;
——6 7
}
““ 
}
”” 	
public
’’ 
void
’’ 
CargarVacunas
’’ !
(
’’! "
)
’’" #
{
÷÷ 	
objVacunacion
◊◊ 
.
◊◊ 
ListarTotalStock
◊◊ *
(
◊◊* +
dgvTotalStock
◊◊+ 8
)
◊◊8 9
;
◊◊9 :
dgvTotalStock
ÿÿ 
.
ÿÿ 
Columns
ÿÿ !
[
ÿÿ! "
$num
ÿÿ" #
]
ÿÿ# $
.
ÿÿ$ %
Width
ÿÿ% *
=
ÿÿ+ ,
$num
ÿÿ- /
;
ÿÿ/ 0
}
ŸŸ 	
private
⁄⁄ 
void
⁄⁄ 
btnVacunas_Click
⁄⁄ %
(
⁄⁄% &
object
⁄⁄& ,
sender
⁄⁄- 3
,
⁄⁄3 4
	EventArgs
⁄⁄5 >
e
⁄⁄? @
)
⁄⁄@ A
{
€€ 	
}
›› 	
private
ﬂﬂ 
void
ﬂﬂ *
FormRegistrarVacunacion_Load
ﬂﬂ 1
(
ﬂﬂ1 2
object
ﬂﬂ2 8
sender
ﬂﬂ9 ?
,
ﬂﬂ? @
	EventArgs
ﬂﬂA J
e
ﬂﬂK L
)
ﬂﬂL M
{
‡‡ 	
}
‚‚ 	
}
„„ 
}‰‰ ÙÅ
ÇC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormRegistrarDesparasitacion.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class (
FormRegistrarDesparasitacion 5
:6 7
Form8 <
{ 
ClsDesparasitante 
objDesparasitante +
=, -
new. 1
ClsDesparasitante2 C
(C D
)D E
;E F
public (
FormRegistrarDesparasitacion +
(+ ,
), -
{ 	
InitializeComponent 
(  
)  !
;! "
CargarComboTipo 
( 
) 
; 
Listar 
( 
) 
; 
ActivarBotones 
( 
true 
,  
true! %
,% &
false' ,
,, -
false. 3
,3 4
true5 9
)9 :
;: ;
} 	
public 
void 
CargarComboTipo #
(# $
)$ %
{ 	
cmbTipo 
. 
Items 
. 
Clear 
(  
)  !
;! "
cmbTipo 
. 
Items 
. 
Add 
( 
$str ;
); <
;< =
cmbTipo 
. 
Items 
. 
Add 
( 
$str *
)* +
;+ ,
} 	
public!! 
void!! 
Cargar_Cliente!! "
(!!" #
)!!# $
{"" 	
objDesparasitante## 
.## 
CargarCliente## +
(##+ ,
txtDNI##, 2
,##2 3
txtNombreCliente##4 D
,##D E
txtCod_Cliente##F T
)##T U
;##U V
if$$ 
($$ 
txtNombreCliente$$  
.$$  !
Text$$! %
!=$$& (
$str$$) @
)$$@ A$
GroupBox_Desparasitacion%% (
.%%( )
Enabled%%) 0
=%%1 2
true%%3 7
;%%7 8
}&& 	
public(( 
void(( 
Cargar_Mascota(( "
(((" #
)((# $
{)) 	
objDesparasitante** 
.** 
CargarMascota** +
(**+ ,
dgvPacientes**, 8
)**8 9
;**9 :
},, 	
public.. 
void.. !
AgregarDesparasitante.. )
(..) *
)..* +
{// 	
objDesparasitante00 
.00 
Insertar00 &
(00& '
cmbTipo00' .
,00. /#
datePickDesparasitacion000 G
,00G H
txtidPaciente00I V
)00V W
;00W X
}11 	
public33 
void33 #
ModificarDesparasitante33 +
(33+ ,
)33, -
{44 	
if55 
(55 !
txtid_desparasitacion55 %
.55% &
Text55& *
!=55+ -
$str55. 0
)550 1
{66 
ClsDesparasitante77 !
objDesparasitante77" 3
=774 5
new776 9
ClsDesparasitante77: K
(77K L
)77L M
;77M N
ClsDesparasitante:: !
objDesparasitacion::" 4
=::5 6
new::7 :
ClsDesparasitante::; L
{;; 
id_disparasitacion<< &
=<<' (
Convert<<) 0
.<<0 1
ToInt32<<1 8
(<<8 9!
txtid_desparasitacion<<9 N
.<<N O
Text<<O S
)<<S T
,<<T U
Tipo== 
=== 
cmbTipo== "
.==" #
Text==# '
,==' (
fecha>> 
=>> #
datePickDesparasitacion>> 3
.>>3 4
Value>>4 9
,>>9 :
Cod_Paciente??  
=??! "
txtidPaciente??# 0
.??0 1
Text??1 5
}@@ 
;@@ 
objDesparasitanteCC !
.CC! "

ActualizarCC" ,
(CC, -
objDesparasitacionCC- ?
)CC? @
;CC@ A
}DD 
}EE 	
publicFF 
voidFF "
EliminarDesparasitanteFF *
(FF* +
)FF+ ,
{GG 	
ifHH 
(HH !
txtid_desparasitacionHH %
.HH% &
TextHH& *
!=HH+ -
$strHH. 0
)HH0 1
{II 
ClsDesparasitanteJJ !
objDesparasitanteJJ" 3
=JJ4 5
newJJ6 9
ClsDesparasitanteJJ: K
(JJK L
)JJL M
;JJM N
objDesparasitanteMM !
.MM! "
EliminarMM" *
(MM* +
ConvertMM+ 2
.MM2 3
ToInt32MM3 :
(MM: ;!
txtid_desparasitacionMM; P
.MMP Q
TextMMQ U
)MMU V
)MMV W
;MMW X
}PP 
}QQ 	
privateRR 
voidRR -
!FormRegistrarDesparasitacion_LoadRR 6
(RR6 7
objectRR7 =
senderRR> D
,RRD E
	EventArgsRRF O
eRRP Q
)RRQ R
{SS 	
}UU 	
publicVV 
voidVV 
ListarVV 
(VV 
)VV 
{WW 	
objDesparasitanteXX 
.XX  
ListarDesparasitadosXX 2
(XX2 3
dgvDesparasitadosXX3 D
)XXD E
;XXE F
dgvDesparasitadosYY 
.YY 
ColumnsYY %
[YY% &
$numYY& '
]YY' (
.YY( )
WidthYY) .
=YY/ 0
$numYY1 3
;YY3 4
dgvDesparasitadosZZ 
.ZZ 
ColumnsZZ %
[ZZ% &
$numZZ& '
]ZZ' (
.ZZ( )
WidthZZ) .
=ZZ/ 0
$numZZ1 3
;ZZ3 4
}[[ 	
public\\ 
void\\ 
ActivarBotones\\ "
(\\" #
bool\\# '
n\\( )
,\\) *
bool\\+ /
a\\0 1
,\\1 2
bool\\3 7
m\\8 9
,\\9 :
bool\\; ?
e\\@ A
,\\A B
bool\\C G
c\\H I
)\\I J
{]] 	
btnNuevo^^ 
.^^ 
Enabled^^ 
=^^ 
n^^  
;^^  !

btnAgregar__ 
.__ 
Enabled__ 
=__  
a__! "
;__" #
btnModificar`` 
.`` 
Enabled``  
=``! "
m``# $
;``$ %
btnEliminaraa 
.aa 
Enabledaa 
=aa  !
eaa" #
;aa# $
btnCancelarbb 
.bb 
Enabledbb 
=bb  !
cbb" #
;bb# $
}cc 	
publicdd 
voiddd 
ActivarCamposdd !
(dd! "
)dd" #
{ee 	!
txtid_desparasitacionff !
.ff! "
Enabledff" )
=ff* +
falseff, 1
;ff1 2
cmbTipogg 
.gg 
Enabledgg 
=gg 
truegg "
;gg" ##
datePickDesparasitacionhh #
.hh# $
Enabledhh$ +
=hh, -
truehh. 2
;hh2 3
txtidPacienteii 
.ii 
Enabledii !
=ii" #
trueii$ (
;ii( )
}jj 	
publickk 
voidkk 
DesactivarCamposkk $
(kk$ %
)kk% &
{ll 	!
txtid_desparasitacionmm !
.mm! "
Enabledmm" )
=mm* +
falsemm, 1
;mm1 2
cmbTiponn 
.nn 
Enablednn 
=nn 
truenn "
;nn" ##
datePickDesparasitacionoo #
.oo# $
Enabledoo$ +
=oo, -
trueoo. 2
;oo2 3
txtidPacientepp 
.pp 
Enabledpp !
=pp" #
falsepp$ )
;pp) *
}qq 	
publicrr 
voidrr 
Limpiarrr 
(rr 
)rr 
{ss 	!
txtid_desparasitaciontt !
.tt! "
Texttt" &
=tt' (
$strtt) +
;tt+ ,
cmbTipouu 
.uu 
Textuu 
=uu 
$struu 
;uu #
datePickDesparasitacionvv #
.vv# $
Textvv$ (
=vv) *
$strvv+ -
;vv- .
txtidPacienteww 
.ww 
Textww 
=ww  
$strww! #
;ww# $
}xx 	
privateyy 
voidyy 
btnAgregar_Clickyy %
(yy% &
objectyy& ,
senderyy- 3
,yy3 4
	EventArgsyy5 >
eyy? @
)yy@ A
{zz 	!
AgregarDesparasitante{{ !
({{! "
){{" #
;{{# $
Listar|| 
(|| 
)|| 
;|| 
Limpiar}} 
(}} 
)}} 
;}} 
ActivarBotones~~ 
(~~ 
true~~ 
,~~  
true~~! %
,~~% &
false~~' ,
,~~, -
false~~. 3
,~~3 4
true~~5 9
)~~9 :
;~~: ;
DesactivarCampos 
( 
) 
; 
}
ÄÄ 	
private
ÇÇ 
void
ÇÇ 
btnBuscar_Click
ÇÇ $
(
ÇÇ$ %
object
ÇÇ% +
sender
ÇÇ, 2
,
ÇÇ2 3
	EventArgs
ÇÇ4 =
e
ÇÇ> ?
)
ÇÇ? @
{
ÉÉ 	
Cargar_Cliente
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
Cargar_Mascota
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
áá 	
private
ââ 
void
ââ $
dgvPacientes_CellClick
ââ +
(
ââ+ ,
object
ââ, 2
sender
ââ3 9
,
ââ9 :'
DataGridViewCellEventArgs
ââ; T
e
ââU V
)
ââV W
{
ää 	
if
åå 
(
åå 
e
åå 
.
åå 
RowIndex
åå 
>=
åå 
$num
åå 
&&
åå  "
e
åå# $
.
åå$ %
ColumnIndex
åå% 0
>=
åå1 3
$num
åå4 5
)
åå5 6
{
çç 
object
èè 

idPaciente
èè !
=
èè" #
dgvPacientes
èè$ 0
.
èè0 1
Rows
èè1 5
[
èè5 6
e
èè6 7
.
èè7 8
RowIndex
èè8 @
]
èè@ A
.
èèA B
Cells
èèB G
[
èèG H
$str
èèH L
]
èèL M
.
èèM N
Value
èèN S
;
èèS T
txtidPaciente
íí 
.
íí 
Text
íí "
=
íí# $

idPaciente
íí% /
.
íí/ 0
ToString
íí0 8
(
íí8 9
)
íí9 :
;
íí: ;
}
ìì 
}
ïï 	
private
óó 
void
óó )
dgvDesparasitados_CellClick
óó 0
(
óó0 1
object
óó1 7
sender
óó8 >
,
óó> ?'
DataGridViewCellEventArgs
óó@ Y
e
óóZ [
)
óó[ \
{
òò 	
DataGridViewRow
öö 
selectedRow
öö '
=
öö( )
dgvDesparasitados
öö* ;
.
öö; <
Rows
öö< @
[
öö@ A
e
ööA B
.
ööB C
RowIndex
ööC K
]
ööK L
;
ööL M
int
õõ 
idDesparasitacion
õõ !
=
õõ" #
(
õõ$ %
int
õõ% (
)
õõ( )
selectedRow
õõ) 4
.
õõ4 5
Cells
õõ5 :
[
õõ: ;
$str
õõ; ?
]
õõ? @
.
õõ@ A
Value
õõA F
;
õõF G
string
úú 
tipo
úú 
=
úú 
selectedRow
úú %
.
úú% &
Cells
úú& +
[
úú+ ,
$str
úú, 2
]
úú2 3
.
úú3 4
Value
úú4 9
.
úú9 :
ToString
úú: B
(
úúB C
)
úúC D
;
úúD E
DateTime
ùù 
fecha
ùù 
=
ùù 
(
ùù 
DateTime
ùù &
)
ùù& '
selectedRow
ùù' 2
.
ùù2 3
Cells
ùù3 8
[
ùù8 9
$str
ùù9 @
]
ùù@ A
.
ùùA B
Value
ùùB G
;
ùùG H
string
ûû 
codPaciente
ûû 
=
ûû  
selectedRow
ûû! ,
.
ûû, -
Cells
ûû- 2
[
ûû2 3
$str
ûû3 A
]
ûûA B
.
ûûB C
Value
ûûC H
.
ûûH I
ToString
ûûI Q
(
ûûQ R
)
ûûR S
;
ûûS T#
txtid_desparasitacion
°° !
.
°°! "
Text
°°" &
=
°°' (
idDesparasitacion
°°) :
.
°°: ;
ToString
°°; C
(
°°C D
)
°°D E
;
°°E F
cmbTipo
¢¢ 
.
¢¢ 
Text
¢¢ 
=
¢¢ 
tipo
¢¢ 
;
¢¢  %
datePickDesparasitacion
££ #
.
££# $
Value
££$ )
=
££* +
fecha
££, 1
;
££1 2
txtidPaciente
§§ 
.
§§ 
Text
§§ 
=
§§  
codPaciente
§§! ,
;
§§, -
ActivarBotones
¶¶ 
(
¶¶ 
false
¶¶  
,
¶¶  !
false
¶¶" '
,
¶¶' (
true
¶¶) -
,
¶¶- .
true
¶¶/ 3
,
¶¶3 4
true
¶¶5 9
)
¶¶9 :
;
¶¶: ;
ActivarCampos
ßß 
(
ßß 
)
ßß 
;
ßß 
}
®® 	
private
™™ 
void
™™  
btnModificar_Click
™™ '
(
™™' (
object
™™( .
sender
™™/ 5
,
™™5 6
	EventArgs
™™7 @
e
™™A B
)
™™B C
{
´´ 	%
ModificarDesparasitante
¨¨ #
(
¨¨# $
)
¨¨$ %
;
¨¨% &
Listar
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
ActivarBotones
ÆÆ 
(
ÆÆ 
true
ÆÆ 
,
ÆÆ  
false
ÆÆ! &
,
ÆÆ& '
false
ÆÆ( -
,
ÆÆ- .
false
ÆÆ/ 4
,
ÆÆ4 5
true
ÆÆ6 :
)
ÆÆ: ;
;
ÆÆ; <
ActivarCampos
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 	
private
≤≤ 
void
≤≤ 
btnNuevo_Click
≤≤ #
(
≤≤# $
object
≤≤$ *
sender
≤≤+ 1
,
≤≤1 2
	EventArgs
≤≤3 <
e
≤≤= >
)
≤≤> ?
{
≥≥ 	
Limpiar
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
ActivarBotones
µµ 
(
µµ 
false
µµ  
,
µµ  !
true
µµ" &
,
µµ& '
false
µµ( -
,
µµ- .
false
µµ/ 4
,
µµ4 5
true
µµ6 :
)
µµ: ;
;
µµ; <
ActivarCampos
∂∂ 
(
∂∂ 
)
∂∂ 
;
∂∂ 
Listar
∑∑ 
(
∑∑ 
)
∑∑ 
;
∑∑ 
Cargar_Cliente
∏∏ 
(
∏∏ 
)
∏∏ 
;
∏∏ 
Cargar_Mascota
ππ 
(
ππ 
)
ππ 
;
ππ &
GroupBox_Desparasitacion
∫∫ $
.
∫∫$ %
Enabled
∫∫% ,
=
∫∫- .
false
∫∫/ 4
;
∫∫4 5
}
ºº 	
private
ææ 
void
ææ 
btnCancelar_Click
ææ &
(
ææ& '
object
ææ' -
sender
ææ. 4
,
ææ4 5
	EventArgs
ææ6 ?
e
ææ@ A
)
ææA B
{
øø 	
Limpiar
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿ 
ActivarBotones
¡¡ 
(
¡¡ 
true
¡¡ 
,
¡¡  
false
¡¡! &
,
¡¡& '
false
¡¡( -
,
¡¡- .
false
¡¡/ 4
,
¡¡4 5
true
¡¡6 :
)
¡¡: ;
;
¡¡; <
DesactivarCampos
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬ 
}
√√ 	
private
≈≈ 
void
≈≈ 
btnEliminar_Click
≈≈ &
(
≈≈& '
object
≈≈' -
sender
≈≈. 4
,
≈≈4 5
	EventArgs
≈≈6 ?
e
≈≈@ A
)
≈≈A B
{
∆∆ 	$
EliminarDesparasitante
«« "
(
««" #
)
««# $
;
««$ %
Listar
»» 
(
»» 
)
»» 
;
»» 
ActivarBotones
…… 
(
…… 
true
…… 
,
……  
false
……! &
,
……& '
false
……( -
,
……- .
false
……/ 4
,
……4 5
true
……6 :
)
……: ;
;
……; <
DesactivarCampos
   
(
   
)
   
;
   
}
ÀÀ 	
}
ÃÃ 
}ŒŒ òo
zC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormHistorialClinico.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class  
FormHistorialClinico -
:. /
Form0 4
{ 
ClsHclinica 
objHclinica 
=  !
new" %
ClsHclinica& 1
(1 2
)2 3
;3 4
string 
dni 
, 

codcliente 
, 

idpaciente  *
;* +
public  
FormHistorialClinico #
(# $
)$ %
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void %
FormHistorialClinico_Load .
(. /
object/ 5
sender6 <
,< =
	EventArgs> G
eH I
)I J
{ 	
} 	
private 
void 
btnBuscar_Click $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
dni   
=   
txtDNI   
.   
Text   
;   
if!! 
(!! 
!!! 
string!! 
.!! 
IsNullOrEmpty!! %
(!!% &
dni!!& )
)!!) *
)!!* +
{"" 
BuscarCliente$$ 
($$ 
dni$$ !
)$$! "
;$$" #
}%% 
else&& 
{'' 

MessageBox(( 
.(( 
Show(( 
(((  
$str((  B
,((B C
$str((D K
,((K L
MessageBoxButtons((M ^
.((^ _
OK((_ a
,((a b
MessageBoxIcon((c q
.((q r
Error((r w
)((w x
;((x y
})) 
}** 	
public++ 
void++ 
BuscarCliente++ !
(++! "
string++" (
dni++) ,
)++, -
{,, 	
try-- 
{.. 
using// 
(// 
var// 
dc// 
=// 
new//  #
MSOFTVETDataContext//$ 7
(//7 8
)//8 9
)//9 :
{00 
var22 
clienteEncontrado22 )
=22* +
dc22, .
.22. /
SP_BuscarCliente22/ ?
(22? @
dni22@ C
)22C D
.22D E
FirstOrDefault22E S
(22S T
)22T U
;22U V
if44 
(44 
clienteEncontrado44 )
!=44* ,
null44- 1
)441 2
{55 

codcliente77 "
=77# $
clienteEncontrado77% 6
.776 7
Cod_Cliente777 B
.77B C
ToString77C K
(77K L
)77L M
;77M N
txtNombreCliente88 (
.88( )
Text88) -
=88. /
clienteEncontrado880 A
.88A B
Nombre88B H
;88H I
CargarPaciente99 &
(99& '

codcliente99' 1
)991 2
;992 3
}:: 
else;; 
{<< 

MessageBox== "
.==" #
Show==# '
(==' (
$str==( @
,==@ A
$str==B O
,==O P
MessageBoxButtons==Q b
.==b c
OK==c e
,==e f
MessageBoxIcon==g u
.==u v
Information	==v Å
)
==Å Ç
;
==Ç É

dgvVacunas>> "
.>>" #

DataSource>># -
=>>. /
null>>0 4
;>>4 5

dgvRecetas?? "
.??" #

DataSource??# -
=??. /
null??0 4
;??4 5 
dgvDesparacitaciones@@ ,
.@@, -

DataSource@@- 7
=@@8 9
null@@: >
;@@> ?
LIMPIARPANTALLAAA '
(AA' (
)AA( )
;AA) *
}CC 
}DD 
}EE 
catchFF 
(FF 
	ExceptionFF 
exFF 
)FF  
{GG 

MessageBoxHH 
.HH 
ShowHH 
(HH  
$"HH  "
$strHH" ;
{HH; <
exHH< >
.HH> ?
MessageHH? F
}HHF G
"HHG H
,HHH I
$strHHJ Q
,HHQ R
MessageBoxButtonsHHS d
.HHd e
OKHHe g
,HHg h
MessageBoxIconHHi w
.HHw x
ErrorHHx }
)HH} ~
;HH~ 
}II 
}JJ 	
privateLL 
voidLL "
dgvPacientes_CellClickLL +
(LL+ ,
objectLL, 2
senderLL3 9
,LL9 :%
DataGridViewCellEventArgsLL; T
eLLU V
)LLV W
{MM 	
ifNN 
(NN 
eNN 
.NN 
RowIndexNN 
>=NN 
$numNN 
)NN  
{OO 
DataGridViewRowPP 
selectedRowPP  +
=PP, -
dgvPacientesPP. :
.PP: ;
RowsPP; ?
[PP? @
ePP@ A
.PPA B
RowIndexPPB J
]PPJ K
;PPK L

idpacienteQQ 
=QQ 
selectedRowQQ (
.QQ( )
CellsQQ) .
[QQ. /
$numQQ/ 0
]QQ0 1
.QQ1 2
ValueQQ2 7
?QQ7 8
.QQ8 9
ToStringQQ9 A
(QQA B
)QQB C
;QQC D
CargarDatosPacienteRR #
(RR# $

idpacienteRR$ .
)RR. /
;RR/ 0
objHclinicaSS 
.SS 

idpacienteSS &
=SS' (
ConvertSS) 0
.SS0 1
ToInt32SS1 8
(SS8 9

idpacienteSS9 C
)SSC D
;SSD E
objHclinicaTT 
.TT 

VerVacunasTT &
(TT& '
)TT' (
;TT( )

dgvVacunasUU 
.UU 

DataSourceUU %
=UU& '
objHclinicaUU( 3
.UU3 4

VerVacunasUU4 >
(UU> ?
)UU? @
;UU@ A

dgvVacunasVV 
.VV 
ColumnsVV "
[VV" #
$numVV# $
]VV$ %
.VV% &
WidthVV& +
=VV, -
$numVV. 1
;VV1 2

dgvRecetasWW 
.WW 

DataSourceWW %
=WW& '
objHclinicaWW( 3
.WW3 4

VerRecetasWW4 >
(WW> ?
)WW? @
;WW@ A

dgvRecetasXX 
.XX 
ColumnsXX "
[XX" #
$numXX# $
]XX$ %
.XX% &
WidthXX& +
=XX, -
$numXX. 1
;XX1 2 
dgvDesparacitacionesYY $
.YY$ %

DataSourceYY% /
=YY0 1
objHclinicaYY2 =
.YY= > 
VerDesparacitacionesYY> R
(YYR S
)YYS T
;YYT U 
dgvDesparacitacionesZZ $
.ZZ$ %
ColumnsZZ% ,
[ZZ, -
$numZZ- .
]ZZ. /
.ZZ/ 0
WidthZZ0 5
=ZZ6 7
$numZZ8 ;
;ZZ; <
}[[ 
else\\ 
{]] 
}__ 
}`` 	
publicaa 
voidaa 
CargarPacienteaa "
(aa" #
stringaa# )
codclaa* /
)aa/ 0
{bb 	
MSOFTVETDataContextdd 
dcdd  "
=dd# $
newdd% (
MSOFTVETDataContextdd) <
(dd< =
)dd= >
;dd> ?
varee 
	pacientesee 
=ee 
dcee 
.ee 

V_Pacienteee )
.ee) *
Whereee* /
(ee/ 0
pee0 1
=>ee2 4
pee5 6
.ee6 7
Cod_Clienteee7 B
.eeB C
ToStringeeC K
(eeK L
)eeL M
==eeN P
codcleeQ V
)eeV W
.eeW X
ToListeeX ^
(ee^ _
)ee_ `
;ee` a
ifff 
(ff 
	pacientesff 
.ff 
Anyff 
(ff 
)ff 
)ff  
{gg 
dgvPacienteshh 
.hh 
Rowshh !
.hh! "
Clearhh" '
(hh' (
)hh( )
;hh) *
foreachjj 
(jj 
varjj 
pacientejj %
injj& (
	pacientesjj) 2
)jj2 3
{kk 
stringll 
codpacientell &
=ll' (
pacientell) 1
.ll1 2
Cod_Pacientell2 >
.ll> ?
ToStringll? G
(llG H
)llH I
;llI J
stringmm 
nombrepacientemm )
=mm* +
pacientemm, 4
.mm4 5
Nombremm5 ;
;mm; <
dgvPacientesnn  
.nn  !
Rowsnn! %
.nn% &
Addnn& )
(nn) *
codpacientenn* 5
,nn5 6
nombrepacientenn7 E
)nnE F
;nnF G
}oo 
}pp 
elseqq 
{rr 

MessageBoxss 
.ss 
Showss 
(ss  
$strss  o
,sso p
$str	ssq É
,
ssÉ Ñ
MessageBoxButtons
ssÖ ñ
.
ssñ ó
OK
ssó ô
,
ssô ö
MessageBoxIcon
ssõ ©
.
ss© ™
Warning
ss™ ±
)
ss± ≤
;
ss≤ ≥
}tt 
}vv 	
privatexx 
voidxx )
dgvPacientes_CellContentClickxx 2
(xx2 3
objectxx3 9
senderxx: @
,xx@ A%
DataGridViewCellEventArgsxxB [
exx\ ]
)xx] ^
{yy 	
}{{ 	
public}} 
void}} 
CargarDatosPaciente}} '
(}}' (
string}}( .

idpaciente}}/ 9
)}}9 :
{~~ 	!
MSOFTVETDataContext
ÄÄ 
dc
ÄÄ  "
=
ÄÄ# $
new
ÄÄ% (!
MSOFTVETDataContext
ÄÄ) <
(
ÄÄ< =
)
ÄÄ= >
;
ÄÄ> ?
var
ÅÅ 
	pacientes
ÅÅ 
=
ÅÅ 
dc
ÅÅ 
.
ÅÅ 

V_Paciente
ÅÅ )
.
ÅÅ) *
Where
ÅÅ* /
(
ÅÅ/ 0
p
ÅÅ0 1
=>
ÅÅ2 4
p
ÅÅ5 6
.
ÅÅ6 7
Cod_Paciente
ÅÅ7 C
.
ÅÅC D
ToString
ÅÅD L
(
ÅÅL M
)
ÅÅM N
==
ÅÅO Q

idpaciente
ÅÅR \
)
ÅÅ\ ]
;
ÅÅ] ^
if
ÇÇ 
(
ÇÇ 
	pacientes
ÇÇ 
.
ÇÇ 
Any
ÇÇ 
(
ÇÇ 
)
ÇÇ 
)
ÇÇ  
{
ÉÉ 
foreach
ÑÑ 
(
ÑÑ 
var
ÑÑ 
paciente
ÑÑ %
in
ÑÑ& (
	pacientes
ÑÑ) 2
)
ÑÑ2 3
{
ÖÖ 
string
ÜÜ 
codpaciente
ÜÜ &
=
ÜÜ' (
paciente
ÜÜ) 1
.
ÜÜ1 2
Cod_Paciente
ÜÜ2 >
.
ÜÜ> ?
ToString
ÜÜ? G
(
ÜÜG H
)
ÜÜH I
;
ÜÜI J
string
áá 
nombrepaciente
áá )
=
áá* +
paciente
áá, 4
.
áá4 5
Nombre
áá5 ;
;
áá; <

txtnombrep
àà 
.
àà 
Text
àà #
=
àà$ %
paciente
àà& .
.
àà. /
Nombre
àà/ 5
;
àà5 6
txtespeciep
ââ 
.
ââ  
Text
ââ  $
=
ââ% &
paciente
ââ' /
.
ââ/ 0
Especie
ââ0 7
;
ââ7 8
txtrazap
ää 
.
ää 
Text
ää !
=
ää" #
paciente
ää$ ,
.
ää, -
Raza
ää- 1
;
ää1 2
txtsexop
ãã 
.
ãã 
Text
ãã !
=
ãã" #
paciente
ãã$ ,
.
ãã, -
Sexo
ãã- 1
;
ãã1 2
txtfnacimientop
åå #
.
åå# $
Text
åå$ (
=
åå) *
paciente
åå+ 3
.
åå3 4
Fecha
åå4 9
.
åå9 :
ToString
åå: B
(
ååB C
$str
ååC M
)
ååM N
;
ååN O
}
çç 
}
éé 
else
èè 
{
êê 

MessageBox
ëë 
.
ëë 
Show
ëë 
(
ëë  
$str
ëë  o
,
ëëo p
$strëëq É
,ëëÉ Ñ!
MessageBoxButtonsëëÖ ñ
.ëëñ ó
OKëëó ô
,ëëô ö
MessageBoxIconëëõ ©
.ëë© ™
Warningëë™ ±
)ëë± ≤
;ëë≤ ≥
}
íí 
}
ìì 	
public
îî 
void
îî 
LIMPIARPANTALLA
îî #
(
îî# $
)
îî$ %
{
ïï 	
txtDNI
ññ 
.
ññ 
Text
ññ 
=
ññ 
string
ññ  
.
ññ  !
Empty
ññ! &
;
ññ& '
txtespeciep
óó 
.
óó 
Text
óó 
=
óó 
string
óó %
.
óó% &
Empty
óó& +
;
óó+ ,
txtfnacimientop
òò 
.
òò 
Text
òò  
=
òò! "
string
òò# )
.
òò) *
Empty
òò* /
;
òò/ 0
txtNombreCliente
ôô 
.
ôô 
Text
ôô !
=
ôô" #
string
ôô$ *
.
ôô* +
Empty
ôô+ 0
;
ôô0 1

txtnombrep
öö 
.
öö 
Text
öö 
=
öö 
string
öö $
.
öö$ %
Empty
öö% *
;
öö* +
txtrazap
õõ 
.
õõ 
Text
õõ 
=
õõ 
string
õõ "
.
õõ" #
Empty
õõ# (
;
õõ( )
txtsexop
úú 
.
úú 
Text
úú 
=
úú 
string
úú "
.
úú" #
Empty
úú# (
;
úú( )

dgvVacunas
ùù 
.
ùù 
Rows
ùù 
.
ùù 
Clear
ùù !
(
ùù! "
)
ùù" #
;
ùù# $
dgvPacientes
ûû 
.
ûû 
Rows
ûû 
.
ûû 
Clear
ûû #
(
ûû# $
)
ûû$ %
;
ûû% &"
dgvDesparacitaciones
üü  
.
üü  !
Rows
üü! %
.
üü% &
Clear
üü& +
(
üü+ ,
)
üü, -
;
üü- .

dgvRecetas
†† 
.
†† 
Rows
†† 
.
†† 
Clear
†† !
(
††! "
)
††" #
;
††# $
}
°° 	
}
¢¢ 
}££ áx
xC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\FormAbastecimiento.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class 
FormAbastecimiento +
:, -
Form. 2
{ 
string 
nombre 
, 
stock 
; 
DateTime 
	fecha_cad 
; 
private 
static 
int 
id 
= 
$num  !
;! "
private 
	ClsVacuna 
	objVacuna #
=$ %
new& )
	ClsVacuna* 3
(3 4
)4 5
;5 6
public 
FormAbastecimiento !
(! "
)" #
{ 	
InitializeComponent 
(  
)  !
;! "
CargarComboVacuna 
( 
) 
;  
ListarVacuna 
( 
) 
; "
ListarTotalStockVacuna "
(" #
)# $
;$ %
ActivarBotones 
( 
true 
,  
false! &
,& '
false( -
,- .
false/ 4
,4 5
false6 ;
); <
;< =
} 	
public!! 
void!! 
CargarComboVacuna!! %
(!!% &
)!!& '
{"" 	
	cmbVacuna## 
.## 
Items## 
.## 
Clear## !
(##! "
)##" #
;### $
	cmbVacuna$$ 
.$$ 
Items$$ 
.$$ 
Add$$ 
($$  
$str$$  +
)$$+ ,
;$$, -
	cmbVacuna%% 
.%% 
Items%% 
.%% 
Add%% 
(%%  
$str%%  ,
)%%, -
;%%- .
	cmbVacuna&& 
.&& 
Items&& 
.&& 
Add&& 
(&&  
$str&&  3
)&&3 4
;&&4 5
	cmbVacuna'' 
.'' 
Items'' 
.'' 
Add'' 
(''  
$str''  0
)''0 1
;''1 2
	cmbVacuna(( 
.(( 
Items(( 
.(( 
Add(( 
(((  
$str((  ,
)((, -
;((- .
}** 	
public,, 
void,, 
LimpiarVacuna,, !
(,,! "
),," #
{-- 	
txtStockVacuna.. 
... 
Text.. 
=..  !
$str.." $
;..$ %
txtID// 
.// 
Text// 
=// 
$str// 
;// 
id00 
=00 
$num00 
;00 
	cmbVacuna11 
.11 
Text11 
=11 
$str11 
;11  
datePickVacuna22 
.22 
Text22 
=22  !
$str22" $
;22$ %
}33 	
public44 
void44 
ListarVacuna44  
(44  !
)44! "
{55 	
	objVacuna66 
.66 
Listar66 
(66 

dgvVacunas66 '
)66' (
;66( )
}77 	
public88 
void88 "
ListarTotalStockVacuna88 *
(88* +
)88+ ,
{99 	
	objVacuna:: 
.:: 
ListarTotalStock:: &
(::& '
dgvTotalStock::' 4
)::4 5
;::5 6
};; 	
private>> 
void>>  
dgvVacunas_CellClick>> )
(>>) *
object>>* 0
sender>>1 7
,>>7 8%
DataGridViewCellEventArgs>>9 R
e>>S T
)>>T U
{?? 	
DataGridViewRowAA 
filaAA  
=AA! "

dgvVacunasAA# -
.AA- .
RowsAA. 2
[AA2 3
eAA3 4
.AA4 5
RowIndexAA5 =
]AA= >
;AA> ?
intBB 
IDBB 
=BB 
ConvertBB 
.BB 
ToInt32BB $
(BB$ %
filaBB% )
.BB) *
CellsBB* /
[BB/ 0
$strBB0 ;
]BB; <
.BB< =
ValueBB= B
)BBB C
;BBC D
stringCC 
NombreVacunaCC 
=CC  !
filaCC" &
.CC& '
CellsCC' ,
[CC, -
$strCC- <
]CC< =
.CC= >
ValueCC> C
.CCC D
ToStringCCD L
(CCL M
)CCM N
;CCN O
intDD 
StockDisponibleDD 
=DD  !
ConvertDD" )
.DD) *
ToInt32DD* 1
(DD1 2
filaDD2 6
.DD6 7
CellsDD7 <
[DD< =
$strDD= D
]DDD E
.DDE F
ValueDDF K
)DDK L
;DDL M
DateTimeEE 
FechaCaducidadEE #
=EE$ %
(EE& '
DateTimeEE' /
)EE/ 0
filaEE0 4
.EE4 5
CellsEE5 :
[EE: ;
$strEE; K
]EEK L
.EEL M
ValueEEM R
;EER S
txtIDII 
.II 
TextII 
=II 
IDII 
.II 
ToStringII $
(II$ %
)II% &
;II& '
	cmbVacunaJJ 
.JJ 
TextJJ 
=JJ 
NombreVacunaJJ )
;JJ) *
txtStockVacunaKK 
.KK 
TextKK 
=KK  !
StockDisponibleKK" 1
.KK1 2
ToStringKK2 :
(KK: ;
)KK; <
;KK< =
datePickVacunaLL 
.LL 
ValueLL  
=LL! "
FechaCaducidadLL# 1
;LL1 2
ActivarBotonesNN 
(NN 
falseNN  
,NN  !
falseNN" '
,NN' (
trueNN) -
,NN- .
trueNN/ 3
,NN3 4
trueNN5 9
)NN9 :
;NN: ;
ActivarCamposOO 
(OO 
)OO 
;OO 
}PP 	
publicRR 
voidRR 
ActivarBotonessssRR %
(RR% &
)RR& '
{SS 	

btnAgregarTT 
.TT 
EnabledTT 
=TT  
trueTT! %
;TT% &
btnModificarUU 
.UU 
EnabledUU  
=UU! "
trueUU# '
;UU' (
btnEliminarVV 
.VV 
EnabledVV 
=VV  !
trueVV" &
;VV& '
}WW 	
publicYY 
voidYY 
ActivarBotonesYY "
(YY" #
boolYY# '
nYY( )
,YY) *
boolYY+ /
aYY0 1
,YY1 2
boolYY3 7
mYY8 9
,YY9 :
boolYY; ?
eYY@ A
,YYA B
boolYYC G
cYYH I
)YYI J
{ZZ 	
btnNuevo[[ 
.[[ 
Enabled[[ 
=[[ 
n[[  
;[[  !

btnAgregar\\ 
.\\ 
Enabled\\ 
=\\  
a\\! "
;\\" #
btnModificar]] 
.]] 
Enabled]]  
=]]! "
m]]# $
;]]$ %
btnEliminar^^ 
.^^ 
Enabled^^ 
=^^  !
e^^" #
;^^# $
btnCancelar__ 
.__ 
Enabled__ 
=__  !
c__" #
;__# $
}`` 	
publicbb 
voidbb 
DesactivarBotonesbb %
(bb% &
)bb& '
{cc 	

btnAgregardd 
.dd 
Enableddd 
=dd  
falsedd! &
;dd& '
btnModificaree 
.ee 
Enabledee  
=ee! "
falseee# (
;ee( )
btnEliminarff 
.ff 
Enabledff 
=ff  !
falseff" '
;ff' (
}gg 	
publichh 
voidhh 
ActivarCamposhh !
(hh! "
)hh" #
{ii 	
	cmbVacunajj 
.jj 
Enabledjj 
=jj 
truejj  $
;jj$ %
txtStockVacunakk 
.kk 
Enabledkk "
=kk# $
truekk% )
;kk) *
}ll 	
publicmm 
voidmm 
DesactivarCamposmm $
(mm$ %
)mm% &
{nn 	
	cmbVacunaoo 
.oo 
Enabledoo 
=oo 
trueoo  $
;oo$ %
txtStockVacunapp 
.pp 
Enabledpp "
=pp# $
truepp% )
;pp) *
}qq 	
privatevv 
voidvv 
btnLimpiar_Clickvv %
(vv% &
objectvv& ,
sendervv- 3
,vv3 4
	EventArgsvv5 >
evv? @
)vv@ A
{ww 	
LimpiarVacunaxx 
(xx 
)xx 
;xx 
}yy 	
publiczz 
voidzz 
AgregarVacunaszz "
(zz" #
)zz# $
{{{ 	
	objVacuna|| 
.|| 
Insertar|| 
(|| 
	cmbVacuna|| (
,||( )
txtStockVacuna||* 8
,||8 9
datePickVacuna||: H
)||H I
;||I J
}}} 	
private~~ 
void~~ 
btnAgregar_Click~~ %
(~~% &
object~~& ,
sender~~- 3
,~~3 4
	EventArgs~~5 >
e~~? @
)~~@ A
{ 	
AgregarVacunas
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
ListarVacuna
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ $
ListarTotalStockVacuna
ÇÇ "
(
ÇÇ" #
)
ÇÇ# $
;
ÇÇ$ %
ActivarBotones
ÉÉ 
(
ÉÉ 
true
ÉÉ 
,
ÉÉ  
true
ÉÉ! %
,
ÉÉ% &
false
ÉÉ' ,
,
ÉÉ, -
false
ÉÉ. 3
,
ÉÉ3 4
true
ÉÉ5 9
)
ÉÉ9 :
;
ÉÉ: ;
DesactivarCampos
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
public
ÜÜ 
void
ÜÜ 
ModificarVacunas
ÜÜ $
(
ÜÜ$ %
)
ÜÜ% &
{
áá 	
if
àà 
(
àà 
txtID
àà 
.
àà 
Text
àà 
!=
àà 
$str
àà  
)
àà  !
{
ââ 
	ClsVacuna
ää 
	objVacuna
ää #
=
ää$ %
new
ää& )
	ClsVacuna
ää* 3
(
ää3 4
)
ää4 5
;
ää5 6
	ClsVacuna
çç 

objVacuna2
çç $
=
çç% &
new
çç' *
	ClsVacuna
çç+ 4
{
éé 
ID
èè 
=
èè 
Convert
èè  
.
èè  !
ToInt32
èè! (
(
èè( )
txtID
èè) .
.
èè. /
Text
èè/ 3
)
èè3 4
,
èè4 5
NombreVacuna
êê  
=
êê! "
	cmbVacuna
êê# ,
.
êê, -
Text
êê- 1
,
êê1 2
StockDisponible
ëë #
=
ëë$ %
Convert
ëë& -
.
ëë- .
ToInt32
ëë. 5
(
ëë5 6
txtStockVacuna
ëë6 D
.
ëëD E
Text
ëëE I
)
ëëI J
,
ëëJ K
FechaCaducidad
íí "
=
íí# $
datePickVacuna
íí% 3
.
íí3 4
Value
íí4 9
}
ìì 
;
ìì 
	objVacuna
ññ 
.
ññ 

Actualizar
ññ $
(
ññ$ %

objVacuna2
ññ% /
)
ññ/ 0
;
ññ0 1
}
óó 
}
òò 	
private
ôô 
void
ôô  
btnModificar_Click
ôô '
(
ôô' (
object
ôô( .
sender
ôô/ 5
,
ôô5 6
	EventArgs
ôô7 @
e
ôôA B
)
ôôB C
{
öö 	
ModificarVacunas
õõ 
(
õõ 
)
õõ 
;
õõ 
ListarVacuna
úú 
(
úú 
)
úú 
;
úú $
ListarTotalStockVacuna
ùù "
(
ùù" #
)
ùù# $
;
ùù$ %
ActivarBotones
ûû 
(
ûû 
true
ûû 
,
ûû  
false
ûû! &
,
ûû& '
false
ûû( -
,
ûû- .
false
ûû/ 4
,
ûû4 5
true
ûû6 :
)
ûû: ;
;
ûû; <
ActivarCampos
üü 
(
üü 
)
üü 
;
üü 
}
†† 	
public
°° 
void
°° 
EliminarVacunas
°° #
(
°°# $
)
°°$ %
{
¢¢ 	
if
££ 
(
££ 
txtID
££ 
.
££ 
Text
££ 
!=
££ 
$str
££  
)
££  !
{
§§ 
	ClsVacuna
•• 
	objVacuna
•• #
=
••$ %
new
••& )
	ClsVacuna
••* 3
(
••3 4
)
••4 5
;
••5 6
	objVacuna
®® 
.
®® 
Eliminar
®® "
(
®®" #
Convert
®®# *
.
®®* +
ToInt32
®®+ 2
(
®®2 3
txtID
®®3 8
.
®®8 9
Text
®®9 =
)
®®= >
)
®®> ?
;
®®? @
}
©© 
}
™™ 	
private
´´ 
void
´´ 
btnEliminar_Click
´´ &
(
´´& '
object
´´' -
sender
´´. 4
,
´´4 5
	EventArgs
´´6 ?
e
´´@ A
)
´´A B
{
¨¨ 	
EliminarVacunas
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
ListarVacuna
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ $
ListarTotalStockVacuna
ØØ "
(
ØØ" #
)
ØØ# $
;
ØØ$ %
ActivarBotones
∞∞ 
(
∞∞ 
true
∞∞ 
,
∞∞  
false
∞∞! &
,
∞∞& '
false
∞∞( -
,
∞∞- .
false
∞∞/ 4
,
∞∞4 5
true
∞∞6 :
)
∞∞: ;
;
∞∞; <
DesactivarCampos
±± 
(
±± 
)
±± 
;
±± 
}
≤≤ 	
private
¥¥ 
void
¥¥ 
btnCancelar_Click
¥¥ &
(
¥¥& '
object
¥¥' -
sender
¥¥. 4
,
¥¥4 5
	EventArgs
¥¥6 ?
e
¥¥@ A
)
¥¥A B
{
µµ 	
LimpiarVacuna
∂∂ 
(
∂∂ 
)
∂∂ 
;
∂∂ 
ActivarBotones
∑∑ 
(
∑∑ 
true
∑∑ 
,
∑∑  
false
∑∑! &
,
∑∑& '
false
∑∑( -
,
∑∑- .
false
∑∑/ 4
,
∑∑4 5
true
∑∑6 :
)
∑∑: ;
;
∑∑; <
DesactivarCampos
∏∏ 
(
∏∏ 
)
∏∏ 
;
∏∏ 
}
ππ 	
private
ªª 
void
ªª %
FormAbastecimiento_Load
ªª ,
(
ªª, -
object
ªª- 3
sender
ªª4 :
,
ªª: ;
	EventArgs
ªª< E
e
ªªF G
)
ªªG H
{
ºº 	
}
ææ 	
private
¡¡ 
void
¡¡ 
btnNuevo_Click
¡¡ #
(
¡¡# $
object
¡¡$ *
sender
¡¡+ 1
,
¡¡1 2
	EventArgs
¡¡3 <
e
¡¡= >
)
¡¡> ?
{
¬¬ 	
ActivarBotones
√√ 
(
√√ 
false
√√  
,
√√  !
true
√√" &
,
√√& '
false
√√( -
,
√√- .
false
√√/ 4
,
√√4 5
true
√√6 :
)
√√: ;
;
√√; <
ActivarCampos
ƒƒ 
(
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
≈≈ 	
}
«« 
}»» Ô¡
vC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsVacuna.cs
	namespace		 	
ProyectoFinal		
 
.		 
Clases		 
{

 
public 

class 
	ClsVacuna 
{ 
MSOFTVETDataContext 
dc 
=  
new! $
MSOFTVETDataContext% 8
(8 9
)9 :
;: ;
public 
int 

id_Detalle 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Cod_Paciente "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
	Id_Vacuna 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
	num_dosis 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DateTime 
fecha 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
dni 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 

codCliente  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	idCliente 
{  !
get" %
;% &
set' *
;* +
}, -
public   
int   
ID   
{   
get   
;   
set    
;    !
}  " #
public!! 
string!! 
NombreVacuna!! "
{!!# $
get!!% (
;!!( )
set!!* -
;!!- .
}!!/ 0
public"" 
int"" 
StockDisponible"" "
{""# $
get""% (
;""( )
set""* -
;""- .
}""/ 0
public## 
DateTime## 
FechaCaducidad## &
{##' (
get##) ,
;##, -
set##. 1
;##1 2
}##3 4
public(( 
void(( 
Listar(( 
((( 
DataGridView(( '
dgvVacunados((( 4
)((4 5
{)) 	
MSOFTVETDataContext** 
dc**  "
=**# $
new**% (
MSOFTVETDataContext**) <
(**< =
)**= >
;**> ?
var++ 
consulta++ 
=++ 
dc++ 
.++ 
Vacuna++ $
.++$ %
ToList++% +
(+++ ,
)++, -
;++- .
dgvVacunados,, 
.,, 

DataSource,, #
=,,$ %
consulta,,& .
;,,. /
}.. 	
public00 
void00 
ListarTotalStock00 $
(00$ %
DataGridView00% 1
dgvTotalStock002 ?
)00? @
{11 	
try22 
{33 
var44 
consulta44 
=44 
dc44 !
.44! "
SP_TotalStockVacuna44" 5
(445 6
)446 7
.447 8
ToList448 >
(44> ?
)44? @
;44@ A
if66 
(66 
consulta66 
.66 
Any66  
(66  !
)66! "
)66" #
{77 
dgvTotalStock88 !
.88! "

DataSource88" ,
=88- .
consulta88/ 7
;887 8
dgvTotalStock99 !
.99! "
Columns99" )
[99) *
$num99* +
]99+ ,
.99, -

HeaderText99- 7
=998 9
$str99: >
;99> ?
dgvTotalStock:: !
.::! "
Columns::" )
[::) *
$num::* +
]::+ ,
.::, -

HeaderText::- 7
=::8 9
$str::: B
;::B C
dgvTotalStock;; !
.;;! "
Columns;;" )
[;;) *
$num;;* +
];;+ ,
.;;, -

HeaderText;;- 7
=;;8 9
$str;;: G
;;;G H
}<< 
else== 
{>> 

MessageBox?? 
.?? 
Show?? #
(??# $
$str??$ @
,??@ A
$str??B M
,??M N
MessageBoxButtons??O `
.??` a
OK??a c
,??c d
MessageBoxIcon??e s
.??s t
Information??t 
)	?? Ä
;
??Ä Å
}@@ 
}AA 
catchBB 
(BB 
	ExceptionBB 
exBB 
)BB  
{CC 

MessageBoxDD 
.DD 
ShowDD 
(DD  
$strDD  Q
+DDR S
exDDT V
.DDV W
MessageDDW ^
,DD^ _
$strDD` g
,DDg h
MessageBoxButtonsDDi z
.DDz {
OKDD{ }
,DD} ~
MessageBoxIcon	DD ç
.
DDç é
Error
DDé ì
)
DDì î
;
DDî ï
}EE 
}FF 	
publicHH 
voidHH 
InsertarHH 
(HH 
ComboBoxHH %
	cmbVacunaHH& /
,HH/ 0
TextBoxHH1 8
txtStockVacunaHH9 G
,HHG H
DateTimePickerHHI W
datePickVacunaHHX f
)HHf g
{II 	
tryJJ 
{KK 
ifLL 
(LL 
!LL 
stringLL 
.LL 
IsNullOrWhiteSpaceLL .
(LL. /
	cmbVacunaLL/ 8
.LL8 9
TextLL9 =
)LL= >
&&LL? A
!LLB C
stringLLC I
.LLI J
IsNullOrWhiteSpaceLLJ \
(LL\ ]
txtStockVacunaLL] k
.LLk l
TextLLl p
)LLp q
)LLq r
{MM 
NombreVacunaOO  
=OO! "
	cmbVacunaOO# ,
.OO, -
TextOO- 1
;OO1 2
StockDisponiblePP #
=PP$ %
ConvertPP& -
.PP- .
ToInt32PP. 5
(PP5 6
txtStockVacunaPP6 D
.PPD E
TextPPE I
)PPI J
;PPJ K
FechaCaducidadQQ "
=QQ# $
datePickVacunaQQ% 3
.QQ3 4
ValueQQ4 9
;QQ9 :
usingSS 
(SS 
varSS 
dcSS !
=SS" #
newSS$ '
MSOFTVETDataContextSS( ;
(SS; <
)SS< =
)SS= >
{TT 
dcUU 
.UU $
SP_Agregar_Abast_VacunasUU 3
(UU3 4
NombreVacunaUU4 @
,UU@ A
StockDisponibleUUB Q
,UUQ R
FechaCaducidadUUS a
)UUa b
;UUb c
}VV 

MessageBoxXX 
.XX 
ShowXX #
(XX# $
$strXX$ R
,XXR S
$strXXT e
,XXe f
MessageBoxButtonsXXg x
.XXx y
OKXXy {
,XX{ |
MessageBoxIcon	XX} ã
.
XXã å
Information
XXå ó
)
XXó ò
;
XXò ô
}YY 
elseZZ 
{[[ 

MessageBox\\ 
.\\ 
Show\\ #
(\\# $
$str\\$ d
,\\d e
$str\\f z
,\\z {
MessageBoxButtons	\\| ç
.
\\ç é
OK
\\é ê
,
\\ê ë
MessageBoxIcon
\\í †
.
\\† °
Warning
\\° ®
)
\\® ©
;
\\© ™
}]] 
}^^ 
catch__ 
(__ 
	Exception__ 
ex__ 
)__  
{`` 

MessageBoxaa 
.aa 
Showaa 
(aa  
$straa  A
+aaB C
exaaD F
,aaF G
$straaH O
,aaO P
MessageBoxButtonsaaQ b
.aab c
OKaac e
,aae f
MessageBoxIconaag u
.aau v
Erroraav {
)aa{ |
;aa| }
}bb 
}cc 	
publicee 
voidee 

Actualizaree 
(ee 
	ClsVacunaee (

objVacunasee) 3
)ee3 4
{ff 	
trygg 
{hh 
usingii 
(ii 
varii 
dcii 
=ii 
newii  #
MSOFTVETDataContextii$ 7
(ii7 8
)ii8 9
)ii9 :
{jj 
dcll 
.ll &
SP_Modificar_Abast_Vacunasll 1
(ll1 2

objVacunasmm "
.mm" #
IDmm# %
,mm% &

objVacunasnn "
.nn" #
NombreVacunann# /
,nn/ 0

objVacunasoo "
.oo" #
StockDisponibleoo# 2
,oo2 3

objVacunaspp "
.pp" #
FechaCaducidadpp# 1
)qq 
;qq 
}rr 

MessageBoxtt 
.tt 
Showtt 
(tt  
$strtt  K
,ttK L
$strttM a
,tta b
MessageBoxButtonsttc t
.ttt u
OKttu w
,ttw x
MessageBoxIcon	tty á
.
ttá à
Information
ttà ì
)
ttì î
;
ttî ï
}uu 
catchvv 
(vv 
	Exceptionvv 
exvv 
)vv  
{ww 

MessageBoxyy 
.yy 
Showyy 
(yy  
$stryy  ?
+yy@ A
exyyB D
.yyD E
MessageyyE L
,yyL M
$stryyN U
,yyU V
MessageBoxButtonsyyW h
.yyh i
OKyyi k
,yyk l
MessageBoxIconyym {
.yy{ |
Error	yy| Å
)
yyÅ Ç
;
yyÇ É
}zz 
}{{ 	
public|| 
void|| 
Eliminar|| 
(|| 
int||  
id||! #
)||# $
{}} 	
try~~ 
{ 
dc
ÅÅ 
.
ÅÅ '
SP_Eliminar_Abast_Vacunas
ÅÅ ,
(
ÅÅ, -
id
ÅÅ- /
)
ÅÅ/ 0
;
ÅÅ0 1

MessageBox
ÉÉ 
.
ÉÉ 
Show
ÉÉ 
(
ÉÉ  
$str
ÉÉ  I
,
ÉÉI J
$str
ÉÉK ]
,
ÉÉ] ^
MessageBoxButtons
ÉÉ_ p
.
ÉÉp q
OK
ÉÉq s
,
ÉÉs t
MessageBoxIconÉÉu É
.ÉÉÉ Ñ
InformationÉÉÑ è
)ÉÉè ê
;ÉÉê ë
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
ÜÜ 

MessageBox
àà 
.
àà 
Show
àà 
(
àà  
$str
àà  =
+
àà> ?
ex
àà@ B
.
ààB C
Message
ààC J
,
ààJ K
$str
ààL S
,
ààS T
MessageBoxButtons
ààU f
.
ààf g
OK
ààg i
,
àài j
MessageBoxIcon
ààk y
.
àày z
Error
ààz 
)àà Ä
;ààÄ Å
}
ââ 
}
ää 	
public
çç 
void
çç 
CargarCliente
çç !
(
çç! "
TextBox
çç" )
txtDNI
çç* 0
,
çç0 1
TextBox
çç2 9
txtNombreCliente
çç: J
,
ççJ K
TextBox
ççL S
txtCodCliente
ççT a
)
çça b
{
éé 	!
MSOFTVETDataContext
èè 
dc
èè  "
=
èè# $
new
èè% (!
MSOFTVETDataContext
èè) <
(
èè< =
)
èè= >
;
èè> ?
string
êê 
dniBusqueda
êê 
=
êê  
txtDNI
êê! '
.
êê' (
Text
êê( ,
;
êê, -
var
íí 
clienteEncontrado
íí !
=
íí" #
dc
íí$ &
.
íí& '
	V_Cliente
íí' 0
.
íí0 1
FirstOrDefault
íí1 ?
(
íí? @
c
íí@ A
=>
ííB D
c
ííE F
.
ííF G
DNI
ííG J
==
ííK M
dniBusqueda
ííN Y
)
ííY Z
;
ííZ [
if
îî 
(
îî 
clienteEncontrado
îî !
!=
îî" $
null
îî% )
)
îî) *
{
ïï 
txtNombreCliente
ññ  
.
ññ  !
Text
ññ! %
=
ññ& '
clienteEncontrado
ññ( 9
.
ññ9 :
Nombre
ññ: @
;
ññ@ A
txtCodCliente
óó 
.
óó 
Text
óó "
=
óó# $
clienteEncontrado
óó% 6
.
óó6 7
Cod_Cliente
óó7 B
.
óóB C
ToString
óóC K
(
óóK L
)
óóL M
;
óóM N
	idCliente
òò 
=
òò 
clienteEncontrado
òò -
.
òò- .
Cod_Cliente
òò. 9
.
òò9 :
ToString
òò: B
(
òòB C
)
òòC D
;
òòD E
}
ôô 
else
öö 
{
õõ 
txtNombreCliente
úú  
.
úú  !
Text
úú! %
=
úú& '
$str
úú( ?
;
úú? @
	idCliente
ùù 
=
ùù 
$str
ùù 
;
ùù 
}
ûû 
}
üü 	
public
¢¢ 
void
¢¢ 
CargarMascota
¢¢ !
(
¢¢! "
DataGridView
¢¢" .
dgvPacientes
¢¢/ ;
)
¢¢; <
{
££ 	!
MSOFTVETDataContext
§§ 
dc
§§  "
=
§§# $
new
§§% (!
MSOFTVETDataContext
§§) <
(
§§< =
)
§§= >
;
§§> ?
string
•• #
codigoClienteBusqueda
•• (
=
••) *
	idCliente
••+ 4
;
••4 5
var
™™ 
	pacientes
™™ 
=
™™ 
dc
™™ 
.
™™ 

V_Paciente
™™ )
.
´´ 
Where
´´ 
(
´´ 
p
´´ 
=>
´´ 
p
´´ 
.
´´ 
Cod_Cliente
´´ (
.
´´( )
ToString
´´) 1
(
´´1 2
)
´´2 3
==
´´4 6#
codigoClienteBusqueda
´´7 L
)
´´L M
.
¨¨ 
Select
¨¨ 
(
¨¨ 
p
¨¨ 
=>
¨¨ 
new
¨¨ 
{
≠≠ 
ID
ÆÆ 
=
ÆÆ 
p
ÆÆ 
.
ÆÆ 
Cod_Paciente
ÆÆ &
,
ÆÆ& '
p
ØØ 
.
ØØ 
Nombre
ØØ 
}
∞∞ 
)
∞∞ 
.
±± 
ToList
±± 
(
±± 
)
±± 
;
±± 
if
≤≤ 
(
≤≤ 
	pacientes
≤≤ 
.
≤≤ 
Count
≤≤ 
>
≤≤  !
$num
≤≤" #
)
≤≤# $
{
≥≥ 
dgvPacientes
¥¥ 
.
¥¥ 

DataSource
¥¥ '
=
¥¥( )
	pacientes
¥¥* 3
;
¥¥3 4
dgvPacientes
µµ 
.
µµ 
Columns
µµ $
[
µµ$ %
$num
µµ% &
]
µµ& '
.
µµ' (
Width
µµ( -
=
µµ. /
$num
µµ0 2
;
µµ2 3
}
∑∑ 
else
∏∏ 
{
ππ 

MessageBox
∫∫ 
.
∫∫ 
Show
∫∫ 
(
∫∫  
$str
∫∫  r
,
∫∫r s
$str∫∫t Ü
,∫∫Ü á!
MessageBoxButtons∫∫à ô
.∫∫ô ö
OK∫∫ö ú
,∫∫ú ù
MessageBoxIcon∫∫û ¨
.∫∫¨ ≠
Warning∫∫≠ ¥
)∫∫¥ µ
;∫∫µ ∂
}
ªª 
}
ºº 	
public
ææ 
void
ææ 
ReducirStock
ææ  
(
ææ  !
int
ææ! $
cantidad
ææ% -
)
ææ- .
{
øø 	
try
¿¿ 
{
¡¡ 
using
¬¬ 
(
¬¬ 
var
¬¬ 
dc
¬¬ 
=
¬¬ 
new
¬¬  #!
MSOFTVETDataContext
¬¬$ 7
(
¬¬7 8
)
¬¬8 9
)
¬¬9 :
{
√√ 
dc
≈≈ 
.
≈≈ #
SP_ReducirStockVacuna
≈≈ ,
(
≈≈, -
ID
≈≈- /
,
≈≈/ 0
cantidad
≈≈1 9
)
≈≈9 :
;
≈≈: ;
}
∆∆ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
…… 
throw
   
new
   
	Exception
   #
(
  # $
$str
  $ N
+
  O P
ex
  Q S
.
  S T
Message
  T [
)
  [ \
;
  \ ]
}
ÀÀ 
}
ÃÃ 	
public
ÕÕ 
void
ÕÕ !
Insertar_Vacunacion
ÕÕ '
(
ÕÕ' (
TextBox
ÕÕ( /
txtIDPaciente
ÕÕ0 =
,
ÕÕ= >
TextBox
ÕÕ? F
txtIDVacuna
ÕÕG R
,
ÕÕR S
TextBox
ÕÕT [
txtNroDosis
ÕÕ\ g
,
ÕÕg h
DateTimePicker
ÕÕi w!
datePickVacunacionÕÕx ä
)ÕÕä ã
{
ŒŒ 	
try
œœ 
{
–– 
if
—— 
(
—— 
!
—— 
string
—— 
.
——  
IsNullOrWhiteSpace
—— .
(
——. /
txtIDPaciente
——/ <
.
——< =
Text
——= A
)
——A B
&&
——C E
!
——F G
string
——G M
.
——M N 
IsNullOrWhiteSpace
——N `
(
——` a
txtIDVacuna
——a l
.
——l m
Text
——m q
)
——q r
)
——r s
{
““ 
Cod_Paciente
””  
=
””! "
txtIDPaciente
””# 0
.
””0 1
Text
””1 5
;
””5 6
	Id_Vacuna
‘‘ 
=
‘‘ 
txtIDVacuna
‘‘  +
.
‘‘+ ,
Text
‘‘, 0
;
‘‘0 1
	num_dosis
’’ 
=
’’ 
txtNroDosis
’’  +
.
’’+ ,
Text
’’, 0
;
’’0 1
fecha
÷÷ 
=
÷÷  
datePickVacunacion
÷÷ .
.
÷÷. /
Value
÷÷/ 4
;
÷÷4 5
using
ÿÿ 
(
ÿÿ 
var
ÿÿ 
dc
ÿÿ !
=
ÿÿ" #
new
ÿÿ$ '!
MSOFTVETDataContext
ÿÿ( ;
(
ÿÿ; <
)
ÿÿ< =
)
ÿÿ= >
{
ŸŸ 
var
€€ 
vacuna
€€ "
=
€€# $
dc
€€% '
.
€€' (
Vacuna
€€( .
.
€€. /
FirstOrDefault
€€/ =
(
€€= >
v
€€> ?
=>
€€@ B
v
€€C D
.
€€D E
	ID_Vacuna
€€E N
==
€€O Q
Convert
€€R Y
.
€€Y Z
ToInt32
€€Z a
(
€€a b
	Id_Vacuna
€€b k
)
€€k l
)
€€l m
;
€€m n
if
‹‹ 
(
‹‹ 
vacuna
‹‹ "
!=
‹‹# %
null
‹‹& *
&&
‹‹+ -
vacuna
‹‹. 4
.
‹‹4 5
Stock
‹‹5 :
>
‹‹; <
$num
‹‹= >
)
‹‹> ?
{
›› 
dc
ﬂﬂ 
.
ﬂﬂ #
SP_Agregar_Vacunacion
ﬂﬂ 4
(
ﬂﬂ4 5
Cod_Paciente
ﬂﬂ5 A
,
ﬂﬂA B
	Id_Vacuna
ﬂﬂC L
,
ﬂﬂL M
	num_dosis
ﬂﬂN W
,
ﬂﬂW X
fecha
ﬂﬂY ^
)
ﬂﬂ^ _
;
ﬂﬂ_ `
dc
‚‚ 
.
‚‚ #
SP_ReducirStockVacuna
‚‚ 4
(
‚‚4 5
Convert
‚‚5 <
.
‚‚< =
ToInt32
‚‚= D
(
‚‚D E
	Id_Vacuna
‚‚E N
)
‚‚N O
,
‚‚O P
$num
‚‚Q R
)
‚‚R S
;
‚‚S T

MessageBox
‰‰ &
.
‰‰& '
Show
‰‰' +
(
‰‰+ ,
$str‰‰, É
,‰‰É Ñ
$str‰‰Ö õ
,‰‰õ ú!
MessageBoxButtons‰‰ù Æ
.‰‰Æ Ø
OK‰‰Ø ±
,‰‰± ≤
MessageBoxIcon‰‰≥ ¡
.‰‰¡ ¬
Information‰‰¬ Õ
)‰‰Õ Œ
;‰‰Œ œ
}
ÂÂ 
else
ÊÊ 
{
ÁÁ 

MessageBox
ËË &
.
ËË& '
Show
ËË' +
(
ËË+ ,
$str
ËË, `
,
ËË` a
$str
ËËb v
,
ËËv w 
MessageBoxButtonsËËx â
.ËËâ ä
OKËËä å
,ËËå ç
MessageBoxIconËËé ú
.ËËú ù
WarningËËù §
)ËË§ •
;ËË• ¶
}
ÈÈ 
}
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 

MessageBox
ÓÓ 
.
ÓÓ 
Show
ÓÓ #
(
ÓÓ# $
$str
ÓÓ$ h
,
ÓÓh i
$str
ÓÓj ~
,
ÓÓ~ !
MessageBoxButtonsÓÓÄ ë
.ÓÓë í
OKÓÓí î
,ÓÓî ï
MessageBoxIconÓÓñ §
.ÓÓ§ •
WarningÓÓ• ¨
)ÓÓ¨ ≠
;ÓÓ≠ Æ
}
ÔÔ 
}
 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ 
ex
ÒÒ 
)
ÒÒ  
{
ÚÚ 

MessageBox
ÛÛ 
.
ÛÛ 
Show
ÛÛ 
(
ÛÛ  
$str
ÛÛ  B
+
ÛÛC D
ex
ÛÛE G
,
ÛÛG H
$str
ÛÛI P
,
ÛÛP Q
MessageBoxButtons
ÛÛR c
.
ÛÛc d
OK
ÛÛd f
,
ÛÛf g
MessageBoxIcon
ÛÛh v
.
ÛÛv w
Error
ÛÛw |
)
ÛÛ| }
;
ÛÛ} ~
}
ÙÙ 
}
ıı 	
public
˜˜ 
void
˜˜ !
Eliminar_Vacunacion
˜˜ '
(
˜˜' (
int
˜˜( +

id_Detalle
˜˜, 6
)
˜˜6 7
{
¯¯ 	
try
˘˘ 
{
˙˙ 
using
˚˚ 
(
˚˚ 
var
˚˚ 
dc
˚˚ 
=
˚˚ 
new
˚˚  #!
MSOFTVETDataContext
˚˚$ 7
(
˚˚7 8
)
˚˚8 9
)
˚˚9 :
{
¸¸ 
var
˛˛ 

vacunacion
˛˛ "
=
˛˛# $
dc
˛˛% '
.
˛˛' (
V_Vacunacion
˛˛( 4
.
˛˛4 5
FirstOrDefault
˛˛5 C
(
˛˛C D
d
˛˛D E
=>
˛˛F H
d
˛˛I J
.
˛˛J K

Id_Detalle
˛˛K U
==
˛˛V X

id_Detalle
˛˛Y c
)
˛˛c d
;
˛˛d e
if
ÄÄ 
(
ÄÄ 

vacunacion
ÄÄ "
!=
ÄÄ# %
null
ÄÄ& *
)
ÄÄ* +
{
ÅÅ 
dc
ÉÉ 
.
ÉÉ $
SP_Eliminar_Vacunacion
ÉÉ 1
(
ÉÉ1 2

id_Detalle
ÉÉ2 <
)
ÉÉ< =
;
ÉÉ= >
dc
ÜÜ 
.
ÜÜ $
SP_EliminarStockVacuna
ÜÜ 1
(
ÜÜ1 2

vacunacion
ÜÜ2 <
.
ÜÜ< =
	ID_Vacuna
ÜÜ= F
,
ÜÜF G
Convert
ÜÜH O
.
ÜÜO P
ToInt32
ÜÜP W
(
ÜÜW X

vacunacion
ÜÜX b
.
ÜÜb c
NumDosis
ÜÜc k
)
ÜÜk l
)
ÜÜl m
;
ÜÜm n

MessageBox
àà "
.
àà" #
Show
àà# '
(
àà' (
$stràà( Å
,ààÅ Ç
$strààÉ ò
,ààò ô!
MessageBoxButtonsààö ´
.àà´ ¨
OKàà¨ Æ
,ààÆ Ø
MessageBoxIconàà∞ æ
.ààæ ø
Informationààø  
)àà  À
;ààÀ Ã
}
ââ 
else
ää 
{
ãã 

MessageBox
åå "
.
åå" #
Show
åå# '
(
åå' (
$str
åå( U
,
ååU V
$str
ååW ^
,
åå^ _
MessageBoxButtons
åå` q
.
ååq r
OK
åår t
,
ååt u
MessageBoxIconååv Ñ
.ååÑ Ö
ErrorååÖ ä
)ååä ã
;ååã å
}
çç 
}
éé 
}
èè 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 

MessageBox
ìì 
.
ìì 
Show
ìì 
(
ìì  
$str
ìì  @
+
ììA B
ex
ììC E
.
ììE F
Message
ììF M
,
ììM N
$str
ììO V
,
ììV W
MessageBoxButtons
ììX i
.
ììi j
OK
ììj l
,
ììl m
MessageBoxIcon
ììn |
.
ìì| }
Errorìì} Ç
)ììÇ É
;ììÉ Ñ
}
îî 
}
ïï 	
public
ññ 
void
ññ 
ListarVacunados
ññ #
(
ññ# $
DataGridView
ññ$ 0
dgvVacunados
ññ1 =
)
ññ= >
{
óó 	!
MSOFTVETDataContext
òò 
dc
òò  "
=
òò# $
new
òò% (!
MSOFTVETDataContext
òò) <
(
òò< =
)
òò= >
;
òò> ?
var
ôô 
consulta
ôô 
=
ôô 
dc
ôô 
.
ôô '
V_DETALLE_PACIENTE_VACUNA
ôô 7
.
ôô7 8
ToList
ôô8 >
(
ôô> ?
)
ôô? @
;
ôô@ A
dgvVacunados
öö 
.
öö 

DataSource
öö #
=
öö$ %
consulta
öö& .
;
öö. /
dgvVacunados
õõ 
.
õõ 
Columns
õõ  
[
õõ  !
$num
õõ! "
]
õõ" #
.
õõ# $
Width
õõ$ )
=
õõ* +
$num
õõ, .
;
õõ. /
}
úú 	
}
¢¢ 
}££ Ú'
zC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\CorreoManager.cs
	namespace 	
ProyectoFinal
 
. 
Clases 
{ 
public 

class 
CorreoManager 
{ 
private 
string 
myEmail 
=  
$str! ;
;; <
private 
string 

MyPassword !
=" #
$str$ 9
;9 :
private 
string 
MyAlias 
=  
$str! *
;* +
private 
string 
[ 
] 

myAdjuntos #
;# $
private 
MailMessage 
mCorreo #
;# $
public 
CorreoManager 
( 
) 
{ 	
} 	
public 
void 
CrearCuerpoCorreo %
(% &
string& ,
destino- 4
,4 5
string6 <
asunto= C
,C D
stringE K
mensajeL S
,S T
stringU [
[[ \
]\ ]
adjuntos^ f
)f g
{ 	
mCorreo 
= 
new 
MailMessage %
(% &
)& '
;' (
mCorreo 
. 
From 
= 
new 
MailAddress *
(* +
myEmail+ 2
,2 3
MyAlias4 ;
,; <
System= C
.C D
TextD H
.H I
EncodingI Q
.Q R
UTF8R V
)V W
;W X
mCorreo 
. 
To 
. 
Add 
( 
destino "
." #
Trim# '
(' (
)( )
)) *
;* +
mCorreo 
. 
Subject 
= 
asunto $
.$ %
Trim% )
() *
)* +
;+ ,
mCorreo 
. 
Body 
= 
mensaje "
." #
Trim# '
(' (
)( )
;) *
mCorreo   
.   

IsBodyHtml   
=    
true  ! %
;  % &
mCorreo!! 
.!! 
Priority!! 
=!! 
MailPriority!! +
.!!+ ,
High!!, 0
;!!0 1
for## 
(## 
int## 
i## 
=## 
$num## 
;## 
i## 
<## 
adjuntos##  (
.##( )
Length##) /
;##/ 0
i##1 2
++##2 4
)##4 5
{$$ 
mCorreo%% 
.%% 
Attachments%% #
.%%# $
Add%%$ '
(%%' (
new%%( +

Attachment%%, 6
(%%6 7
adjuntos%%7 ?
[%%? @
i%%@ A
]%%A B
)%%B C
)%%C D
;%%D E
}&& 
}'' 	
public)) 
void)) 
Enviar)) 
()) 
))) 
{** 	
try++ 
{,, 

SmtpClient-- 
smtp-- 
=--  !
new--" %

SmtpClient--& 0
(--0 1
)--1 2
;--2 3
smtp.. 
... !
UseDefaultCredentials.. *
=..+ ,
false..- 2
;..2 3
smtp// 
.// 
Port// 
=// 
$num// 
;// 
smtp00 
.00 
Host00 
=00 
$str00 ,
;00, -
smtp11 
.11 
Credentials11  
=11! "
new11# &
NetworkCredential11' 8
(118 9
myEmail119 @
,11@ A

MyPassword11B L
)11L M
;11M N
ServicePointManager22 #
.22# $/
#ServerCertificateValidationCallback22$ G
=22H I
delegate22J R
(22S T
object22T Z
s22[ \
,22\ ]
X509Certificate22^ m
certificate22n y
,22y z
	X509Chain	22{ Ñ
chain
22Ö ä
,
22ä ã
SslPolicyErrors
22å õ
errors
22ú ¢
)
22¢ £
{
22§ •
return
22¶ ¨
true
22≠ ±
;
22± ≤
}
22≥ ¥
;
22¥ µ
smtp33 
.33 
	EnableSsl33 
=33  
true33! %
;33% &
smtp44 
.44 
Send44 
(44 
mCorreo44 !
)44! "
;44" #
}55 
catch66 
(66 
	Exception66 
e66 
)66 
{77 
throw88 
new88 
	Exception88 #
(88# $
$"88$ &
$str88& A
{88A B
e88B C
.88C D
Message88D K
}88K L
"88L M
)88M N
;88N O
}99 
}:: 	
};; 
}<< ∏
xC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsHclinica.cs
	namespace 	
ProyectoFinal
 
. 
Clases 
{		 
public

 

class

 
ClsHclinica

 
{ 
MSOFTVETDataContext 
dc 
=  
new! $
MSOFTVETDataContext% 8
(8 9
)9 :
;: ;
public 
int 

idpaciente 
{ 
get  #
;# $
set% (
;( )
}* +
public 
List 
<  
SP_HvacunacionResult (
>( )

VerVacunas* 4
(4 5
)5 6
{ 	
var 
consulta 
= 
new 
List #
<# $ 
SP_HvacunacionResult$ 8
>8 9
(9 :
): ;
;; <
consulta 
= 
dc 
. 
SP_Hvacunacion (
(( )

idpaciente) 3
)3 4
.4 5
ToList5 ;
(; <
)< =
;= >
return 
consulta 
. 
ToList "
(" #
)# $
;$ %
} 	
public 
List 
<  
SP_HRecetacionResult (
>( )

VerRecetas* 4
(4 5
)5 6
{ 	
var 
consulta 
= 
new 
List #
<# $ 
SP_HRecetacionResult$ 8
>8 9
(9 :
): ;
;; <
consulta 
= 
dc 
. 
SP_HRecetacion (
(( )

idpaciente) 3
)3 4
.4 5
ToList5 ;
(; <
)< =
;= >
return!! 
consulta!! 
.!! 
ToList!! "
(!!" #
)!!# $
;!!$ %
}"" 	
public## 
List## 
<## %
SP_HdesparacitacionResult## -
>##- . 
VerDesparacitaciones##/ C
(##C D
)##D E
{$$ 	
var%% 
consulta%% 
=%% 
new%% 
List%% #
<%%# $%
SP_HdesparacitacionResult%%$ =
>%%= >
(%%> ?
)%%? @
;%%@ A
consulta'' 
='' 
dc'' 
.'' 
SP_Hdesparacitacion'' -
(''- .

idpaciente''. 8
)''8 9
.''9 :
ToList'': @
(''@ A
)''A B
;''B C
return)) 
consulta)) 
.)) 
ToList)) "
())" #
)))# $
;))$ %
}** 	
}++ 
},, Ô
wC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsUsuario.cs
	namespace		 	
ProyectoFinal		
 
.		 
Clases		 
{

 
public 

class 

ClsUsuario 
{ 
public 
string 
usuario 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
contrase√±a  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	categoria 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
idemp 
{ 
get !
;! "
set# &
;& '
}( )
MSOFTVETDataContext 
dc 
=  
new! $
MSOFTVETDataContext% 8
(8 9
)9 :
;: ;
public 
void 
AgregarUsuario "
(" #
)# $
{ 	
try 
{ 
using 
( 
var 
dc 
= 
new  #
MSOFTVETDataContext$ 7
(7 8
)8 9
)9 :
{ 
dc 
. 
SP_AgregarUsuario (
(( )
usuario) 0
,0 1
contrase√±a2 <
,< =
	categoria= F
,F G
idempG L
)L M
;M N

MessageBox 
. 
Show #
(# $
$str$ T
,T U
$strV i
,i j
MessageBoxButtonsk |
.| }
OK} 
,	 Ä
MessageBoxIcon
Å è
.
è ê
Information
ê õ
)
õ ú
;
ú ù
} 
} 
catch   
{!! 

MessageBox"" 
."" 
Show"" 
(""  
$str""  V
,""V W
$str""X _
,""_ `
MessageBoxButtons""a r
.""r s
OK""s u
,""u v
MessageBoxIcon	""w Ö
.
""Ö Ü
Error
""Ü ã
)
""ã å
;
""å ç
}## 
}$$ 	
}%% 
}&& —D
xC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsPaciente.cs
	namespace 	
ProyectoFinal
 
. 
Clases 
{		 
internal

 
class

 
ClsPaciente

 
{ 
public 
int 
CodPaciente 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Especie 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Raza 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Sexo 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
FechaNacimiento '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
int 

CodCliente 
{ 
get  #
;# $
set% (
;( )
}* +
public 
static 
List 
< 
ClsPaciente &
>& '!
ObtenerListaPacientes( =
(= >
int> A

codClienteB L
)L M
{ 	
using 
( 
var 
dc 
= 
new 
MSOFTVETDataContext  3
(3 4
)4 5
)5 6
{ 
var 
consulta 
= 
from #
p$ %
in& (
dc) +
.+ ,

V_Paciente, 6
where $
p% &
.& '
Cod_Cliente' 2
==3 5

codCliente6 @
select %
new& )
ClsPaciente* 5
{  
CodPaciente# .
=/ 0
p1 2
.2 3
Cod_Paciente3 ?
,? @
Nombre# )
=* +
p, -
.- .
Nombre. 4
,4 5
Especie# *
=+ ,
p- .
.. /
Especie/ 6
,6 7
Raza# '
=( )
p* +
.+ ,
Raza, 0
,0 1
Sexo  # '
=  ( )
p  * +
.  + ,
Sexo  , 0
,  0 1
FechaNacimiento!!# 2
=!!3 4
p!!5 6
.!!6 7
Fecha!!7 <
,!!< =

CodCliente""# -
="". /
p""0 1
.""1 2
Cod_Cliente""2 =
}##  
;##  !
return$$ 
consulta$$ 
.$$  
ToList$$  &
($$& '
)$$' (
;$$( )
}%% 
}&& 	
public(( 
static(( 
ClsPaciente(( !$
ObtenerPacientePorCodigo((" :
(((: ;
int((; >
codPaciente((? J
)((J K
{)) 	
using** 
(** 
var** 
dc** 
=** 
new** 
MSOFTVETDataContext**  3
(**3 4
)**4 5
)**5 6
{++ 
var,, 
paciente,, 
=,, 
dc,, !
.,,! "

V_Paciente,," ,
.,,, -
FirstOrDefault,,- ;
(,,; <
p,,< =
=>,,> @
p,,A B
.,,B C
Cod_Paciente,,C O
==,,P R
codPaciente,,S ^
),,^ _
;,,_ `
if.. 
(.. 
paciente.. 
!=.. 
null..  $
)..$ %
{// 
return00 
new00 
ClsPaciente00 *
{11 
CodPaciente22 #
=22$ %
paciente22& .
.22. /
Cod_Paciente22/ ;
,22; <
Nombre33 
=33  
paciente33! )
.33) *
Nombre33* 0
,330 1
Especie44 
=44  !
paciente44" *
.44* +
Especie44+ 2
,442 3
Raza55 
=55 
paciente55 '
.55' (
Raza55( ,
,55, -
Sexo66 
=66 
paciente66 '
.66' (
Sexo66( ,
,66, -
FechaNacimiento77 '
=77( )
paciente77* 2
.772 3
Fecha773 8
,778 9

CodCliente88 "
=88# $
paciente88% -
.88- .
Cod_Cliente88. 9
}99 
;99 
}:: 
return;; 
null;; 
;;; 
}<< 
}== 	
public?? 
void?? "
ModificarEnBaseDeDatos?? *
(??* +
)??+ ,
{@@ 	
usingAA 
(AA 
varAA 
dcAA 
=AA 
newAA 
MSOFTVETDataContextAA  3
(AA3 4
)AA4 5
)AA5 6
{BB 
dcCC 
.CC  
SP_ModificarPacienteCC '
(CC' (
CodPacienteCC( 3
,CC3 4
NombreCC5 ;
,CC; <
EspecieCC= D
,CCD E
RazaCCF J
,CCJ K
SexoCCL P
,CCP Q
FechaNacimientoCCR a
)CCa b
;CCb c
}DD 
}EE 	
publicGG 
voidGG !
EliminarEnBaseDeDatosGG )
(GG) *
)GG* +
{HH 	
usingII 
(II 
varII 
dcII 
=II 
newII 
MSOFTVETDataContextII  3
(II3 4
)II4 5
)II5 6
{JJ 
dcKK 
.KK 
SP_EliminarPacienteKK &
(KK& '
CodPacienteKK' 2
)KK2 3
;KK3 4
}LL 
}MM 	
publicOO 
voidOO !
InsertarEnBaseDeDatosOO )
(OO) *
)OO* +
{PP 	
usingQQ 
(QQ 
varQQ 
dcQQ 
=QQ 
newQQ 
MSOFTVETDataContextQQ  3
(QQ3 4
)QQ4 5
)QQ5 6
{RR 
dcSS 
.SS 
SP_AgregarPacienteSS %
(SS% &
NombreSS& ,
,SS, -
EspecieSS. 5
,SS5 6
RazaSS7 ;
,SS; <
SexoSS= A
,SSA B
FechaNacimientoSSC R
,SSR S

CodClienteSST ^
.SS^ _
ToStringSS_ g
(SSg h
)SSh i
)SSi j
;SSj k
}TT 
}UU 	
publicWW 
boolWW 
ValidarDatosWW  
(WW  !
)WW! "
{XX 	
returnYY 
!YY 
stringYY 
.YY 
IsNullOrEmptyYY (
(YY( )
NombreYY) /
)YY/ 0
&&YY1 3
!YY4 5
stringYY5 ;
.YY; <
IsNullOrEmptyYY< I
(YYI J
EspecieYYJ Q
)YYQ R
&&YYS U
!YYV W
stringYYW ]
.YY] ^
IsNullOrEmptyYY^ k
(YYk l
RazaYYl p
)YYp q
;YYq r
}ZZ 	
public\\ 
static\\ 
List\\ 
<\\ 
ClsPaciente\\ &
>\\& '

CargarTodo\\( 2
(\\2 3
)\\3 4
{]] 	
using^^ 
(^^ 
var^^ 
dc^^ 
=^^ 
new^^ 
MSOFTVETDataContext^^  3
(^^3 4
)^^4 5
)^^5 6
{__ 
var`` 
consulta`` 
=`` 
from`` #
p``$ %
in``& (
dc``) +
.``+ ,

V_Paciente``, 6
selectaa %
newaa& )
ClsPacienteaa* 5
{bb  
CodPacientecc# .
=cc/ 0
pcc1 2
.cc2 3
Cod_Pacientecc3 ?
,cc? @
Nombredd# )
=dd* +
pdd, -
.dd- .
Nombredd. 4
,dd4 5
Especieee# *
=ee+ ,
pee- .
.ee. /
Especieee/ 6
,ee6 7
Razaff# '
=ff( )
pff* +
.ff+ ,
Razaff, 0
,ff0 1
Sexogg# '
=gg( )
pgg* +
.gg+ ,
Sexogg, 0
,gg0 1
FechaNacimientohh# 2
=hh3 4
phh5 6
.hh6 7
Fechahh7 <
,hh< =

CodClienteii# -
=ii. /
pii0 1
.ii1 2
Cod_Clienteii2 =
}jj  
;jj  !
returnkk 
consultakk 
.kk  
ToListkk  &
(kk& '
)kk' (
;kk( )
}ll 
}mm 	
}nn 
}oo ∂`
~C:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsDesparasitante.cs
	namespace

 	
ProyectoFinal


 
.

 
Clases

 
{ 
public 

class 
ClsDesparasitante "
{ 
MSOFTVETDataContext 
dc 
=  
new! $
MSOFTVETDataContext% 8
(8 9
)9 :
;: ;
public 
int 
id_disparasitacion %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
string 
Tipo 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
fecha 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Cod_Paciente "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
dni 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 

codCliente  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	idCliente 
{  !
get" %
;% &
set' *
;* +
}, -
public$$ 
void$$ 
CargarCliente$$ !
($$! "
TextBox$$" )
txtDNI$$* 0
,$$0 1
TextBox$$2 9
txtNombreCliente$$: J
,$$J K
TextBox$$L S
txtCodCliente$$T a
)$$a b
{%% 	
MSOFTVETDataContext&& 
dc&&  "
=&&# $
new&&% (
MSOFTVETDataContext&&) <
(&&< =
)&&= >
;&&> ?
string'' 
dniBusqueda'' 
=''  
txtDNI''! '
.''' (
Text''( ,
;'', -
var)) 
clienteEncontrado)) !
=))" #
dc))$ &
.))& '
	V_Cliente))' 0
.))0 1
FirstOrDefault))1 ?
())? @
c))@ A
=>))B D
c))E F
.))F G
DNI))G J
==))K M
dniBusqueda))N Y
)))Y Z
;))Z [
if++ 
(++ 
clienteEncontrado++ !
!=++" $
null++% )
)++) *
{,, 
txtNombreCliente--  
.--  !
Text--! %
=--& '
clienteEncontrado--( 9
.--9 :
Nombre--: @
;--@ A
txtCodCliente.. 
... 
Text.. "
=..# $
clienteEncontrado..% 6
...6 7
Cod_Cliente..7 B
...B C
ToString..C K
(..K L
)..L M
;..M N
	idCliente// 
=// 
clienteEncontrado// -
.//- .
Cod_Cliente//. 9
.//9 :
ToString//: B
(//B C
)//C D
;//D E
}00 
else11 
{22 
txtNombreCliente33  
.33  !
Text33! %
=33& '
$str33( ?
;33? @
}44 
}55 	
public88 
void88 
CargarMascota88 !
(88! "
DataGridView88" .
dgvPacientes88/ ;
)88; <
{99 	
MSOFTVETDataContext:: 
dc::  "
=::# $
new::% (
MSOFTVETDataContext::) <
(::< =
)::= >
;::> ?
string;; !
codigoClienteBusqueda;; (
=;;) *
	idCliente;;+ 4
;;;4 5
var@@ 
	pacientes@@ 
=@@ 
dc@@ 
.@@ 

V_Paciente@@ )
.AA 
WhereAA 
(AA 
pAA 
=>AA 
pAA 
.AA 
Cod_ClienteAA (
.AA( )
ToStringAA) 1
(AA1 2
)AA2 3
==AA4 6!
codigoClienteBusquedaAA7 L
)AAL M
.BB 
SelectBB 
(BB 
pBB 
=>BB 
newBB 
{CC 
IDDD 
=DD 
pDD 
.DD 
Cod_PacienteDD &
,DD& '
pEE 
.EE 
NombreEE 
}FF 
)FF 
.GG 
ToListGG 
(GG 
)GG 
;GG 
ifHH 
(HH 
	pacientesHH 
.HH 
CountHH 
>HH  !
$numHH" #
)HH# $
{II 
dgvPacientesJJ 
.JJ 

DataSourceJJ '
=JJ( )
	pacientesJJ* 3
;JJ3 4
dgvPacientesKK 
.KK 
ColumnsKK $
[KK$ %
$numKK% &
]KK& '
.KK' (
WidthKK( -
=KK. /
$numKK0 2
;KK2 3
}MM 
elseNN 
{OO 

MessageBoxPP 
.PP 
ShowPP 
(PP  
$strPP  r
,PPr s
$str	PPt Ü
,
PPÜ á
MessageBoxButtons
PPà ô
.
PPô ö
OK
PPö ú
,
PPú ù
MessageBoxIcon
PPû ¨
.
PP¨ ≠
Warning
PP≠ ¥
)
PP¥ µ
;
PPµ ∂
}QQ 
}RR 	
publicTT 
voidTT 
InsertarTT 
(TT 
ComboBoxTT %
cmbTipoTT& -
,TT- .
DateTimePickerTT/ =#
datePickDesparasitacionTT> U
,TTU V
TextBoxTTW ^
txtidPacienteTT_ l
)TTl m
{UU 	
tryVV 
{WW 
ifXX 
(XX 
!XX 
stringXX 
.XX 
IsNullOrWhiteSpaceXX .
(XX. /
cmbTipoXX/ 6
.XX6 7
TextXX7 ;
)XX; <
&&XX= ?
!XX@ A
stringXXA G
.XXG H
IsNullOrWhiteSpaceXXH Z
(XXZ [
txtidPacienteXX[ h
.XXh i
TextXXi m
)XXm n
)XXn o
{YY 
TipoZZ 
=ZZ 
cmbTipoZZ "
.ZZ" #
TextZZ# '
;ZZ' (
fecha[[ 
=[[ #
datePickDesparasitacion[[ 3
.[[3 4
Value[[4 9
;[[9 :
Cod_Paciente\\  
=\\! "
txtidPaciente\\# 0
.\\0 1
Text\\1 5
;\\5 6
using^^ 
(^^ 
var^^ 
dc^^ !
=^^" #
new^^$ '
MSOFTVETDataContext^^( ;
(^^; <
)^^< =
)^^= >
{__ 
dc`` 
.`` &
SP_Agregar_Desparasitacion`` 5
(``5 6
Tipo``6 :
,``: ;
fecha``< A
,``A B
Cod_Paciente``C O
)``O P
;``P Q
}aa 

MessageBoxcc 
.cc 
Showcc #
(cc# $
$strcc$ U
,ccU V
$strccW r
,ccr s
MessageBoxButtons	cct Ö
.
ccÖ Ü
OK
ccÜ à
,
ccà â
MessageBoxIcon
ccä ò
.
ccò ô
Information
ccô §
)
cc§ •
;
cc• ¶
}dd 
elseee 
{ff 

MessageBoxgg 
.gg 
Showgg #
(gg# $
$strgg$ m
,ggm n
$str	ggo É
,
ggÉ Ñ
MessageBoxButtons
ggÖ ñ
.
ggñ ó
OK
ggó ô
,
ggô ö
MessageBoxIcon
ggõ ©
.
gg© ™
Warning
gg™ ±
)
gg± ≤
;
gg≤ ≥
}hh 
}ii 
catchjj 
(jj 
	Exceptionjj 
exjj 
)jj  
{kk 

MessageBoxll 
.ll 
Showll 
(ll  
$strll  G
+llH I
exllJ L
,llL M
$strllN U
,llU V
MessageBoxButtonsllW h
.llh i
OKlli k
,llk l
MessageBoxIconllm {
.ll{ |
Error	ll| Å
)
llÅ Ç
;
llÇ É
}mm 
}nn 	
publicpp 
voidpp 

Actualizarpp 
(pp 
ClsDesparasitantepp 0
objDesparasitacionpp1 C
)ppC D
{qq 	
tryrr 
{ss 
usingtt 
(tt 
vartt 
dctt 
=tt 
newtt  #
MSOFTVETDataContexttt$ 7
(tt7 8
)tt8 9
)tt9 :
{uu 
dcww 
.ww (
SP_Modificar_Desparasitacionww 3
(ww3 4
objDesparasitacionxx *
.xx* +
id_disparasitacionxx+ =
,xx= >
objDesparasitacionyy *
.yy* +
Tipoyy+ /
,yy/ 0
objDesparasitacionzz *
.zz* +
fechazz+ 0
,zz0 1
objDesparasitacion{{ *
.{{* +
Cod_Paciente{{+ 7
)|| 
;|| 
}}} 

MessageBox 
. 
Show 
(  
$str  T
,T U
$strV r
,r s
MessageBoxButtons	t Ö
.
Ö Ü
OK
Ü à
,
à â
MessageBoxIcon
ä ò
.
ò ô
Information
ô §
)
§ •
;
• ¶
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÇÇ 

MessageBox
ÑÑ 
.
ÑÑ 
Show
ÑÑ 
(
ÑÑ  
$str
ÑÑ  G
+
ÑÑH I
ex
ÑÑJ L
.
ÑÑL M
Message
ÑÑM T
,
ÑÑT U
$str
ÑÑV ]
,
ÑÑ] ^
MessageBoxButtons
ÑÑ_ p
.
ÑÑp q
OK
ÑÑq s
,
ÑÑs t
MessageBoxIconÑÑu É
.ÑÑÉ Ñ
ErrorÑÑÑ â
)ÑÑâ ä
;ÑÑä ã
}
ÖÖ 
}
ÜÜ 	
public
àà 
void
àà 
Eliminar
àà 
(
àà 
int
àà  
idDesparasitacion
àà! 2
)
àà2 3
{
ââ 	
try
ää 
{
ãã 
dc
çç 
.
çç )
SP_Eliminar_Desparasitacion
çç .
(
çç. /
idDesparasitacion
çç/ @
)
çç@ A
;
ççA B

MessageBox
èè 
.
èè 
Show
èè 
(
èè  
$str
èè  R
,
èèR S
$str
èèT n
,
èèn o 
MessageBoxButtonsèèp Å
.èèÅ Ç
OKèèÇ Ñ
,èèÑ Ö
MessageBoxIconèèÜ î
.èèî ï
Informationèèï †
)èè† °
;èè° ¢
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
íí 

MessageBox
îî 
.
îî 
Show
îî 
(
îî  
$str
îî  E
+
îîF G
ex
îîH J
.
îîJ K
Message
îîK R
,
îîR S
$str
îîT [
,
îî[ \
MessageBoxButtons
îî] n
.
îîn o
OK
îîo q
,
îîq r
MessageBoxIconîîs Å
.îîÅ Ç
ErrorîîÇ á
)îîá à
;îîà â
}
ïï 
}
ññ 	
public
óó 
void
óó "
ListarDesparasitados
óó (
(
óó( )
DataGridView
óó) 5
dgvDesparasitados
óó6 G
)
óóG H
{
òò 	!
MSOFTVETDataContext
ôô 
dc
ôô  "
=
ôô# $
new
ôô% (!
MSOFTVETDataContext
ôô) <
(
ôô< =
)
ôô= >
;
ôô> ?
var
öö 
consulta
öö 
=
öö 
dc
öö 
.
öö 
V_Desparasitacion
öö /
.
öö/ 0
ToList
öö0 6
(
öö6 7
)
öö7 8
;
öö8 9
dgvDesparasitados
õõ 
.
õõ 

DataSource
õõ (
=
õõ) *
consulta
õõ+ 3
;
õõ3 4
dgvDesparasitados
úú 
.
úú 
Columns
úú %
[
úú% &
$num
úú& '
]
úú' (
.
úú( )
Width
úú) .
=
úú/ 0
$num
úú1 3
;
úú3 4
}
ùù 	
}
££ 
}§§ €8
wC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsCliente.cs
	namespace		 	
ProyectoFinal		
 
.		 
Clases		 
{

 
public 

class 

ClsCliente 
{ 
public 
int 

CodCliente 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
DNI 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Telefono 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Direccion 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Genero 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Correo 
{ 
get "
;" #
set$ '
;' (
}) *
public 
bool 
ValidarDatos  
(  !
)! "
{ 	
return 
! 
string 
. 
IsNullOrEmpty (
(( )
Nombre) /
)/ 0
&&1 3
!4 5
string5 ;
.; <
IsNullOrEmpty< I
(I J
DNIJ M
)M N
&&O Q
DNIR U
.U V
LengthV \
==] _
$num` a
;a b
} 	
public 
static 
bool 
ExisteClientePorDNI .
(. /
string/ 5
dni6 9
)9 :
{ 	
using 
( 
var 
dc 
= 
new 
MSOFTVETDataContext  3
(3 4
)4 5
)5 6
{ 
return 
dc 
. 
	V_Cliente #
.# $
Any$ '
(' (
x( )
=>* ,
x- .
.. /
DNI/ 2
==3 5
dni6 9
)9 :
;: ;
}   
}!! 	
public## 
void## !
InsertarEnBaseDeDatos## )
(##) *
)##* +
{$$ 	
using%% 
(%% 
var%% 
dc%% 
=%% 
new%% 
MSOFTVETDataContext%%  3
(%%3 4
)%%4 5
)%%5 6
{&& 
dc'' 
.'' 
SP_AgregarCliente'' $
(''$ %
Nombre''% +
,''+ ,
Apellido''- 5
,''5 6
Telefono''7 ?
,''? @
Genero''A G
,''G H
DNI''I L
,''L M
	Direccion''N W
,''W X
Correo''X ^
)''^ _
;''_ `
}(( 
})) 	
public++ 
void++ "
ModificarEnBaseDeDatos++ *
(++* +
)+++ ,
{,, 	
using-- 
(-- 
var-- 
dc-- 
=-- 
new-- 
MSOFTVETDataContext--  3
(--3 4
)--4 5
)--5 6
{.. 
var// 
clienteExistente// $
=//% &
dc//' )
.//) *
	V_Cliente//* 3
.//3 4
FirstOrDefault//4 B
(//B C
x//C D
=>//E G
x//H I
.//I J
DNI//J M
==//N P
DNI//Q T
&&//U W
x//X Y
.//Y Z
Cod_Cliente//Z e
==//f h

CodCliente//i s
)//s t
;//t u
if11 
(11 
clienteExistente11 $
!=11% '
null11( ,
)11, -
{22 
dc33 
.33 
SP_ModificarCliente33 *
(33* +

CodCliente33+ 5
,335 6
Nombre337 =
,33= >
Apellido33? G
,33G H
Telefono33I Q
,33Q R
Genero33S Y
,33Y Z
DNI33[ ^
,33^ _
	Direccion33` i
,33i j
Correo33j p
)33p q
;33q r
}44 
}55 
}66 	
public88 
void88 !
EliminarEnBaseDeDatos88 )
(88) *
)88* +
{99 	
using:: 
(:: 
var:: 
dc:: 
=:: 
new:: 
MSOFTVETDataContext::  3
(::3 4
)::4 5
)::5 6
{;; 
var<< 
clienteExistente<< $
=<<% &
dc<<' )
.<<) *
	V_Cliente<<* 3
.<<3 4
FirstOrDefault<<4 B
(<<B C
x<<C D
=><<E G
x<<H I
.<<I J
Cod_Cliente<<J U
==<<V X

CodCliente<<Y c
)<<c d
;<<d e
if>> 
(>> 
clienteExistente>> $
!=>>% '
null>>( ,
)>>, -
{?? 
dc@@ 
.@@ 
SP_EliminarCliente@@ )
(@@) *

CodCliente@@* 4
)@@4 5
;@@5 6
}AA 
}BB 
}CC 	
publicEE 
staticEE 
ListEE 
<EE 

ClsClienteEE %
>EE% & 
ObtenerListaClientesEE' ;
(EE; <
)EE< =
{FF 	
usingGG 
(GG 
varGG 
dcGG 
=GG 
newGG 
MSOFTVETDataContextGG  3
(GG3 4
)GG4 5
)GG5 6
{HH 
varII 
consultaII 
=II 
fromII #
xII$ %
inII& (
dcII) +
.II+ ,
	V_ClienteII, 5
selectJJ %
newJJ& )

ClsClienteJJ* 4
{KK  

CodClienteLL# -
=LL. /
xLL0 1
.LL1 2
Cod_ClienteLL2 =
,LL= >
NombreMM# )
=MM* +
xMM, -
.MM- .
NombreMM. 4
,MM4 5
ApellidoNN# +
=NN, -
xNN. /
.NN/ 0
ApellidoNN0 8
,NN8 9
DNIOO# &
=OO' (
xOO) *
.OO* +
DNIOO+ .
,OO. /
TelefonoPP# +
=PP, -
xPP. /
.PP/ 0
TelefonoPP0 8
,PP8 9
	DireccionQQ# ,
=QQ- .
xQQ/ 0
.QQ0 1

Direcci√≥nQQ1 :
,QQ: ;
GeneroRR# )
=RR* +
xRR, -
.RR- .
G√©neroRR. 4
,RR4 5
CorreoSS# )
=SS* +
xSS, -
.SS- .
CorreoSS. 4
}TT  
;TT  !
returnVV 
consultaVV 
.VV  
ToListVV  &
(VV& '
)VV' (
;VV( )
}WW 
}XX 	
}YY 
}ZZ ¢<
xC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsEmpleado.cs
	namespace 	
ProyectoFinal
 
. 
Clases 
{		 
internal

 
class

 
ClsEmpleado

 
{ 
public 
int 
CodEmpleado 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
DNI 
{ 
get 
;  
set! $
;$ %
}& '
public 
DateTime 
FechaNacimiento '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
Genero 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Telefono 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
DateTime 
FechaInicio #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
string 
Cargo 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Horario 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
Sueldo 
{ 
get 
;  
set! $
;$ %
}& '
public 
static 
List 
< 
ClsEmpleado &
>& '!
ObtenerListaEmpleados( =
(= >
)> ?
{ 	
using 
( 
var 
dc 
= 
new 
MSOFTVETDataContext  3
(3 4
)4 5
)5 6
{ 
var 
consulta 
= 
from #
e$ %
in& (
dc) +
.+ ,

V_Empleado, 6
select %
new& )
ClsEmpleado* 5
{  
CodEmpleado# .
=/ 0
e1 2
.2 3
Cod_Empleado3 ?
,? @
Nombre  # )
=  * +
e  , -
.  - .
Nombre  . 4
,  4 5
Apellido!!# +
=!!, -
e!!. /
.!!/ 0
Apellido!!0 8
,!!8 9
DNI""# &
=""' (
e"") *
.""* +
DNI""+ .
,"". /
FechaNacimiento### 2
=##3 4
e##5 6
.##6 7
FechaNacimiento##7 F
,##F G
Genero$$# )
=$$* +
e$$, -
.$$- .
Sexo$$. 2
,$$2 3
Telefono%%# +
=%%, -
e%%. /
.%%/ 0
Telefono%%0 8
,%%8 9
FechaInicio&&# .
=&&/ 0
e&&1 2
.&&2 3
Fecha_Ingreso&&3 @
,&&@ A
Cargo''# (
='') *
e''+ ,
.'', -
Cargo''- 2
,''2 3
Horario((# *
=((+ ,
e((- .
.((. /
Horario((/ 6
,((6 7
Sueldo))# )
=))* +
()), -
int))- 0
)))0 1
e))1 2
.))2 3
Sueldo))3 9
}**  
;**  !
return++ 
consulta++ 
.++  
ToList++  &
(++& '
)++' (
;++( )
},, 
}-- 	
public// 
void// !
InsertarEnBaseDeDatos// )
(//) *
)//* +
{00 	
using11 
(11 
var11 
dc11 
=11 
new11 
MSOFTVETDataContext11  3
(113 4
)114 5
)115 6
{22 
dc33 
.33 
SP_AgregarEmpleado33 %
(33% &
Nombre33& ,
,33, -
Apellido33. 6
,336 7
DNI338 ;
,33; <
Convert33= D
.33D E
ToString33E M
(33M N
FechaNacimiento33N ]
)33] ^
,33^ _
Genero33` f
,33f g
Telefono33h p
,33p q
Convert33r y
.33y z
ToString	33z Ç
(
33Ç É
FechaInicio
33É é
)
33é è
,
33è ê
Cargo
33ë ñ
,
33ñ ó
Horario
33ò ü
,
33ü †
Sueldo
33° ß
.
33ß ®
ToString
33® ∞
(
33∞ ±
)
33± ≤
)
33≤ ≥
;
33≥ ¥
}44 
}55 	
public77 
static77 
bool77  
ExisteEmpleadoPorDNI77 /
(77/ 0
string770 6
dni777 :
)77: ;
{88 	
using99 
(99 
var99 
dc99 
=99 
new99 
MSOFTVETDataContext99  3
(993 4
)994 5
)995 6
{:: 
return;; 
dc;; 
.;; 

V_Empleado;; $
.;;$ %
Any;;% (
(;;( )
x;;) *
=>;;+ -
x;;. /
.;;/ 0
DNI;;0 3
==;;4 6
dni;;7 :
);;: ;
;;;; <
}<< 
}== 	
public@@ 
void@@ "
ModificarEnBaseDeDatos@@ *
(@@* +
)@@+ ,
{AA 	
usingBB 
(BB 
varBB 
dcBB 
=BB 
newBB 
MSOFTVETDataContextBB  3
(BB3 4
)BB4 5
)BB5 6
{CC 
dcDD 
.DD  
SP_ModificarEmpleadoDD '
(DD' (
CodEmpleadoDD( 3
,DD3 4
NombreDD5 ;
,DD; <
ApellidoDD= E
,DDE F
DNIDDG J
,DDJ K
FechaNacimientoDDL [
,DD[ \
GeneroDD] c
,DDc d
TelefonoDDe m
,DDm n
FechaInicioDDo z
,DDz {
Cargo	DD| Å
,
DDÅ Ç
Horario
DDÉ ä
,
DDä ã
Sueldo
DDå í
)
DDí ì
;
DDì î
}EE 
}FF 	
publicHH 
voidHH !
EliminarEnBaseDeDatosHH )
(HH) *
)HH* +
{II 	
usingJJ 
(JJ 
varJJ 
dcJJ 
=JJ 
newJJ 
MSOFTVETDataContextJJ  3
(JJ3 4
)JJ4 5
)JJ5 6
{KK 
dcLL 
.LL 
SP_EliminarEmpleadoLL &
(LL& '
CodEmpleadoLL' 2
)LL2 3
;LL3 4
}MM 
}NN 	
publicPP 
boolPP 
ValidarDatosPP  
(PP  !
)PP! "
{QQ 	
returnRR 
!RR 
stringRR 
.RR 
IsNullOrEmptyRR (
(RR( )
NombreRR) /
)RR/ 0
&&RR1 3
!RR4 5
stringRR5 ;
.RR; <
IsNullOrEmptyRR< I
(RRI J
ApellidoRRJ R
)RRR S
&&RRT V
!RRW X
stringRRX ^
.RR^ _
IsNullOrEmptyRR_ l
(RRl m
DNIRRm p
)RRp q
&&RRr t
SueldoRRu {
>RR| }
$numRR~ 
;	RR Ä
}SS 	
}TT 
}UU Ì!
tC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ClsCita.cs
	namespace

 	
ProyectoFinal


 
.

 
Clases

 
{ 
public 

class 
ClsCita 
{ 
MSOFTVETDataContext 
dc 
=  
new! $
MSOFTVETDataContext% 8
(8 9
)9 :
;: ;
public 
List 
< 
V_CargarCitas !
>! "
ObtenerTodasCitas# 4
(4 5
)5 6
{ 	
return 
dc 
. 
V_CargarCitas #
.# $
ToList$ *
(* +
)+ ,
;, -
} 	
public 
List 
< 
V_CargarCitas !
>! " 
ObtenerCitasPorFecha# 7
(7 8
DateTime8 @
fechaA F
)F G
{ 	
return 
dc 
. 
V_CargarCitas #
.# $
Where$ )
() *
c* +
=>, .
c/ 0
.0 1
Fecha1 6
==7 9
fecha: ?
)? @
.@ A
OrderByA H
(H I
cI J
=>K M
cN O
.O P
FechaP U
)U V
.V W
ThenByW ]
(] ^
c^ _
=>` b
cc d
.d e
Horae i
)i j
.j k
ToListk q
(q r
)r s
;s t
} 	
public 
List 
< 
V_CargarCitas !
>! "!
ObtenerCitasPorEstado# 8
(8 9
string9 ?
estado@ F
)F G
{ 	
var 
citas 
= 
dc 
. 
V_CargarCitas (
.( )
Where) .
(. /
c/ 0
=>1 3
c4 5
.5 6
Estado6 <
=== ?
estado@ F
)F G
;G H
if 
( 
estado 
== 
$str %
)% &
{ 
citas   
=   
citas   
.   
OrderBy   %
(  % &
c  & '
=>  ( *
c  + ,
.  , -
Fecha  - 2
)  2 3
.  3 4
ThenBy  4 :
(  : ;
c  ; <
=>  = ?
c  @ A
.  A B
Hora  B F
)  F G
;  G H
}!! 
else"" 
{## 
citas$$ 
=$$ 
citas$$ 
.$$ 
OrderByDescending$$ /
($$/ 0
c$$0 1
=>$$2 4
c$$5 6
.$$6 7
Fecha$$7 <
)$$< =
.$$= >
ThenByDescending$$> N
($$N O
c$$O P
=>$$Q S
c$$T U
.$$U V
Hora$$V Z
)$$Z [
;$$[ \
}%% 
return&& 
citas&& 
.&& 
ToList&& 
(&&  
)&&  !
;&&! "
}'' 	
public)) 
void)) 
CancelarCita))  
())  !
int))! $
idCita))% +
)))+ ,
{** 	
dc++ 
.++ 
SP_CancelarCita++ 
(++ 
idCita++ %
)++% &
;++& '
},, 	
public.. 
List.. 
<.. 
V_CargarCitas.. !
>..! "
Cargar..# )
(..) *
)..* +
{// 	
return00 
dc00 
.00 
V_CargarCitas00 #
.11 
Where11 
(11 
c11 
=>11  
c11! "
.11" #
Estado11# )
==11* ,
$str11- 8
)118 9
.22 
OrderBy22 
(22 
c22 
=>22  "
c22# $
.22$ %
Fecha22% *
)22* +
.33 
ThenBy33 
(33 
c33 
=>33 !
c33" #
.33# $
Hora33$ (
)33( )
.44 
ToList44 
(44 
)44 
;44 
}55 	
}66 
}77 ñ
uC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\Clases\ApisPeru.cs
	namespace 	
ProyectoFinal
 
. 
Clases 
{ 
class 	
ApisPeru
 
{ 
public 
dynamic 
Get 
( 
string !
url" %
)% &
{ 	
HttpWebRequest 
myWebRequest '
=( )
(* +
HttpWebRequest+ 9
)9 :

WebRequest: D
.D E
CreateE K
(K L
urlL O
)O P
;P Q
myWebRequest 
. 
	UserAgent "
=# $
$str% o
;o p
myWebRequest 
. 
Credentials $
=% &
CredentialCache' 6
.6 7
DefaultCredentials7 I
;I J
myWebRequest 
. 
Proxy 
=  
null! %
;% &
HttpWebResponse 
myHttpWebResponse -
=. /
(0 1
HttpWebResponse1 @
)@ A
myWebRequestA M
.M N
GetResponseN Y
(Y Z
)Z [
;[ \
Stream 
myStream 
= 
myHttpWebResponse /
./ 0
GetResponseStream0 A
(A B
)B C
;C D
StreamReader 
myStreamReader '
=( )
new* -
StreamReader. :
(: ;
myStream; C
)C D
;D E
string 
Datos 
= 
HttpUtility &
.& '

HtmlDecode' 1
(1 2
myStreamReader2 @
.@ A
	ReadToEndA J
(J K
)K L
)L M
;M N
dynamic 
data 
= 
JsonConvert &
.& '
DeserializeObject' 8
(8 9
Datos9 >
)> ?
;? @
return 
data 
; 
}   	
}!! 
}"" ñF
ÄC:\Users\Jaimeelias\Music\repo_sabado\proyecto-si784-2024-ii-u1-chambi_floresq_leyva\ProyectoFinal\ActualizarRegistroEmpleado.cs
	namespace 	
ProyectoFinal
 
{ 
public 

partial 
class &
ActualizarRegistroEmpleado 3
:4 5
Form6 :
{ 
bool 
existe 
= 
false 
; 
string 
codigo 
, 
nomemp 
, 
apeemp %
,% &
dniemp' -
,- .
Fechnac/ 6
,6 7
genero8 >
,> ?
telf@ D
,D E
FechiniF M
,M N
cargoO T
,T U
horarioV ]
;] ^
int 
sueldo 
; 
int 
ubicacionfila 
= 
$num 
; 
public 
void 
Limpieza 
( 
) 
{ 	
	cmbGenero 
. 
SelectedIndex #
=$ %
-& '
$num' (
;( )

cmbHorario 
. 
SelectedIndex $
=% &
-' (
$num( )
;) *
txtApellido 
. 
Text 
= 
$str !
;! "
txtCargo 
. 
Text 
= 
$str 
; 
	txtNombre 
. 
Text 
= 
string #
.# $
Empty$ )
;) *
txtDni 
. 
Text 
= 
string  
.  !
Empty! &
;& '
txtTelefono 
. 
Text 
= 
string %
.% &
Empty& +
;+ ,
	txtSueldo   
.   
Text   
=   
string   #
.  # $
Empty  $ )
;  ) *
}!! 	
private## 
void## 
btnLimpiar_Click## %
(##% &
object##& ,
sender##- 3
,##3 4
	EventArgs##5 >
e##? @
)##@ A
{$$ 	
Limpieza%% 
(%% 
)%% 
;%% 
}&& 	
private(( 
void(( 
btnGuardar_Click_1(( '
(((' (
object((( .
sender((/ 5
,((5 6
	EventArgs((7 @
e((A B
)((B C
{)) 	
int** 
lineaAEditar** 
=** 
ubicacionfila** ,
;**, - 
RecopilarInformacion--  
(--  !
)--! "
;--" #
string// 

nuevaLinea// 
=// 
codigo//  &
+//' (
$str//) ,
+//- .
nomemp/// 5
+//6 7
$str//8 ;
+//< =
apeemp//> D
+//E F
$str//G J
+//K L
dniemp//M S
+//T U
$str//V Y
+//Z [
Fechnac//\ c
+//d e
$str00, /
+000 1
genero002 8
+009 :
$str00; >
+00? @
telf00A E
+00F G
$str00H K
+00L M
Fechini00N U
+00V W
$str00X [
+00\ ]
cargo00^ c
+00d e
$str11, /
+110 1
horario112 9
+11: ;
$str11< ?
+11@ A
sueldo11B H
;11H I
}22 	
private44 
void44 
button1_Click_144 $
(44$ %
object44% +
sender44, 2
,442 3
	EventArgs444 =
e44> ?
)44? @
{55 	
Buscarempleado66 
(66 
)66 
;66 
}77 	
public99 &
ActualizarRegistroEmpleado99 )
(99) *
)99* +
{:: 	
InitializeComponent;; 
(;;  
);;  !
;;;! "
}<< 	
private>> 
void>> 
label2_Click>> !
(>>! "
object>>" (
sender>>) /
,>>/ 0
	EventArgs>>1 :
e>>; <
)>>< =
{?? 	
}AA 	
publicBB 
voidBB 
BuscarempleadoBB "
(BB" #
)BB# $
{CC 	
stringDD 
busquedaDD 
;DD 
busquedaEE 
=EE 
	txtCodigoEE  
.EE  !
TextEE! %
;EE% &
}FF 	
privateHH 
voidHH +
ActualizarRegistroEmpleado_LoadHH 4
(HH4 5
objectHH5 ;
senderHH< B
,HHB C
	EventArgsHHD M
eHHN O
)HHO P
{II 	
}KK 	
publicLL 
voidLL  
RecopilarInformacionLL (
(LL( )
)LL) *
{MM 	
tryOO 
{PP 
codigoQQ 
=QQ 
	txtCodigoQQ "
.QQ" #
TextQQ# '
;QQ' (
nomempRR 
=RR 
	txtNombreRR "
.RR" #
TextRR# '
;RR' (
apeempSS 
=SS 
txtApellidoSS $
.SS$ %
TextSS% )
;SS) *
dniempTT 
=TT 
txtDniTT 
.TT  
TextTT  $
;TT$ %
FechnacUU 
=UU 
dtpFechaNacimientoUU ,
.UU, -
ValueUU- 2
.UU2 3
DateUU3 7
.UU7 8
ToStringUU8 @
(UU@ A
$strUUA M
)UUM N
;UUN O
SexoVV 
(VV 
)VV 
;VV 
telfWW 
=WW 
txtTelefonoWW "
.WW" #
TextWW# '
;WW' (
FechiniXX 
=XX 
dtpFechaInicioXX (
.XX( )
ValueXX) .
.XX. /
DateXX/ 3
.XX3 4
ToStringXX4 <
(XX< =
$strXX= I
)XXI J
;XXJ K
cargoYY 
=YY 
txtCargoYY  
.YY  !
TextYY! %
;YY% &
HorarioZZ 
(ZZ 
)ZZ 
;ZZ 
if[[ 
([[ 
	txtSueldo[[ 
.[[ 
Text[[ "
!=[[# %
$str[[& (
&&[[) +
	txtSueldo[[, 5
.[[5 6
Text[[6 :
.[[: ;
All[[; >
([[> ?
char[[? C
.[[C D
IsDigit[[D K
)[[K L
)[[L M
{\\ 
sueldo]] 
=]] 
Convert]] $
.]]$ %
ToInt32]]% ,
(]], -
	txtSueldo]]- 6
.]]6 7
Text]]7 ;
)]]; <
;]]< =
}^^ 
else__ 
{`` 

MessageBoxaa 
.aa 
Showaa #
(aa# $
$straa$ A
,aaA B
$straaC J
)aaJ K
;aaK L
}bb 
}dd 
catchee 
{ff 

MessageBoxgg 
.gg 
Showgg 
(gg  
$strgg  9
,gg9 :
$strgg; B
)ggB C
;ggC D
}hh 
}ii 	
privatejj 
voidjj 
Sexojj 
(jj 
)jj 
{kk 	
ifll 
(ll 
	cmbGeneroll 
.ll 
SelectedIndexll '
==ll( *
$numll+ ,
)ll, -
{mm 
generonn 
=nn 
$strnn $
;nn$ %
}oo 
elsepp 
ifpp 
(pp 
	cmbGeneropp 
.pp 
SelectedIndexpp ,
==pp- /
$numpp0 1
)pp1 2
{qq 
generorr 
=rr 
$strrr #
;rr# $
}ss 
elsett 
{uu 
generovv 
=vv 
$strvv  
;vv  !
}ww 
}xx 	
privateyy 
voidyy 
Horarioyy 
(yy 
)yy 
{zz 	
if{{ 
({{ 

cmbHorario{{ 
.{{ 
SelectedIndex{{ (
=={{) +
$num{{, -
){{- .
{|| 
horario}} 
=}} 
$str}} /
;}}/ 0
}~~ 
else 
if 
( 

cmbHorario 
.  
SelectedIndex  -
==. 0
$num1 2
)2 3
{
ÄÄ 
horario
ÅÅ 
=
ÅÅ 
$str
ÅÅ /
;
ÅÅ/ 0
}
ÇÇ 
else
ÉÉ 
if
ÉÉ 
(
ÉÉ 

cmbHorario
ÉÉ 
.
ÉÉ  
SelectedIndex
ÉÉ  -
==
ÉÉ. 0
$num
ÉÉ1 2
)
ÉÉ2 3
{
ÑÑ 
horario
ÖÖ 
=
ÖÖ 
$str
ÖÖ /
;
ÖÖ/ 0
}
ÜÜ 
else
áá 
{
àà 
horario
ââ 
=
ââ 
$str
ââ '
;
ââ' (
}
ää 
}
ãã 	
}
çç 
}éé 